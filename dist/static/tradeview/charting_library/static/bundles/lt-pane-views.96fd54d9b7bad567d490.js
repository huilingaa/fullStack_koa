webpackJsonp([1],{105:function(e,t,i){"use strict";function n(e){var t,i,n,a,o;e.point2||(e.point2=e.point1),t=e.point1.x,i=e.point1.y,n=t<=e.point2.x?t-10:t+10,a=i<=e.point2.y?i+10:i-10,o={items:[new r(n-=1,a-=3)],char:[String.fromCharCode("0xF017").toUpperCase()],color:e.color,vertOffset:0,height:16,fontFamily:"FontAwesome"},s.call(this,o)}var r=i(1).Point,s=i(422).PaneRendererUnicodeChar;inherit(n,s),t.PaneRendererClockIcon=TradingView.PaneRendererClockIcon=n},117:function(e,t,i){"use strict";function n(e,t,i){this._cache=e,this._cacheRect=t,this._targetRect=i}var r=i(1).Point,s=i(49).pointInRectangle,a=i(4);n.prototype.draw=function(e){e.translate(.5,.5),e.drawImage(this._cache,this._cacheRect.left,this._cacheRect.top,this._cacheRect.width,this._cacheRect.height,this._targetRect.left,this._targetRect.top,this._targetRect.width,this._targetRect.height),e.translate(-.5,-.5)},n.prototype.hitTest=function(e){var t=new r(this._targetRect.left,this._targetRect.top),i=t.add(new r(this._targetRect.width,this._targetRect.height));return s(e,t,i)?new a(a.REGULAR):null},e.exports=n},229:function(e,t,i){"use strict";function n(e,t,i,n){var r=s.equalPoints(i,n[0])?s.equalPoints(i,n[1])?null:n[1]:n[0];return null!==e&&null!==r?l.intersectPolygonAndHalfplane(e,s.halfplaneThroughPoint(s.lineThroughPoints(t,i),r)):null}var r,s,a,o,l,h,d,c;Object.defineProperty(t,"__esModule",{value:!0}),r=i(21),s=i(1),a=i(49),o=i(33),l=i(98),h=i(4),d=i(19),c=function(){function e(){this._data=null}return e.prototype.setData=function(e){this._data=e},e.prototype.draw=function(e){var t,i;if(null!==this._data&&null!==(t=this._visiblePolygon())){for(e.beginPath(),e.moveTo(t[0].x,t[0].y),i=1;i<t.length;i++)e.lineTo(t[i].x,t[i].y);e.fillStyle=d.generateColor(this._data.color,this._data.transparency,!0),e.fill()}},e.prototype.hitTest=function(e){if(null===this._data||!this._data.hittestOnBackground)return null;var t=this._visiblePolygon();return null!==t&&a.pointInPolygon(e,t)?new h(h.MOVEPOINT_BACKGROUND):null},e.prototype._visiblePolygon=function(){var e,t=r.ensureNotNull(this._data),i=t.p1,a=t.p2,l=t.p3,h=t.p4;return s.equalPoints(i,a)||s.equalPoints(l,h)||o.distanceToLine(i,a,l).distance<1e-6&&o.distanceToLine(i,a,h).distance<1e-6||t.width<=0||t.height<=0?null:(e=n(e=[new s.Point(0,0),new s.Point(t.width,0),new s.Point(t.width,t.height),new s.Point(0,t.height)],i,a,[h,l]),e=n(e,h,l,[i,a]),s.equalPoints(l,i)||(e=n(e,l,i,[a,h])),e)},e}(),t.ChannelRenderer=c},230:function(e,t,i){"use strict";var n,r,s,a,o,l;Object.defineProperty(t,"__esModule",{value:!0}),n=i(4),r=i(33),s=i(49),a=i(19),o=i(101),l=function(){function e(){this._data=null}return e.prototype.setData=function(e){this._data=e},e.prototype.draw=function(e){var t,i,n,r;null===this._data||this._data.points.length<2||(e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,void 0!==this._data.linestyle&&o.setLineStyle(e,this._data.linestyle),i=(t=this._data.points)[0],n=t[1],r=2===this._data.points.length?n:this._data.points[2],e.beginPath(),e.moveTo(i.x,i.y),e.lineTo(n.x,n.y),e.lineTo(r.x,r.y),e.lineTo(i.x,i.y),this._data.fillBackground&&(e.fillStyle=a.generateColor(this._data.backcolor,this._data.transparency),e.fill()),e.stroke())},e.prototype.hitTest=function(e){var t,i,a,o;return null===this._data||this._data.points.length<2?null:(i=(t=this._data.points)[0],a=t[1],r.distanceToSegment(i,a,e).distance<=3?new n(n.MOVEPOINT):this._data.points.length<3?null:(o=this._data.points[2],r.distanceToSegment(a,o,e).distance<=3?new n(n.MOVEPOINT):r.distanceToSegment(o,i,e).distance<=3?new n(n.MOVEPOINT):this._data.fillBackground&&s.pointInTriangle(i,a,o,e)?new n(n.MOVEPOINT_BACKGROUND):null))},e}(),t.TriangleRenderer=l},274:function(e,t,i){"use strict";function n(e,t){p.call(this,e,t),this._invalidated=!0}var r=i(1).Point,s=i(53),a=s.parseRgb,o=s.darkenRgb,l=s.rgbToHexString,h=s.rgbToBlackWhiteString,d=i(494).EllipseRendererSimple,c=i(27).TextRenderer,p=i(12).LineSourcePaneView,_=i(16).TrendLineRenderer,u=i(4),f=i(8).CompositeRenderer,g=i(56),v=i(19),w=i(18).LineEnd;inherit(n,p),n.prototype.renderer=function(){var e,t,i,n,s,p,v,w,y,m,x,b,S,P,R,T,L,C,k,I,B,M;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),!this._wave)return null;for(e=this.isAnchorsRequired()?0:1,t=new f,i=this._source.properties(),n=0;n<this._wave.length;n++)(s=new _).setData(this._wave[n]),t.append(s);for(p=1,this._points.length>2&&(v=this._points[2],w=this._points[1],p=g.sign(v.y-w.y)),y=[],m=0,this._model.lineBeingCreated()===this._source&&(m=1),x="black"===h(a(this._model.backgroundColor()),150)?"white":"black",b=i.color.value(),n=0;n<this._points.length-m;n++,p=-p)n<e||(P=(S=this._source.label(n)).label,"circle"===S.decoration&&(R=this._points[n].clone(),1===p?R.y+=13+S.fontIncrease/2:R.y-=14+S.fontIncrease/2,T=(12+S.fontIncrease)/2+2,L={points:[v=R.subtract(new r(T,T)),w=R.add(new r(T,T))],color:l(o(a(b),"black"===x?15:-15)),linewidth:1,fillBackground:!1},C=new d(L),t.append(C)),"brackets"===S.decoration&&(P="("+P+")"),k={points:[this._points[n]],text:P,color:l(o(a(b),"black"===x?15:-15)),vertAlign:1===p?"top":"bottom",horzAlign:"center",font:"Arial",offsetX:0,offsetY:1===p?5:-10,fontsize:12+S.fontIncrease,bold:S.bold},y.push(k),""!==S&&t.append(new c(k,new u(u.CHANGEPOINT,n))));if(this.isAnchorsRequired()){for(I=[],B=0;B<y.length;B++)(M=this._points[B].clone()).y=y[B].points[0].y,M.data=B,I.push(M);this._model.lineBeingCreated()===this._source&&I.pop(),t.append(this.createLineAnchor({points:I}))}return t},n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,s,a,o,l,h,d,c,_,u,f,g,y;if(p.prototype._updateImpl.call(this),this._wave=[],e=this._source.properties(),t=this._source.priceScale(),i=this._model.timeScale(),t&&!t.isEmpty()&&!i.isEmpty()&&(this._source.priceScale().isPercent()&&(n=this._source.ownerSource().firstValue()),s=e.color.value(),e.showWave.value()))for(a=this._source.points(),o=1;o<a.length;o++)l=a[o-1],h=a[o],d=i.indexToCoordinate(l.index),c=i.indexToCoordinate(h.index),_=l.price,u=h.price,this._source.priceScale().isPercent()&&(_=this._source.priceScale().priceRange().convertToPercent(_,n),u=this._source.priceScale().priceRange().convertToPercent(u,n)),f=t.priceToCoordinate(_),g=t.priceToCoordinate(u),y={points:[new r(d,f),new r(c,g)],width:i.width(),height:t.height(),color:v.generateColor(s,0),linewidth:e.linewidth.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:w.Circle,rightend:w.Circle,endstyle:{strokeWidth:1,fillStyle:this._model.backgroundColor()},overlayLineEndings:!0},this._wave.push(y)},t.ElliottLabelsPaneView=n},314:function(e,t,i){"use strict";function n(e,t,i,n){return null!==e?l.intersectPolygonAndHalfplane(e,a.halfplaneThroughPoint(a.lineThroughPoints(t,i),n)):null}function r(e,t){return e.length===t}var s,a,o,l,h,d,c,p,_;Object.defineProperty(t,"__esModule",{value:!0}),s=i(21),a=i(1),o=i(33),l=i(98),h=i(101),d=i(4),c=i(69),p=i(19),_=function(){function e(e,t){this._data=null,this._hittestResult=e||new d(d.MOVEPOINT),this._backHittestResult=t||new d(d.MOVEPOINT_BACKGROUND)}return e.prototype.setData=function(e){this._data=e},e.prototype.draw=function(e){var t,i,n,s,a,o,l,d;null===this._data||this._data.points.length<2||(e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,h.setLineStyle(e,this._data.linestyle),i=(t=this._data.points)[0],n=t[1],this._data.skipLines||this._extendAndDrawLineSegment(e,i,n),r(this._data.points,4)&&(a=(s=this._data.points)[2],o=s[3],this._data.skipLines||this._data.skipTopLine||this._extendAndDrawLineSegment(e,a,o),this._data.fillBackground&&this._drawBackground(e,this._data.points),this._data.showMidline&&!this._data.skipLines&&(e.strokeStyle=this._data.midcolor,e.lineWidth=this._data.midlinewidth,h.setLineStyle(e,this._data.midlinestyle),l=i.add(a).scaled(.5),d=n.add(o).scaled(.5),this._extendAndDrawLineSegment(e,l,d))))},e.prototype.hitTest=function(e){var t,i,n,s,a,o,l,h,d,c,p;if(null===this._data||this._data.points.length<2)return null;if(i=(t=this._data.points)[0],n=t[1],null!==(s=this._extendAndHitTestLineSegment(e,i,n)))return s;if(r(this._data.points,4)&&!this._data.skipTopLine){if(o=(a=this._data.points)[2],l=a[3],null!==(h=this._extendAndHitTestLineSegment(e,o,l)))return h;if(this._data.showMidline&&!this._data.skipLines&&(d=i.add(o).scaled(.5),c=n.add(l).scaled(.5),null!==(p=this._extendAndHitTestLineSegment(e,d,c))))return p}return this._data.hittestOnBackground&&this._data.fillBackground?this._hitTestBackground(e):null},e.prototype._getColor=function(){var e=s.ensureNotNull(this._data);return p.generateColor(e.backcolor,e.transparency)},e.prototype._extendAndDrawLineSegment=function(e,t,i){var n=this._extendAndClipLineSegment(t,i);null!==n&&h.drawLine(e,n[0].x,n[0].y,n[1].x,n[1].y)},e.prototype._extendAndHitTestLineSegment=function(e,t,i){var n=this._extendAndClipLineSegment(t,i);return null!==n&&o.distanceToSegment(n[0],n[1],e).distance<=3?this._hittestResult:null},e.prototype._extendAndClipLineSegment=function(e,t){var i=s.ensureNotNull(this._data);return c.extendAndClipLineSegment(e,t,i.width,i.height,i.extendleft,i.extendright)},e.prototype._drawBackground=function(e,t){var i,r,l,h=s.ensureNotNull(this._data),d=t[0],c=t[1],p=t[2],_=t[3];if(!(a.equalPoints(d,c)||a.equalPoints(p,_)||o.distanceToLine(d,c,p).distance<1e-6||o.distanceToLine(d,c,_).distance<1e-6||h.width<=0||h.height<=0||(i=[new a.Point(0,0),new a.Point(h.width,0),new a.Point(h.width,h.height),new a.Point(0,h.height)],r=i,r=n(r,d,c,_),h.extendright||(r=n(r,c,_,p)),r=n(r,_,p,d),h.extendleft||(r=n(r,p,d,c)),null===r))){for(e.beginPath(),e.moveTo(r[0].x,r[0].y),l=1;l<r.length;l++)e.lineTo(r[l].x,r[l].y);e.fillStyle=this._getColor(),e.fill()}},e.prototype._hitTestBackground=function(e){var t,i,n,a,o,l,h,d,c,p,_,u=s.ensureNotNull(this._data);return r(u.points,4)?(i=(t=u.points)[0],n=t[1],a=t[2],o=(n.y-i.y)/(n.x-i.x),l=i.y+o*(e.x-i.x),h=a.y+o*(e.x-a.x),d=Math.max(l,h),c=Math.min(l,h),p=Math.min(i.x,n.x),_=Math.max(i.x,n.x),!u.extendleft&&e.x<p||!u.extendright&&e.x>_?null:e.y>=c&&e.y<=d?this._backHittestResult:null):null},e}(),t.ParallelChannelRenderer=_},392:function(e,t){"use strict";e.exports=function(e,t){var i=document.body,n=i[e];return n||((n=document.createElement("img")).src=t,i[e]=n),n}},412:function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._numericFormatter=new h,this._invalidated=!0,this._bcRetracementTrend=new s,this._xdRetracementTrend=new s,this._mainTriangleRenderer=new a,this._triangleRendererPoints234=new a,this._abLabelRenderer=new o({}),this._bcLabelRenderer=new o({}),this._cdLabelRenderer=new o({}),this._xdLabelRenderer=new o({}),this._textRendererALabel=new o({}),this._textRendererBLabel=new o({}),this._textRendererCLabel=new o({}),this._textRendererDLabel=new o({}),this._textRendererXLabel=new o({})}var r=i(12).LineSourcePaneView,s=i(16).TrendLineRenderer,a=i(230).TriangleRenderer,o=i(27).TextRenderer,l=i(8).CompositeRenderer,h=i(38).NumericFormatter,d=i(18).LineEnd;inherit(n,r),n.prototype.renderer=function(){var e,t,i,n,r,s,a,o,h,c;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),this._points.length<2?null:(e=this._source.properties(),t=new l,i=[this._points[0],this._points[1],this._points.length<3?this._points[1]:this._points[2]],n=this,r=function(t,i){return{points:[t],text:i,color:e.textcolor.value(),vertAlign:"middle",horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:n._source.properties().color.value(),backgroundRoundRect:4}},s=function(e,t){return{points:[e,t],width:n._model.timeScale().width(),height:n._source.priceScale().height(),color:n._source.properties().color.value(),linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:d.Normal,rightend:d.Normal}},(a={}).points=i,a.color=e.color.value(),a.linewidth=e.linewidth.value(),a.backcolor=e.backgroundColor.value(),a.fillBackground=e.fillBackground.value(),a.transparency=e.transparency.value(),this._mainTriangleRenderer.setData(a),t.append(this._mainTriangleRenderer),this._points.length>3&&(i=[this._points[2],this._points[3],5===this._points.length?this._points[4]:this._points[3]],(a={}).points=i,a.color=e.color.value(),a.linewidth=e.linewidth.value(),a.backcolor=e.backgroundColor.value(),a.fillBackground=e.fillBackground.value(),a.transparency=e.transparency.value(),this._triangleRendererPoints234.setData(a),t.append(this._triangleRendererPoints234)),this._points.length>=3&&(h=r(o=this._points[0].add(this._points[2]).scaled(.5),this._numericFormatter.format(this._ABRetracement)),this._abLabelRenderer.setData(h),t.append(this._abLabelRenderer)),this._points.length>=4&&(o=this._points[1].add(this._points[3]).scaled(.5),c=s(this._points[1],this._points[3]),this._bcRetracementTrend.setData(c),t.append(this._bcRetracementTrend),h=r(o,this._numericFormatter.format(this._BCRetracement)),this._bcLabelRenderer.setData(h),t.append(this._bcLabelRenderer)),this._points.length>=5&&(h=r(o=this._points[2].add(this._points[4]).scaled(.5),this._numericFormatter.format(this._CDRetracement)),this._cdLabelRenderer.setData(h),t.append(this._cdLabelRenderer),c=s(this._points[0],this._points[4]),this._xdRetracementTrend.setData(c),t.append(this._xdRetracementTrend),h=r(o=this._points[0].add(this._points[4]).scaled(.5),this._numericFormatter.format(this._XDRetracement)),this._xdLabelRenderer.setData(h),t.append(this._xdLabelRenderer)),h=r(this._points[0],"X"),this._points[1].y>this._points[0].y?(h.vertAlign="bottom",h.offsetY=-10):(h.vertAlign="top",h.offsetY=5),this._textRendererXLabel.setData(h),t.append(this._textRendererXLabel),h=r(this._points[1],"A"),this._points[1].y<this._points[0].y?(h.vertAlign="bottom",h.offsetY=-10):(h.vertAlign="top",h.offsetY=5),this._textRendererALabel.setData(h),t.append(this._textRendererALabel),this._points.length>2&&(h=r(this._points[2],"B"),this._points[2].y<this._points[1].y?(h.vertAlign="bottom",h.offsetY=-10):(h.vertAlign="top",h.offsetY=5),this._textRendererBLabel.setData(h),t.append(this._textRendererBLabel)),this._points.length>3&&(h=r(this._points[3],"C"),this._points[3].y<this._points[2].y?(h.vertAlign="bottom",h.offsetY=-10):(h.vertAlign="top",h.offsetY=5),this._textRendererCLabel.setData(h),t.append(this._textRendererCLabel)),this._points.length>4&&(h=r(this._points[4],"D"),this._points[4].y<this._points[3].y?(h.vertAlign="bottom",h.offsetY=-10):(h.vertAlign="top",h.offsetY=5),this._textRendererDLabel.setData(h),t.append(this._textRendererDLabel)),this.addAnchors(t),t)},n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,s;r.prototype._updateImpl.call(this),this._source.points().length>=3&&(e=this._source.points()[0],t=this._source.points()[1],i=this._source.points()[2],this._ABRetracement=Math.round(1e3*Math.abs((i.price-t.price)/(t.price-e.price)))/1e3),this._source.points().length>=4&&(n=this._source.points()[3],this._BCRetracement=Math.round(1e3*Math.abs((n.price-i.price)/(i.price-t.price)))/1e3),this._source.points().length>=5&&(s=this._source.points()[4],this._CDRetracement=Math.round(1e3*Math.abs((s.price-n.price)/(n.price-i.price)))/1e3,this._XDRetracement=Math.round(1e3*Math.abs((s.price-t.price)/(t.price-e.price)))/1e3)},t.Pattern5PaneView=n},414:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._levels=[],this._invalidated=!0,this._baseTrendRenderer=new a,this._edgeTrendRenderer=new a}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(16).TrendLineRenderer,o=i(117),l=i(4),h=i(8).CompositeRenderer,d=i(491).ArcWedgeRenderer,c=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype._updateImpl=function(){var e,t,i,n,a,o,l,h,d,c,p,_,u,f,g,v,w,y;if(s.prototype._updateImpl.call(this),this._cacheState=this._source.getCache().updateSource(this._source),this._levels=[],!(this._points.length<3))for(t=(e=this._points)[0],i=e[1],n=e[2],a=i.subtract(t).normalized(),o=n.subtract(t).normalized(),l=new r(1,0),h=new r(0,1),d=Math.acos(a.dotProduct(l)),a.dotProduct(h)<0&&(d=2*Math.PI-d),this._edge1=d,c=Math.acos(o.dotProduct(l)),o.dotProduct(h)<0&&(c=2*Math.PI-c),this._edge2=c,d<c&&(this._edge1=Math.max(d,c),this._edge2=Math.min(d,c)+2*Math.PI),Math.abs(d-c)>Math.PI&&(this._edge1=Math.min(d,c),this._edge2=Math.max(d,c)-2*Math.PI),p=this._source.properties(),_=1;_<=this._source.getCache().levelsCount();_++)(u=p["level"+_]).visible.value()&&(f=u.coeff.value(),g=u.color.value(),v=i.subtract(t).length()*f,w=a.add(o).scaled(.5).normalized().scaled(v),y=t.add(w),this._levels.push({coeff:f,color:g,radius:v,labelPoint:y,p1:t.add(a.scaled(v)),p2:t.add(o.scaled(v)),linewidth:u.linewidth.value(),linestyle:u.linestyle.value(),index:_}))},n.prototype.renderer=function(){var e,t,i,n,r,s,a,p,_,u,f,g,v,w,y,m,x,b,S,P;if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),e=new h,this._points.length<2)return e;if(t=this._source.properties(),s={points:[n=(i=this._points)[0],r=i[1]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:t.trendline.color.value(),linewidth:t.trendline.visible.value()?t.trendline.linewidth.value():0,linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal},this._baseTrendRenderer.setData(s),e.append(this._baseTrendRenderer),this._points.length<3)return this.addAnchors(e),e;for(p=(a=i[2]).data,_=r.subtract(n).length(),u=a.subtract(n).normalized(),(a=n.add(u.scaled(_))).data=p,s={points:[n,a],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:t.trendline.color.value(),linewidth:t.trendline.visible.value()?t.trendline.linewidth.value():0,linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal},this._edgeTrendRenderer.setData(s),e.append(this._edgeTrendRenderer),g=(f=this._model._fibWedgeLabelsCache).canvas().get(0),v=this._levels.length-1;v>=0;v--)if(w=this._levels[v],(y={}).center=this._points[0],y.radius=w.radius,y.prevRadius=v>0?this._levels[v-1].radius:0,y.edge=this._edge,y.color=w.color,y.linewidth=w.linewidth,y.edge1=this._edge1,y.edge2=this._edge2,y.p1=w.p1,y.p2=w.p2,y.fillBackground=t.fillBackground.value(),y.transparency=t.transparency.value(),(m=new d).setData(y),m.setHitTest(new l(l.MOVEPOINT,null,w.index)),e.append(m),t.showCoeffs.value()){if(!(x=this._cacheState.preparedCells.cells[this._levels[v].index-1]))continue;b={left:x.left,top:f.topByRow(this._cacheState.row),width:x.width,height:f.rowHeight(this._cacheState.row)},S={left:Math.round(w.labelPoint.x-b.width),top:Math.round(w.labelPoint.y-b.height/2),width:x.width,height:b.height},P=new o(g,b,S),e.append(P)}return this.isAnchorsRequired()&&(i=[n,r],this._model.lineBeingCreated()!==this._source&&i.push(a),e.append(this.createLineAnchor({points:i}))),e},t.FibWedgePaneView=n},416:function(e,t,i){"use strict";function n(){this._data=null}function r(e,t,i,r,s,a,l){o.call(this,e,t),this._image=i,this._offsetX=a||0,this._offsetY=l||0,this._width=r,this._height=s,this._invalidated=!0,this._marksRenderer=new n}var s=i(1).Point,a=i(49).pointInRectangle,o=i(12).LineSourcePaneView,l=i(4),h=i(74).SelectionRenderer,d=i(8).CompositeRenderer;n.prototype.setData=function(e){this._data=e},n.prototype.draw=function(e){var t,i;null!==this._data&&0!==this._data.points.length&&(t=this._data.points[0].x+this._data.offsetX,i=this._data.points[0].y+this._data.offsetY,e.translate(-.5,-.5),e.drawImage(this._data.image,t,i,this._data.width,this._data.height))},n.prototype.hitTest=function(e){if(null===this._data||0===this._data.points.length)return null;var t=this._data.points[0].clone();return this._data.offsetX&&(t.x+=this._data.offsetX),this._data.offsetY&&(t.y+=this._data.offsetY),a(e,t,t.add(new s(this._data.width,this._data.height)))?new l(l.MOVEPOINT):null},inherit(r,o),r.prototype.setAnchors=function(e){this._anchorsOffset=e},r.prototype.renderer=function(){var e,t,i,n;if(this._invalidated&&this.updateImpl(),(e={}).points=this._points,e.color=this._source.properties().color.value(),e.image=this._image,e.offsetX=this._offsetX,e.offsetY=this._offsetY,e.width=this._width,e.height=this._height,this._marksRenderer.setData(e),this.isAnchorsRequired()&&1===e.points.length){if((t=new d).append(this._marksRenderer),this._anchorsOffset){for(i=[],n=0;n<e.points.length;n++)i.push(e.points[n].clone().add(this._anchorsOffset));t.append(new h({points:i}))}else t.append(new h({points:e.points}));return t}return this._marksRenderer},r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){o.prototype._updateImpl.call(this),this._invalidated=!1},t.MarkPaneView=r},418:function(e,t,i){"use strict";function n(e,t,i,n,r,a){s.call(this,e,t),this._offsetX=i,this._offsetY=n,this._vertAlign=r,this._horzAlign=a,this._renderer=null,this._invalidated=!0,this._noSelection=!1,this._renderer=new o({})}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(8).CompositeRenderer,o=i(27).TextRenderer;inherit(n,s),n.prototype.disableSelection=function(){this._noSelection=!0},n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){s.prototype._updateImpl.call(this),this._invalidated=!1},n.prototype.renderer=function(){var e,t,i,n,s,o,l,h,d,c,p;return this._invalidated&&this.updateImpl(),!(e=this._source.priceScale())||e.isEmpty()?null:(t={},n=(i=this._source.properties()).locked&&i.locked.value(),t.points=n?this._source.fixedPoints():this._points,t.text=i.text.value(),t.color=i.color.value(),t.font=i.font.value(),t.offsetX=this._offsetX?this._offsetX:0,t.offsetY=this._offsetY?this._offsetY:0,t.vertAlign=this._vertAlign?this._vertAlign:"top",t.horzAlign=this._horzAlign?this._horzAlign:"left",t.fontsize=i.fontsize.value(),i.fillBackground&&i.fillBackground.value()&&(t.backgroundColor=i.backgroundColor.value(),t.backgroundTransparency=1-i.backgroundTransparency.value()/100||0),i.drawBorder&&i.drawBorder.value()&&(t.borderColor=i.borderColor.value()),i.wordWrap&&i.wordWrap.value()&&(t.wordWrapWidth=i.wordWrapWidth.value()),t.bold=i.bold&&i.bold.value(),t.italic=i.italic&&i.italic.value(),t.highlightBorder=this._model.selectedSource()===this._source,n||!i.fixedSize||i.fixedSize.value()||(t.scaleX=this._source._model.timeScale().barSpacing()/this._source._barSpacing,s=e.height()/e.priceRange().length(),this._source._isPriceDencityLog&&!e.isLog()&&(o=e.priceRange().minValue(),l=e.priceRange().maxValue(),o=e._toLog(o),h=(l=e._toLog(l))-o,s=e.height()/h),!this._source._isPriceDencityLog&&e.isLog()&&(o=e.priceRange().minValue(),l=e.priceRange().maxValue(),o=e._fromLog(o),h=(l=e._fromLog(l))-o,s=e.height()/h),t.scaleY=s/this._source._priceDencity,(!isFinite(t.scaleY)||t.scaleY<=0)&&delete t.scaleY),this._renderer.setData(t),this.isAnchorsRequired()&&1===t.points.length&&!this._noSelection&&t.wordWrapWidth?((d=new a).append(this._renderer),c=t.points[0],(p=new r(c.x+t.wordWrapWidth+~~(t.fontsize/6),c.y+(t.lines?t.lines.length*t.fontsize/2+~~(t.fontsize/6):0))).data=0,d.append(this.createLineAnchor({points:[p]})),d):this._renderer)},t.TextPaneView=n},481:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitThousands=function(e,t){void 0===t&&(t="&nbsp;");var i=(e+"").split(".");return i[0].replace(/\B(?=(\d{3})+(?!\d))/g,t)+(i[1]?"."+i[1]:"")}},491:function(e,t,i){"use strict";var n,r,s;Object.defineProperty(t,"__esModule",{value:!0}),n=i(4),r=i(19),s=function(){function e(){this._data=null,this._hitTest=new n(n.MOVEPOINT),this._backHitTest=new n(n.MOVEPOINT_BACKGROUND)}return e.prototype.setData=function(e){this._data=e},e.prototype.setHitTest=function(e){this._hitTest=e},e.prototype.draw=function(e){if(null!==this._data&&(e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.arc(this._data.center.x,this._data.center.y,this._data.radius,this._data.edge1,this._data.edge2,!0),e.stroke(),this._data.fillBackground)){if(e.arc(this._data.center.x,this._data.center.y,this._data.prevRadius,this._data.edge2,this._data.edge1,!1),this._data.gradient){var t=e.createRadialGradient(this._data.center.x,this._data.center.y,this._data.prevRadius,this._data.center.x,this._data.center.y,this._data.radius);t.addColorStop(0,r.generateColor(this._data.color1,this._data.transparency)),t.addColorStop(1,r.generateColor(this._data.color2,this._data.transparency)),e.fillStyle=t}else e.fillStyle=r.generateColor(this._data.color,this._data.transparency,!0);e.fill()}},e.prototype.hitTest=function(e){var t,i,n,r,s,a,o,l,h,d;return null===this._data?null:(i=(t=e.subtract(this._data.center)).length(),Math.abs(i-this._data.radius)<=4&&(n=e.subtract(this._data.p1).length(),r=e.subtract(this._data.p2).length(),Math.max(n,r)<=this._data.p1.subtract(this._data.p2).length())?this._hitTest:this._data.fillBackground&&i<=this._data.radius&&(s=this._data.p1.subtract(this._data.center).normalized(),a=this._data.p2.subtract(this._data.center).normalized(),o=t.normalized(),l=s.dotProduct(a),h=o.dotProduct(s),d=o.dotProduct(a),h>=l&&d>=l)?this._backHitTest:null)},e}(),t.ArcWedgeRenderer=s},492:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.quadroBezierHitTest=function(e,t,i,n){var r,s,a,o,l=3/(i.subtract(e).length()+i.subtract(t).length());for(r=0;r<=1;r+=l)if(s=e.scaled((1-r)*(1-r)),a=i.scaled(2*r*(1-r)),o=t.scaled(r*r),s.add(a).add(o).subtract(n).length()<5)return!0;return!1},t.cubicBezierHitTest=function(e,t,i,n,r){var s,a,o,l,h,d=3/(i.subtract(e).length()+n.subtract(i).length()+t.subtract(n).length());for(s=0;s<=1;s+=d)if(a=e.scaled((1-s)*(1-s)*(1-s)),o=i.scaled(3*(1-s)*(1-s)*s),l=n.scaled(3*(1-s)*s*s),h=t.scaled(s*s*s),a.add(o).add(l).add(h).subtract(r).length()<5)return!0;return!1},t.extendQuadroBezier=function(e,t,i,n,r){var s,a,o,l,h,d,c,p=i.subtract(e).length()+i.subtract(t).length();if(!p)return[];for(s=3/p,500,a=[],o=1;o<=500*s;o+=s)l=e.scaled((1-o)*(1-o)),h=i.scaled(2*o*(1-o)),d=t.scaled(o*o),c=l.add(h).add(d),a.length>0&&(a[a.length-1].subtract(c).length()<2&&(s*=2)),a.push(c);return a}},493:function(e,t,i){"use strict";function n(e,t,i,n){var r=o.equalPoints(i,n[0])?o.equalPoints(i,n[1])?null:n[1]:n[0];return null!==e&&null!==r?d.intersectPolygonAndHalfplane(e,o.halfplaneThroughPoint(o.lineThroughPoints(t,i),r)):null}function r(e,t,i){return null!==e?d.intersectPolygonAndHalfplane(e,o.halfplaneThroughPoint(function(e){return o.line(1,0,-e)}(t),new o.Point(i,0))):null}function s(e,t){var i=t.points,n=i[0],s=i[1];return t.extendleft||(e=r(e,n.x,s.x)),t.extendright||(e=r(e,s.x,n.x)),e}var a,o,l,h,d,c,p,_,u,f,g;Object.defineProperty(t,"__esModule",{value:!0}),a=i(21),o=i(1),l=i(49),h=i(33),d=i(98),c=i(115),p=i(4),_=i(314),u=i(19),f=function(){function e(){this._parallelChannelRenderer=new _.ParallelChannelRenderer,this._disjointAngleIntersectionRenderer=new g,this._selectedRenderer=this._disjointAngleIntersectionRenderer}return e.prototype.setData=function(e){var t,i,n,r,s;e.points.length<4||(i=(t=e.points)[0],n=t[1],r=t[2],s=t[3],o.equalPoints(i,n)||o.equalPoints(r,s)||h.distanceToLine(i,n,r).distance<1e-6&&h.distanceToLine(i,n,s).distance<1e-6?this._selectedRenderer=null:null!==d.intersectLines(o.lineThroughPoints(i,n),o.lineThroughPoints(r,s))?(this._disjointAngleIntersectionRenderer.setData(e),this._selectedRenderer=this._disjointAngleIntersectionRenderer):(this._parallelChannelRenderer.setData({width:e.width,height:e.height,extendleft:e.extendleft,extendright:e.extendright,points:[i,n,s,r],fillBackground:!0,backcolor:e.backcolor,transparency:e.transparency,color:"rgba(0,0,0,0)",linestyle:c.LINESTYLE_SOLID,linewidth:0,showMidline:!1,midcolor:"rgba(0,0,0,0)",midlinestyle:0,midlinewidth:0,hittestOnBackground:e.hittestOnBackground}),this._selectedRenderer=this._parallelChannelRenderer))},e.prototype.draw=function(e){null!==this._selectedRenderer&&this._selectedRenderer.draw(e)},e.prototype.hitTest=function(e){return null!==this._selectedRenderer?this._selectedRenderer.hitTest(e):null},e}(),t.DisjointAngleRenderer=f,g=function(){function e(){this._data=null}return e.prototype.setData=function(e){this._data=e},e.prototype.draw=function(e){var t,i,n,r;if(!(null===this._data||this._data.points.length<4))for(e.fillStyle=u.generateColor(this._data.backcolor,this._data.transparency),t=0,i=this._visiblePolygons();t<i.length;t++){for(n=i[t],e.beginPath(),e.moveTo(n[0].x,n[0].y),r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.fill()}},e.prototype.hitTest=function(e){var t,i,n;if(null===this._data||!this._data.hittestOnBackground)return null;for(t=0,i=this._visiblePolygons();t<i.length;t++)if(n=i[t],l.pointInPolygon(e,n))return new p(p.MOVEPOINT_BACKGROUND);return null},e.prototype._visiblePolygons=function(){var e,t,i,r,l,h,c,p,_=a.ensureNotNull(this._data),u=_.points,f=u[0],g=u[1],v=u[2],w=u[3];return _.width<=0||_.height<=0||null===(e=d.intersectLines(o.lineThroughPoints(f,g),o.lineThroughPoints(v,w)))?[]:(i=[],r=n(r=t=[new o.Point(0,0),new o.Point(_.width,0),new o.Point(_.width,_.height),new o.Point(0,_.height)],e,l=f.subtract(g).add(e),[h=w.subtract(v).add(e),h]),null!==(r=n(r=s(r,_),h,e,[l,l]))&&i.push(r),r=n(r=t,e,c=g.subtract(f).add(e),[p=v.subtract(w).add(e),p]),null!==(r=n(r=s(r,_),p,e,[c,c]))&&i.push(r),i)},e}()},494:function(e,t,i){"use strict";var n,r,s,a,o,l;Object.defineProperty(t,"__esModule",{value:!0}),n=i(4),r=i(56),s=i(1),a=i(19),o=i(101),l=function(){function e(e,t,i){this._data=e,this._hitTest=t||new n(n.MOVEPOINT),this._backgroundHitTest=i||new n(n.MOVEPOINT_BACKGROUND)}return e.prototype.draw=function(e){var t,i,n,r,s,l,h,d;e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,void 0!==this._data.linestyle&&o.setLineStyle(e,this._data.linestyle),t=this._data.points[0],i=this._data.points[1],n=Math.abs(t.x-i.x),r=Math.abs(t.y-i.y),s=t.add(i).scaled(.5),n<1||r<1||(l=0,this._data.wholePoints&&(h=this._data.wholePoints[0],d=this._data.wholePoints[1],l=Math.abs(h.x-d.x)),e.save(),e.translate(s.x,s.y),e.scale(1,r/n),e.beginPath(),e.arc(0,0,n/2,0,2*Math.PI,!1),e.restore(),e.stroke(),this._data.fillBackground&&(this._data.wholePoints&&(e.translate(s.x,s.y),e.scale(1,r/n),e.arc(0,0,l/2,0,2*Math.PI,!0)),e.fillStyle=a.generateColor(this._data.backcolor,this._data.transparency,!0),e.fill()))},e.prototype.hitTest=function(e){var t,i,n,a,o,l,h,d,c;return this._data.points.length<2?null:(t=this._data.points[0],i=this._data.points[1],n=.5*Math.abs(t.x-i.x),a=Math.abs(t.x-i.x),o=Math.abs(t.y-i.y),l=t.add(i).scaled(.5),h=e.subtract(l),a<1||o<1?null:(d=(i.y-t.y)/(i.x-t.x),c=(h=new s.Point(h.x,h.y/d)).x*h.x+h.y*h.y-n*n,c=r.sign(c)*Math.sqrt(Math.abs(c/n)),Math.abs(c)<3?this._hitTest:this._data.fillBackground&&!this._data.noHitTestOnBackground&&c<3?this._backgroundHitTest:null))},e}(),t.EllipseRendererSimple=l},834:function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._numericFormatter=new l,this._invalidated=!0,this._lineRendererPoints01=new s,this._lineRendererPoints12=new s,this._lineRendererPoints23=new s,this._abRetracementTrend=new s,this._cdRetracementTrend=new s,this._abLabelRenderer=new a({}),this._cdLabelRenderer=new a({}),this._textRendererALabel=new a({}),this._textRendererBLabel=new a({}),this._textRendererCLabel=new a({}),this._textRendererDLabel=new a({})}var r=i(12).LineSourcePaneView,s=i(16).TrendLineRenderer,a=i(27).TextRenderer,o=i(8).CompositeRenderer,l=i(38).NumericFormatter,h=i(19),d=i(18).LineEnd;inherit(n,r),n.prototype.renderer=function(){var e,t,i,n,r,s,a,l,c;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),this._points.length<2?null:(e=this._source.properties(),t=new o,i=this._points,n=this,r=function(t,i){return{points:[t],text:i,color:e.textcolor.value(),vertAlign:"middle",horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:n._source.properties().color.value(),backgroundRoundRect:4}},a=(s=function(t,i,r,s){return{points:[t,i],width:n._model.timeScale().width(),height:n._source.priceScale().height(),color:h.generateColor(n._source.properties().color.value(),r),linewidth:s||e.linewidth.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:d.Normal,rightend:d.Normal}})(i[0],i[1],0),this._lineRendererPoints01.setData(a),t.append(this._lineRendererPoints01),i.length>=3&&(a=s(i[1],i[2],0),this._lineRendererPoints12.setData(a),t.append(this._lineRendererPoints12)),4===i.length&&(a=s(i[2],i[3],0),this._lineRendererPoints23.setData(a),t.append(this._lineRendererPoints23)),l=r(this._points[0],"A"),this._points[1].y>this._points[0].y?(l.vertAlign="bottom",l.offsetY=-10):(l.vertAlign="top",l.offsetY=5),this._textRendererALabel.setData(l),t.append(this._textRendererALabel),l=r(this._points[1],"B"),this._points[1].y<this._points[0].y?(l.vertAlign="bottom",l.offsetY=-10):(l.vertAlign="top",l.offsetY=5),this._textRendererBLabel.setData(l),t.append(this._textRendererBLabel),this._points.length>2&&(l=r(this._points[2],"C"),this._points[2].y<this._points[1].y?(l.vertAlign="bottom",l.offsetY=-10):(l.vertAlign="top",l.offsetY=5),this._textRendererCLabel.setData(l),t.append(this._textRendererCLabel)),this._points.length>3&&(l=r(this._points[3],"D"),this._points[3].y<this._points[2].y?(l.vertAlign="bottom",l.offsetY=-10):(l.vertAlign="top",l.offsetY=5),this._textRendererDLabel.setData(l),t.append(this._textRendererDLabel)),this._points.length>=3&&(c=this._points[0].add(this._points[2]).scaled(.5),a=s(this._points[0],this._points[2],70,1),this._abRetracementTrend.setData(a),t.append(this._abRetracementTrend),l=r(c,this._numericFormatter.format(this._ABRetracement)),this._abLabelRenderer.setData(l),t.append(this._abLabelRenderer)),this._points.length>=4&&(c=this._points[1].add(this._points[3]).scaled(.5),a=s(this._points[1],this._points[3],70,1),this._cdRetracementTrend.setData(a),t.append(this._cdRetracementTrend),l=r(c,this._numericFormatter.format(this._CDRetracement)),this._cdLabelRenderer.setData(l),t.append(this._cdLabelRenderer)),this.addAnchors(t),t)},n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n;r.prototype._updateImpl.call(this),this._source.points().length>=3&&(e=this._source.points()[0],t=this._source.points()[1],i=this._source.points()[2],this._ABRetracement=Math.round(1e3*Math.abs((i.price-t.price)/(t.price-e.price)))/1e3),4===this._source.points().length&&(n=this._source.points()[3],this._CDRetracement=Math.round(1e3*Math.abs((n.price-i.price)/(i.price-t.price)))/1e3)},t.ABCDPaneView=n},836:function(e,t,i){"use strict";function n(){this._data=null}function r(e,t){p.call(this,e,t),this._invalidated=!0,this._renderer=new n}var s=i(1).Point,a=i(33).distanceToLine,o=i(193),l=o.rotationMatrix,h=o.scalingMatrix,d=o.translationMatrix,c=o.transformPoint,p=i(12).LineSourcePaneView,_=i(4),u=i(8).CompositeRenderer,f=i(19);n.prototype.setData=function(e){this._data=e,this._data.angleFrom=0,this._data.angleTo=Math.PI,this._data.clockwise=!1},n.prototype.draw=function(e){var t,i,n,r,o,p,_,u,g,v,w,y,m,x;if(!(null===this._data||this._data.points.length<2)){if(t=this._data.points[0],i=this._data.points[1],this._data.points.length<3)return e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),void e.stroke();if(n=this._data.points[2],(r=a(t,i,n).distance)<1)return e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),void e.stroke();o=i.subtract(t),p=t.add(i).scaled(.5),_=(_=new s(-o.y,o.x)).normalized(),n=p.add(_.scaled(r)),e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,u=o.length(),g=o.x/u,v=o.y/u,w=Math.acos(g),v<0&&(w=-w),y=this._data.points[2],m=d(-p.x,-p.y),y=c(m,y),m=l(-w),y=c(m,y),m=h(1,u/(2*r)),(y=c(m,y)).y<0?this._data.clockwise=!0:this._data.clockwise=!1,e.save(),e.beginPath(),e.translate(t.x,t.y),e.rotate(w),x=1-Math.sqrt(3)/2,e.scale(1,r/(u*x)),this._data.clockwise?e.arc(.5*u,u*Math.sqrt(3)/2,u,-2*Math.PI/3,-Math.PI/3,!1):e.arc(.5*u,-u*Math.sqrt(3)/2,u,Math.PI/3,2*Math.PI/3,!1),e.restore(),e.stroke(),this._data.fillBackground&&(e.fillStyle=f.generateColor(this._data.backcolor,this._data.transparency),e.fill())}},n.prototype.hitTest=function(e){var t,i,n,r,o,p,u,f,g,v,w,y,m,x,b;return null===this._data||this._data.points.length<3?null:(5,t=this._data.points[0],i=this._data.points[1],n=this._data.points[2],(r=a(t,i,n).distance)<1?(r=a(t,i,e).distance)<5?new _(_.MOVEPOINT):null:(p=(o=i.subtract(t)).length(),u=t.add(i).scaled(.5),f=(f=n.subtract(u)).normalized(),n=u.add(f.scaled(r)),g=o.x/p,v=o.y/p,w=Math.acos(g),v<0&&(w=-w),y=d(-t.x,-t.y),e=c(y,e),y=l(-w),e=c(y,e),f=c(y,f),m=1-Math.sqrt(3)/2,y=h(1,p*m/r),e=c(y,e),f=c(y,f),e.y*f.y<0?null:(x=e.y<0?new s(.5*p,p*Math.sqrt(3)/2):new s(.5*p,-p*Math.sqrt(3)/2),b=e.subtract(x).length(),Math.abs(b-p)<=5?new _(_.MOVEPOINT):null)))},inherit(r,p),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){p.prototype._updateImpl.call(this),this._invalidated=!1},r.prototype.renderer=function(){var e,t,i,n,r,o,p,_,f,g,v,w,y,m,x,b,S,P,R,T;return this._invalidated&&this.updateImpl(),(e={}).points=this._points,e.color=this._source.properties().color.value(),e.linewidth=this._source.properties().linewidth.value(),e.backcolor=this._source.properties().backgroundColor.value(),e.fillBackground=this._source.properties().fillBackground.value(),e.transparency=this._source.properties().transparency.value(),this._renderer.setData(e),this.isAnchorsRequired()?((t=new u).append(this._renderer),i=[],n=e.points[0],(r=new s(n.x,n.y)).data=0,i.push(r),1===e.points.length?t:(o=e.points[1],(p=new s(o.x,o.y)).data=1,2===e.points.length?(this.addAnchors(t),t):(i.push(p),_=e.points[2],f=a(n,o,_).distance,g=o.subtract(n),v=n.add(o).scaled(.5),w=(w=new s(-g.y,g.x)).normalized(),_=v.add(w.scaled(f)),y=v.add(w.scaled(-f)),m=g.length(),x=g.x/m,b=g.y/m,S=Math.acos(x),b<0&&(S=-S),P=e.points[2],R=d(-v.x,-v.y),P=c(R,P),R=l(-S),P=c(R,P),R=h(1,m/(2*f)),(T=(P=c(R,P)).y>=0?new s(_.x,_.y):new s(y.x,y.y)).data=2,i.push(T),t.append(this.createLineAnchor({points:i})),t))):this._renderer},t.ArcPaneView=r},839:function(e,t,i){"use strict";function n(e){this._measureCache=e,this._data=null}function r(e,t){o.call(this,e,t),this._rendererCache={},this._invalidated=!0,this._renderer=new n(this._rendererCache)}var s=i(1).Point,a=i(49).pointInRectangle,o=i(12).LineSourcePaneView,l=i(74).SelectionRenderer,h=i(4),d=i(8).CompositeRenderer,c=i(19);n.prototype.setData=function(e){this._data=e},n.prototype.draw=function(e){var t,i,n,r,s,a,o;null!==this._data&&0!==this._data.points.length&&(e.font=[this._data.fontWeight,this._data.fontSize+"px",this._data.fontFamily].join(" "),(t=e.measureText(this._data.label)).height=this._data.fontSize,n={left:i=15,top:(30-t.height)/2},r=t.width+2*n.left,s=30,a=this._data.points[0].x-(n.left+20),o=this._data.points[0].y-39,this._measureCache&&$.extend(this._measureCache,{innerWidth:r,innerHeight:s,padding:n}),e.translate(.5+a,.5+o),e.beginPath(),e.moveTo(24,s),e.lineTo(i,s),e.arcTo(-1e3,0,1e3,0,i),e.lineTo(r-i,0),e.arcTo(1e3,s,-1e3,s,i),e.lineTo(33,s),e.quadraticCurveTo(33,34,35,39),e.quadraticCurveTo(27,36,24,s),e.fillStyle=c.generateColor(this._data.backgroundColor,this._data.transparency),e.fill(),e.strokeStyle=this._data.borderColor,e.lineWidth=2,e.stroke(),e.closePath(),e.textBaseline="top",e.fillStyle=this._data.color,e.fillText(this._data.label,n.left,n.top-1))},n.prototype.hitTest=function(e){var t,i;return null!==this._data&&0!==this._data.points.length&&this._measureCache.padding?(t=this._data.points[0].x-(this._measureCache.padding.left+20),i=this._data.points[0].y-(this._measureCache.innerHeight+9),a(e,new s(t,i),new s(t+this._measureCache.innerWidth,i+this._measureCache.innerHeight))?new h(h.MOVEPOINT):null):null},inherit(r,o),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){o.prototype._updateImpl.call(this),this._invalidated=!1},r.prototype.renderer=function(){var e,t;return this._invalidated&&this.updateImpl(),(e={}).points=this._points,e.color=this._source.properties().color.value(),e.borderColor=this._source.properties().borderColor.value(),e.backgroundColor=this._source.properties().backgroundColor.value(),e.transparency=this._source.properties().transparency.value(),e.fontWeight=this._source.properties().fontWeight.value(),e.fontSize=this._source.properties().fontsize.value(),e.fontFamily=this._source.properties().font.value(),e.label=this._source.properties().text.value(),this._renderer.setData(e),this.isAnchorsRequired()&&1===e.points.length?((t=new d).append(this._renderer),t.append(new l({points:e.points})),t):this._renderer},t.BalloonPaneView=r},842:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._vertLineRenderer1=new a,this._vertLineRenderer2=new a,this._medianRenderer=new l}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(146).VerticalLineRenderer,o=i(70).RectangleRenderer,l=i(16).TrendLineRenderer,h=i(4),d=i(212).PaneRendererLine,c=i(8).CompositeRenderer,p=i(19),_=i(311).LineToolBarsPatternMode,u=i(18).LineEnd;inherit(n,s),n.prototype.renderer=function(){var e,t,i,n,s,a,l,f,g,v,w,y,m,x,b,S,P,R,T,L;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),this._pattern&&2===this._source.points().length){if(!(e=this._source.points()[0].index<this._source.points()[1].index?this._points[0]:this._points[1]))return new c;if(t=parseInt(this._source.properties().mode.value(),10),i=Math.abs((this._points[0].x-this._points[1].x)/(this._pattern.length-1)),t===_.Bars||t===_.OpenClose){for(n=new c,a=(s=t===_.Bars?["high","low"]:["open","close"])[0],l=s[1],f=0;f<this._pattern.length;f++)g=Math.round(e.x+f*i+.5),v=e.y+Math.round(this._pattern[f][a]),w=e.y+Math.round(this._pattern[f][l]),(y={}).points=[new r(g-1,v),new r(g+1,w)],y.color=this._source.properties().color.value(),y.linewidth=1,y.backcolor=this._source.properties().color.value(),y.fillBackground=!0,y.transparency=10,(m=new o).setData(y),n.append(m);return this.isAnchorsRequired()&&n.append(this.createLineAnchor({points:this._points})),n}return n=new c,(y={}).barSpacing=i,y.items=this._pattern,y.histogramBase=0,y.lineIndex=0,y.lineColor=p.generateColor(this._source.properties().color.value(),10),y.lineStyle=CanvasEx.LINESTYLE_SOLID,y.lineWidth=2,y.hittest=new h(h.MOVEPOINT),n.append(new d(y)),this.isAnchorsRequired()&&n.append(this.createLineAnchor({points:this._points})),n}return n=new c,this._points.length<2||(x=this._model.timeScale().width(),b=this._source.priceScale().height(),S=this._points[0],P=this._points[1],(R={}).width=x,R.height=b,R.points=[S],R.color="#808080",R.linewidth=1,R.linestyle=CanvasEx.LINESTYLE_SOLID,this._vertLineRenderer1.setData(R),n.append(this._vertLineRenderer1),(T={}).width=x,T.height=b,T.points=[P],T.color="#808080",T.linewidth=1,T.linestyle=CanvasEx.LINESTYLE_SOLID,this._vertLineRenderer2.setData(T),n.append(this._vertLineRenderer2),L={points:[S,P],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:u.Normal,rightend:u.Normal},this._medianRenderer.setData(L),n.append(this._medianRenderer)),n},n.prototype.update=function(){s.prototype._updateImpl.call(this),this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,s,a,o,l,h,d,c,p,_,u;!this._source.priceScale()||this._source.priceScale().isEmpty()||this._points.length<2||(this._source._pattern&&this._source._pattern.length>0&&2===this._source.points().length?(e=this._source.priceScale(),t=this._source.firstPatternPrice(),i=this._source.pressCoeff(),e=this._source.priceScale(),n=this._source.ownerSource().firstValue(),s=e.priceRange(),e.isPercent()?(o=s.convertToPercent(t,n),a=e.priceToCoordinate(o)):a=e.priceToCoordinate(t),l=function(r){var o=(r-t)*i+t;return e.isPercent()&&(o=s.convertToPercent(o,n)),e.priceToCoordinate(o)-a},h=parseInt(this._source.properties().mode.value()),d=this._source.points()[0].index>this._source.points()[1].index?1:0,c=this._points[d],p=c.x,_=Math.abs((this._points[0].x-this._points[1].x)/(this._source._pattern.length-1)),u={0:function(e){return{high:l(e[TradingView.HIGH_PLOT]),low:l(e[TradingView.LOW_PLOT])}},1:function(e,t){return new r(p+t*_,l(e[TradingView.CLOSE_PLOT])+c.y)},2:function(e){return{open:l(e[TradingView.OPEN_PLOT]),close:l(e[TradingView.CLOSE_PLOT])}},3:function(e,t){return new r(p+t*_,l(e[TradingView.OPEN_PLOT])+c.y)},4:function(e,t){return new r(p+t*_,l(e[TradingView.HIGH_PLOT])+c.y)},5:function(e,t){return new r(p+t*_,l(e[TradingView.LOW_PLOT])+c.y)},6:function(e,t){return new r(p+t*_,l((e[TradingView.HIGH_PLOT]+e[TradingView.LOW_PLOT])/2)+c.y)}},this._pattern=this._source._pattern.map(u[h])):delete this._pattern)},t.BarsPatternPaneView=n},844:function(e,t,i){"use strict";function n(){this._data=null}function r(e,t){a.call(this,e,t),this._invalidated=!0,this._renderer=new n}var s=i(33).distanceToSegment,a=i(12).LineSourcePaneView,o=i(16).TrendLineRenderer,l=i(4),h=i(8).CompositeRenderer,d=i(19),c=i(18).LineEnd,p=i(492);n.prototype.setData=function(e){this._data=e},n.prototype.draw=function(e){var t,i,n,r,s,a,l,h,p,_,u,f,g;if(null!==this._data)if(e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,CanvasEx.setLineStyle(e,this._data.linestyle),t=this._data.points[0],i=this._data.points[1],2===this._data.points.length)e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.stroke(),this._data.leftend===c.Arrow&&o.prototype.drawArrow(i,t,e,e.lineWidth),this._data.rightend===c.Arrow&&o.prototype.drawArrow(t,i,e,e.lineWidth);else{if(n=this._data.points[2],s=(r=this._data.points[3]).subtract(t),a=n.subtract(s.scaled(.25)),l=n.add(s.scaled(.25)),h=i.subtract(n),p=r.subtract(h.scaled(.25)),_=r.add(h.scaled(.25)),this._data.fillBack&&this._data.points.length>2&&(e.fillStyle=d.generateColor(this._data.backcolor,this._data.transparency),e.beginPath(),e.moveTo(t.x,t.y),e.quadraticCurveTo(a.x,a.y,n.x,n.y),e.bezierCurveTo(l.x,l.y,p.x,p.y,r.x,r.y),e.quadraticCurveTo(_.x,_.y,i.x,i.y),e.fill()),e.beginPath(),this._data.extendLeftPoints.length>0)for(u=this._data.extendLeftPoints[this._data.extendLeftPoints.length-1],e.moveTo(u.x,u.y),f=this._data.extendLeftPoints.length-2;f>=0;f--)g=this._data.extendLeftPoints[f],e.lineTo(g.x,g.y);for(e.moveTo(t.x,t.y),e.quadraticCurveTo(a.x,a.y,n.x,n.y),e.bezierCurveTo(l.x,l.y,p.x,p.y,r.x,r.y),e.quadraticCurveTo(_.x,_.y,i.x,i.y),f=0;f<this._data.extendRightPoints.length;f++)g=this._data.extendRightPoints[f],e.lineTo(g.x,g.y);e.stroke(),this._data.leftend===c.Arrow&&o.prototype.drawArrow(a,t,e,e.lineWidth),this._data.rightend===c.Arrow&&o.prototype.drawArrow(_,i,e,e.lineWidth)}},n.prototype.hitTest=function(e){var t,i,n,r,a,o,h,d,c,_,u;if(4===this._data.points.length){if(t=this._data.points[0],i=this._data.points[1],n=this._data.points[2],a=(r=this._data.points[3]).subtract(t),o=n.subtract(a.scaled(.25)),h=n.add(a.scaled(.25)),d=i.subtract(n),c=r.subtract(d.scaled(.25)),_=r.add(d.scaled(.25)),p.quadroBezierHitTest(n,t,o,e)||p.cubicBezierHitTest(n,r,h,c,e)||p.quadroBezierHitTest(r,i,_,e))return new l(l.MOVEPOINT);for(3,u=1;u<this._data.extendLeftPoints.length;u++)if(t=this._data.extendLeftPoints[u-1],i=this._data.extendLeftPoints[u],s(t,i,e).distance<3)return new l(l.MOVEPOINT);for(u=1;u<this._data.extendRightPoints.length;u++)if(t=this._data.extendRightPoints[u-1],i=this._data.extendRightPoints[u],s(t,i,e).distance<3)return new l(l.MOVEPOINT)}return null},inherit(r,a),r.prototype.update=function(){a.prototype._updateImpl.call(this),this._invalidated=!0},r.prototype.updateImpl=function(){var e,t,i,n,r,s,a,o,l,h;this._extendLeftPoints=[],this._extendRightPoints=[],this._source.points().length<4||(e=this._source.pointToScreenPoint(this._source.points()[0])[1],t=this._source.pointToScreenPoint(this._source.points()[1])[1],i=this._source.pointToScreenPoint(this._source.points()[2])[1],r=(n=this._source.pointToScreenPoint(this._source.points()[3])[1]).subtract(e),s=i.subtract(r.scaled(.25)),a=t.subtract(i),o=n.add(a.scaled(.25)),l=this._model.timeScale().width(),h=this._source.priceScale().height(),this._source.properties().extendLeft.value()&&(this._extendLeftPoints=p.extendQuadroBezier(i,e,s,l,h)),this._source.properties().extendRight.value()&&(this._extendRightPoints=p.extendQuadroBezier(n,t,o,l,h)))},r.prototype.renderer=function(){var e,t,i,n;return this._points.length<2?new h:(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=[].concat(this._points),this._source._controlPoints&&(e.push(this._source.pointToScreenPoint(this._source._controlPoints[0])[0]),e.push(this._source.pointToScreenPoint(this._source._controlPoints[1])[0])),t={},i=this._source.properties(),t.points=e,t.color=i.linecolor.value(),t.linewidth=i.linewidth.value(),t.linestyle=i.linestyle.value(),t.leftend=i.leftEnd.value(),t.rightend=i.rightEnd.value(),t.fillBack=i.fillBackground.value(),t.backcolor=i.backgroundColor.value(),t.transparency=i.transparency.value(),t.extendLeftPoints=this._extendLeftPoints,t.extendRightPoints=this._extendRightPoints,this._renderer.setData(t),(n=new h).append(this._renderer),this.addAnchors(n),n)},t.BezierCubicPaneView=r},846:function(e,t,i){"use strict";function n(){this._data=null}function r(e,t){a.call(this,e,t),this._invalidated=!0,this._renderer=new n}var s=i(33).distanceToSegment,a=i(12).LineSourcePaneView,o=i(16).TrendLineRenderer,l=i(4),h=i(8).CompositeRenderer,d=i(19),c=i(18).LineEnd,p=i(492);n.prototype.setData=function(e){this._data=e},n.prototype.draw=function(e){var t,i,n,r,s,a,l,h,p;if(null!==this._data)if(t=this._data.points[0],i=this._data.points[1],e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,CanvasEx.setLineStyle(e,this._data.linestyle),2===this._data.points.length)e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.stroke();else{if(n=this._data.points[2],r=i.subtract(t),s=n.subtract(r.scaled(.25)),a=n.add(r.scaled(.25)),this._data.fillBack&&this._data.points.length>2&&(e.fillStyle=d.generateColor(this._data.backcolor,this._data.transparency),e.beginPath(),e.moveTo(t.x,t.y),e.quadraticCurveTo(s.x,s.y,n.x,n.y),e.quadraticCurveTo(a.x,a.y,i.x,i.y),e.fill()),e.beginPath(),e.moveTo(t.x,t.y),this._data.extendLeftPoints.length>0)for(l=this._data.extendLeftPoints[this._data.extendLeftPoints.length-1],e.moveTo(l.x,l.y),h=this._data.extendLeftPoints.length-2;h>=0;h--)p=this._data.extendLeftPoints[h],e.lineTo(p.x,p.y);for(e.quadraticCurveTo(s.x,s.y,n.x,n.y),e.quadraticCurveTo(a.x,a.y,i.x,i.y),h=0;h<this._data.extendRightPoints.length;h++)p=this._data.extendRightPoints[h],e.lineTo(p.x,p.y);e.stroke(),this._data.leftend===c.Arrow&&o.prototype.drawArrow(s,t,e,e.lineWidth),this._data.rightend===c.Arrow&&o.prototype.drawArrow(a,i,e,e.lineWidth)}},n.prototype.hitTest=function(e){var t,i,n,r,a,o,h;if(null!==this._data&&3===this._data.points.length){if(t=this._data.points[0],i=this._data.points[1],n=this._data.points[2],r=i.subtract(t),a=n.subtract(r.scaled(.25)),o=n.add(r.scaled(.25)),p.quadroBezierHitTest(n,t,a,e)||p.quadroBezierHitTest(n,i,o,e))return new l(l.MOVEPOINT);for(3,h=1;h<this._data.extendLeftPoints.length;h++)if(t=this._data.extendLeftPoints[h-1],i=this._data.extendLeftPoints[h],s(t,i,e).distance<3)return new l(l.MOVEPOINT);for(h=1;h<this._data.extendRightPoints.length;h++)if(t=this._data.extendRightPoints[h-1],i=this._data.extendRightPoints[h],s(t,i,e).distance<3)return new l(l.MOVEPOINT)}return null},inherit(r,a),r.prototype.update=function(){a.prototype._updateImpl.call(this),this._invalidated=!0},r.prototype.updateImpl=function(){var e,t,i,n,r,s,a,o;this._extendLeftPoints=[],this._extendRightPoints=[],this._source.points().length<3||(e=this._source.pointToScreenPoint(this._source.points()[0])[1],t=this._source.pointToScreenPoint(this._source.points()[1])[1],i=this._source.pointToScreenPoint(this._source.points()[2])[1],n=t.subtract(e),r=i.subtract(n.scaled(.25)),s=i.add(n.scaled(.25)),a=this._model.timeScale().width(),o=this._source.priceScale().height(),this._source.properties().extendLeft.value()&&(this._extendLeftPoints=p.extendQuadroBezier(i,e,r,a,o)),this._source.properties().extendRight.value()&&(this._extendRightPoints=p.extendQuadroBezier(i,t,s,a,o)))},r.prototype.renderer=function(){var e,t,i,n;return this._points.length<2?new h:(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=[].concat(this._points),this._source._controlPoint&&e.push(this._source.pointToScreenPoint(this._source._controlPoint)[0]),t={},i=this._source.properties(),t.points=e,t.color=i.linecolor.value(),t.linewidth=i.linewidth.value(),t.linestyle=i.linestyle.value(),t.leftend=i.leftEnd.value(),t.rightend=i.rightEnd.value(),t.fillBack=i.fillBackground.value(),t.backcolor=i.backgroundColor.value(),t.transparency=i.transparency.value(),t.extendLeftPoints=this._extendLeftPoints,t.extendRightPoints=this._extendRightPoints,this._renderer.setData(t),(n=new h).append(this._renderer),this.addAnchors(n),n)},t.BezierQuadroPaneView=r},848:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._model=t,this._source=e,this._poligonRenderer=new a}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(164),o=i(74).SelectionRenderer,l=i(8).CompositeRenderer;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype._smoothArray=function(e,t){var i,n,s,a,o,l=Array(e.length);for(i=0;i<e.length;i++){for(n=new r(0,0),s=0;s<t;s++)a=Math.max(i-s,0),o=Math.min(i+s,e.length-1),n=(n=n.add(e[a])).add(e[o]);l[i]=n.scaled(.5/t)}return l.push(e[e.length-1]),l},n.prototype._updateInternal=function(){var e,t,i,n,r,a,o,l,h;if(s.prototype._updateImpl.call(this),e=Math.max(1,this._source.properties().smooth.value()),0!==(t=this._points).length){for(i=[t[0]],n=1;n<t.length;n++){for(a=(r=t[n].subtract(t[n-1])).length(),o=Math.min(5,Math.floor(a/e)),l=r.normalized().scaled(a/o),h=0;h<o-1;h++)i.push(t[n-1].add(l.scaled(h)));i.push(t[n])}this._points=this._smoothArray(i,e)}},n.prototype.renderer=function(){var e,t,i,n;return this._invalidated&&(this._updateInternal(),this._invalidated=!1),e={},t=this._source.properties(),e.points=this._points,e.color=t.linecolor.value(),e.linewidth=t.linewidth.value(),e.linestyle=t.linestyle.value(),e.skipClosePath=!0,e.leftend=this._source.properties().leftEnd.value(),e.rightend=this._source.properties().rightEnd.value(),t.fillBackground.value()&&this._model.lineBeingCreated()!==this._source&&(e.filled=!0,e.fillBackground=!0,e.backcolor=t.backgroundColor.value(),e.transparency=t.transparency.value()),this._poligonRenderer.setData(e),this.isAnchorsRequired()&&this._source.finished()?((i=new l).append(this._poligonRenderer),e.points.length>0&&(n=[e.points[0],e.points[e.points.length-1]],i.append(new o({points:n}))),i):this._poligonRenderer},t.BrushPaneView=n},850:function(e,t,i){"use strict";function n(e){this._data=null,this._textSizeCache=e}function r(e,t){a.call(this,e,t),this._textSizeCache={},this._invalidated=!0,this._renderer=new n(this._textSizeCache)}var s=i(1).Point,a=i(12).LineSourcePaneView,o=i(4),l=i(8).CompositeRenderer,h=i(19),d=i(483).CalloutConsts;!function(){var e;n.prototype.wordWrap=function(t,i){var n,r,s,a,o,l,h,d,c;if(e||function(){var t=document.createElement("canvas");t.width=0,t.height=0,e=t.getContext("2d"),t=null}(),i=+i,(n=(t+="").split(/[^\S\r\n]*(?:\r\n|\r|\n|$)/))[n.length-1]||n.pop(),!isFinite(i)||i<=0)return n;for(e.font=this.fontStyle(),r=[],s=0;s<n.length;s++)if(a=n[s],(o=e.measureText(a).width)<=i)r.push(a);else for(l=a.split(/([-\)\]\},.!?:;])|(\s+)/);l.length;){if((h=~~(i/o*(l.length+2)/3))<=0||e.measureText(l.slice(0,3*h-1).join("")).width<=i)for(;e.measureText(l.slice(0,3*(h+1)-1).join("")).width<=i;)h++;else for(;h>0&&e.measureText(l.slice(0,3*--h-1).join("")).width>i;);if(h>0)r.push(l.slice(0,3*h-1).join("")),l.splice(0,3*h);else{if(d=l[0]+(l[1]||""),c=1===c?1:~~(i/e.measureText(d)*d.length),e.measureText(d.substr(0,c)).width<=i)for(;e.measureText(d.substr(0,c+1)).width<=i;)c++;else for(;c>1&&e.measureText(d.substr(0,--c)).width>i;);c<1&&(c=1),r.push(d.substr(0,c)),l[0]=d.substr(c),l[1]=""}if((o=e.measureText(l.join("")).width)<=i){r.push(l.join(""));break}}return r}}(),n.prototype.setData=function(e){this._data=e,this._data.lines=this.wordWrap(e.text,e.wordWrapWidth)},n.prototype.hitTest=function(e){var t,i,n,r;return null===this._data||this._data.points.length<2?null:(t=this._data.points[0],i=this._data.points[1],3,t.subtract(e).length()<3?new o(o.CHANGEPOINT,0):(n=i.x-this._textSizeCache.totalWidth/2,r=i.y-this._textSizeCache.totalHeight/2,e.x>=n&&e.x<=n+this._textSizeCache.totalWidth&&e.y>=r&&e.y<=r+this._textSizeCache.totalHeight?new o(o.MOVEPOINT):null))},n.prototype.fontStyle=function(){return(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font},n.prototype.draw=function(e){var t,i,n,r,s,a,o,l,c,p,_,u,f,g;if(!(null===this._data||this._data.points.length<2)){for(t=this._data.points[0].clone(),i=this._data.points[1].clone(),e.lineCap="butt",e.strokeStyle=this._data.bordercolor,e.lineWidth=this._data.linewidth,e.textBaseline="bottom",e.font=this.fontStyle(),n=this._data.fontSize*this._data.lines.length,r=this._data.wordWrapWidth||this._data.lines.reduce((function(t,i){return Math.max(t,e.measureText(i).width)}),0),this._textSizeCache.textHeight=n,this._textSizeCache.textHeight=r,s=d.RoundRadius,o=r+2*(a=d.TextMargins)+2*s,l=n+2*a+2*s,this._textSizeCache.totalWidth=o,this._textSizeCache.totalHeight=l,c=i.x-o/2,p=i.y-l/2,_=0,u=r+2*a>2*s,f=n+2*a>2*s,t.x>c+o?_=20:t.x>c&&(_=10),t.y>p+l?_+=2:t.y>p&&(_+=1),e.save(),e.translate(c,p),t.x-=c,t.y-=p,i.x-=c,i.y-=p,e.beginPath(),e.moveTo(s,0),10===_?u?(e.lineTo(i.x-s,0),e.lineTo(t.x,t.y),e.lineTo(i.x+s,0),e.lineTo(o-s,0)):(e.lineTo(t.x,t.y),e.lineTo(o-s,0)):e.lineTo(o-s,0),20===_?(e.lineTo(t.x,t.y),e.lineTo(o,s)):e.arcTo(o,0,o,s,s),21===_?f?(e.lineTo(o,i.y-s),e.lineTo(t.x,t.y),e.lineTo(o,i.y+s),e.lineTo(o,l-s)):(e.lineTo(t.x,t.y),e.lineTo(o,l-s)):e.lineTo(o,l-s),22===_?(e.lineTo(t.x,t.y),e.lineTo(o-s,l)):e.arcTo(o,l,o-s,l,s),12===_?u?(e.lineTo(i.x+s,l),e.lineTo(t.x,t.y),e.lineTo(i.x-s,l),e.lineTo(s,l)):(e.lineTo(t.x,t.y),e.lineTo(s,l)):e.lineTo(s,l),2===_?(e.lineTo(t.x,t.y),e.lineTo(0,l-s)):e.arcTo(0,l,0,l-s,s),1===_?f?(e.lineTo(0,i.y+s),e.lineTo(t.x,t.y),e.lineTo(0,i.y-s),e.lineTo(0,s)):(e.lineTo(t.x,t.y),e.lineTo(0,s)):e.lineTo(0,s),0===_?(e.lineTo(t.x,t.y),e.lineTo(s,0)):e.arcTo(0,0,s,0,s),e.stroke(),e.fillStyle=h.generateColor(this._data.backcolor,this._data.transparency),e.fill(),e.fillStyle=this._data.color,p=s+a+this._data.fontSize,c=s+a,g=0;g<this._data.lines.length;g++)e.fillText(this._data.lines[g],c,p),p+=this._data.fontSize;e.restore()}},inherit(r,a),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){a.prototype._updateImpl.call(this),this._source._calculatePoint2()},r.prototype.renderer=function(){var e,t,i,n,r,a,o;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),this._points[0]?this._points.length<2?void 0:(e=this._source.properties(),(t={}).points=[],t.points.push(this._points[0]),(i=this._points[1].clone()).x=this._points[0].x+this._source._barOffset*this._model.timeScale().barSpacing(),t.points.push(i),t.color=e.color.value(),t.linewidth=e.linewidth.value(),t.backcolor=e.backgroundColor.value(),t.transparency=e.transparency.value(),t.text=e.text.value(),t.font=e.font.value(),t.fontSize=e.fontsize.value(),t.bordercolor=e.bordercolor.value(),e.wordWrap&&e.wordWrap.value()&&(t.wordWrapWidth=e.wordWrapWidth.value()),t.bold=e.bold&&e.bold.value(),t.italic=e.italic&&e.italic.value(),this._renderer.setData(t),this.isAnchorsRequired()?((n=new l).append(this._renderer),r=t.points[1],(a=[].concat(t.points)).splice(a.length-1,1),n.append(this.createLineAnchor({points:a})),t.wordWrapWidth&&((o=new s(r.x+(t.wordWrapWidth>>1)+d.RoundRadius+d.TextMargins,r.y)).data=1,n.append(this.createLineAnchor({points:[o]}))),n):this._renderer):new l},t.CalloutPaneView=r},852:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._lines=[],this._invalidated=!0,this._trendRenderer=new o}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(146).VerticalLineRenderer,o=i(16).TrendLineRenderer,l=i(4),h=i(8).CompositeRenderer,d=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,r,a;if(s.prototype._updateImpl.call(this),!(this._source.points().length<2)&&(e=this._model.timeScale(),this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!e.isEmpty()&&(t=this._source.points()[0],n=(i=this._source.points()[1])?i.index-t.index:1,this._lines=[],0!==n)))if(r=e.visibleBars(),n>0)for(a=t.index;a<=r.lastBar();a+=n)this._lines.push({x:e.indexToCoordinate(a)});else for(a=t.index;a>=r.firstBar();a+=n)this._lines.push({x:e.indexToCoordinate(a)})},n.prototype.renderer=function(){var e,t,i,n,s,o,c,p,_,u,f;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new h,this._points.length<2)return e;for(t=this._points[0],i=this._points[1],n=this._source.properties(),s={points:[t,i],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:d.Normal,rightend:d.Normal},this._trendRenderer.setData(s),e.append(this._trendRenderer),o=this._model.timeScale().width(),c=this._source.priceScale().height(),n=this._source.properties(),p=0;p<this._lines.length;p++)_={width:o,height:c,points:[new r(this._lines[p].x,0)],color:n.linecolor.value(),linewidth:n.linewidth.value(),linestyle:n.linestyle.value()},(u=new a).setData(_),e.append(u);return this.isAnchorsRequired()&&(2===this._source.points().length?(f=[].concat(this._points),e.append(this.createLineAnchor({points:f}))):e.append(this.createLineAnchor({points:[new r(this._points[0].x,this._source.priceScale().height()/2)],hittestResult:l.MOVEPOINT}))),e},t.LineToolCircleLinesPaneView=n},854:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0}var r=i(12).LineSourcePaneView,s=i(412).Pattern5PaneView;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,s;r.prototype._updateImpl.call(this),this._source.points().length>=3&&(e=this._source.points()[0],t=this._source.points()[1],i=this._source.points()[2],this._ABRetracement=Math.round(1e3*Math.abs((i.price-t.price)/(t.price-e.price)))/1e3),this._source.points().length>=4&&(n=this._source.points()[3],this._BCRetracement=Math.round(1e3*Math.abs((n.price-e.price)/(t.price-e.price)))/1e3),this._source.points().length>=5&&(s=this._source.points()[4],this._CDRetracement=Math.round(1e3*Math.abs((s.price-n.price)/(n.price-i.price)))/1e3,this._XDRetracement=Math.round(1e3*Math.abs((s.price-n.price)/(e.price-n.price)))/1e3)},t.CypherPaneView=n},856:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._percentageFormatter=new d,this._pipFormatter=null,this._lastSymbolInfo=null,this._topBorderRenderer=new l,this._bottomBorderRenderer=new l,this._leftBorderRenderer=new l,this._rightBorderRenderer=new l,this._distanceLineRenderer=new l,this._distancePriceRenderer=new l,this._backgroundRenderer=new o,this._textRenderer=new a({})}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(27).TextRenderer,o=i(70).RectangleRenderer,l=i(16).TrendLineRenderer,h=i(8).CompositeRenderer,d=i(94).PercentageFormatter,c=i(175).TimeSpanFormatter,p=i(145).PipFormatter,_=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){s.prototype._updateImpl.call(this),this._invalidated=!1},n.prototype.renderer=function(){var e,t,i,n,s,a,o,l,d,u,f,g,v,w,y,m,x,b,S,P,R,T,L,C,k,I,B,M,A,D,E;return this._invalidated&&this.updateImpl(),e=new h,this._points.length<2||this._source.points().length<2||((t=this._source.properties()).fillBackground&&t.fillBackground.value()&&((i={}).points=this._points,i.color="white",i.linewidth=0,i.backcolor=t.backgroundColor.value(),i.fillBackground=!0,i.transparency=t.backgroundTransparency.value(),this._backgroundRenderer.setData(i),e.append(this._backgroundRenderer)),n=this,s=function(t,i,r){var s={};s.points=[i,r],s.width=n._model.timeScale().width(),s.height=n._source.priceScale().height(),s.color=n._source.properties().linecolor.value(),s.linewidth=n._source.properties().linewidth.value(),s.linestyle=CanvasEx.LINESTYLE_SOLID,s.extendleft=!1,s.extendright=!1,s.leftend=_.Normal,s.rightend=_.Normal,t.setData(s),e.append(t)},a=this._points[0],o=this._points[1],s(this._topBorderRenderer,a,new r(o.x,a.y)),s(this._bottomBorderRenderer,new r(a.x,o.y),o),s(this._leftBorderRenderer,a,new r(a.x,o.y)),s(this._rightBorderRenderer,new r(o.x,a.y),o),l=(a.y+o.y)/2,d=new r(a.x,l),u=new r(o.x,l),(i={}).points=[d,u],i.width=n._model.timeScale().width(),i.height=n._source.priceScale().height(),i.color=n._source.properties().linecolor.value(),i.linewidth=n._source.properties().linewidth.value(),i.linestyle=CanvasEx.LINESTYLE_DASHED,i.extendleft=!1,i.extendright=!1,i.leftend=_.Normal,i.rightend=_.Arrow,this._distanceLineRenderer.setData(i),e.append(this._distanceLineRenderer),a=this._points[0],o=this._points[1],f=(a.x+o.x)/2,d=new r(f,a.y),u=new r(f,o.y),(i={}).points=[d,u],i.width=n._model.timeScale().width(),i.height=n._source.priceScale().height(),i.color=n._source.properties().linecolor.value(),i.linewidth=n._source.properties().linewidth.value(),i.linestyle=CanvasEx.LINESTYLE_DASHED,i.extendleft=!1,i.extendright=!1,i.leftend=_.Normal,i.rightend=_.Arrow,this._distancePriceRenderer.setData(i),e.append(this._distancePriceRenderer),g=this._source.points()[0].price,y=100*(w=(v=this._source.points()[1].price)-g)/g,m=this._source.points()[0].index,b=(x=this._source.points()[1].index)-m,S=this._model.timeScale().indexToUserTime(m),P=this._model.timeScale().indexToUserTime(x),R="",S&&P&&(T=(P.valueOf()-S.valueOf())/1e3,R=", "+(new c).format(T)),(L=this._model.mainSeries().symbolInfo())&&L!==this._lastSymbolInfo&&(this._pipFormatter=new p(L.pricescale,L.minmov,L.type,L.minmove2),this._lastSymbolInfo=L),C=this._source.priceScale().formatter().format(w)+" ("+this._percentageFormatter.format(Math.round(100*y)/100)+") "+(this._pipFormatter?this._pipFormatter.format(w):"")+"\n"+$.t("{0} bars").format(b)+R,i={},v>g?((k=o.clone()).y-=2*t.fontsize.value(),k.x=.5*(a.x+o.x),i.points=[k]):((k=o.clone()).x=.5*(a.x+o.x),k.y+=.7*t.fontsize.value(),i.points=[k]),I={x:0,y:10},i.text=C,i.color=t.textcolor.value(),i.height=n._source.priceScale().height(),i.font=t.font.value(),i.offsetX=I.x,i.offsetY=I.y,i.padding=5,i.vertAlign="middle",i.horzAlign="center",i.fontsize=t.fontsize.value(),i.backgroundRoundRect=4,i.backgroundHorzInflate=.4*t.fontsize.value(),i.backgroundVertInflate=.2*t.fontsize.value(),t.fillLabelBackground&&t.fillLabelBackground.value()&&(i.backgroundColor=t.labelBackgroundColor.value(),i.backgroundTransparency=1-t.labelBackgroundTransparency.value()/100||0),t.drawBorder&&t.drawBorder.value()&&(i.borderColor=t.borderColor.value()),B=.5*(a.x+o.x),M=o.y,A=new r(B,M),this._textRenderer.setData(i),D=this._textRenderer.measure(),E={x:B+i.backgroundHorzInflate+D.textBgPadding-D.width/D.textBgPadding,y:a.y>o.y?A.y-D.height-2*D.textBgPadding-I.y>0?M-D.height-I.y+D.textBgPadding:I.y-2*D.textBgPadding:A.y+D.height+D.textBgPadding+I.y>i.height?i.height-D.height-I.y:M+D.textBgPadding},this._textRenderer.setPoints([new r(B,E.y)]),e.append(this._textRenderer),this.addAnchors(e)),e},t.DateAndPriceRangePaneView=n},858:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._leftBorderRenderer=new l,this._rightBorderRenderer=new l,this._distancePriceRenderer=new l,this._backgroundRenderer=new o,this._textRenderer=new a({})}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(27).TextRenderer,o=i(70).RectangleRenderer,l=i(16).TrendLineRenderer,h=i(8).CompositeRenderer,d=i(175).TimeSpanFormatter,c=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){s.prototype._updateImpl.call(this),this._invalidated=!1},n.prototype.renderer=function(e){var t,i,n,s,a,o,l,p,_,u,f,g,v,w,y,m,x,b,S,P,R,T,L,C,k,I,B,M;return this._invalidated&&this.updateImpl(),t=new h,this._points.length<2||this._source.points().length<2||(n=(i=this._source.properties()).extendTop.value(),s=i.extendBottom.value(),a=this._points[0],o=this._points[1],l=n?0:Math.min(a.y,o.y),p=s?e:Math.max(a.y,o.y),i.fillBackground&&i.fillBackground.value()&&((_={}).points=[new r(a.x,l),new r(o.x,p)],_.color="white",_.linewidth=0,_.backcolor=i.backgroundColor.value(),_.fillBackground=!0,_.transparency=i.backgroundTransparency.value(),this._backgroundRenderer.setData(_),t.append(this._backgroundRenderer)),u=this,(f=function(e,i,n){var r={};r.points=[i,n],r.width=u._model.timeScale().width(),r.height=u._source.priceScale().height(),r.color=u._source.properties().linecolor.value(),r.linewidth=u._source.properties().linewidth.value(),r.linestyle=CanvasEx.LINESTYLE_SOLID,r.extendleft=!1,r.extendright=!1,r.leftend=c.Normal,r.rightend=c.Normal,e.setData(r),t.append(e)})(this._leftBorderRenderer,new r(a.x,l),new r(a.x,p)),f(this._rightBorderRenderer,new r(o.x,l),new r(o.x,p)),g=(a.y+o.y)/2,v=new r(a.x,g),w=new r(o.x,g),(_={}).points=[v,w],_.width=u._model.timeScale().width(),_.height=u._source.priceScale().height(),_.color=u._source.properties().linecolor.value(),_.linewidth=u._source.properties().linewidth.value(),_.linestyle=CanvasEx.LINESTYLE_DASHED,_.extendleft=!1,_.extendright=!1,_.leftend=c.Normal,_.rightend=c.Arrow,this._distancePriceRenderer.setData(_),t.append(this._distancePriceRenderer),y=this._source.points()[0].index,x=(m=this._source.points()[1].index)-y,b=this._model.timeScale().indexToUserTime(y),S=this._model.timeScale().indexToUserTime(m),P="",b&&S&&(R=(S.valueOf()-b.valueOf())/1e3,P=", "+(new d).format(R)),T=$.t("{0} bars").format(x)+P,L={x:0,y:10},(_={}).text=T,_.color=i.textcolor.value(),_.height=u._source.priceScale().height(),_.font=i.font.value(),_.offsetX=L.x,_.offsetY=L.y,_.vertAlign="middle",_.horzAlign="center",_.fontsize=i.fontsize.value(),_.backgroundRoundRect=4,_.backgroundHorzInflate=.4*i.fontsize.value(),_.backgroundVertInflate=.2*i.fontsize.value(),i.fillLabelBackground&&i.fillLabelBackground.value()&&(_.backgroundColor=i.labelBackgroundColor.value(),_.backgroundTransparency=1-i.labelBackgroundTransparency.value()/100||0),i.drawBorder&&i.drawBorder.value()&&(_.borderColor=i.borderColor.value()),C=.5*(a.x+o.x),k=o.y,I=new r(C,k),this._textRenderer.setData(_),B=this._textRenderer.measure(),M={x:C+_.backgroundHorzInflate+B.textBgPadding-B.width/B.textBgPadding,y:a.y>o.y?I.y-B.height-2*B.textBgPadding-L.y>0?k-B.height-L.y-2*B.textBgPadding:L.y-2*B.textBgPadding:I.y+B.height+B.textBgPadding+L.y>_.height?_.height-B.height-L.y:k+B.textBgPadding},this._textRenderer.setPoints([new r(C,M.y)]),t.append(this._textRenderer),this.addAnchors(t)),t},t.DateRangePaneView=n},860:function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._label=null,this._invalidated=!0,this._trendLineRendererPoints12=new a,this._trendLineRendererPoints43=new a,this._disjointAngleRenderer=new s,this._p1LabelRenderer=new o({}),this._p2LabelRenderer=new o({}),this._p3LabelRenderer=new o({}),this._p4LabelRenderer=new o({})}var r=i(12).LineSourcePaneView,s=i(493).DisjointAngleRenderer,a=i(16).TrendLineRenderer,o=i(27).TextRenderer,l=i(8).CompositeRenderer,h=i(105).PaneRendererClockIcon;inherit(n,r),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n;r.prototype._updateImpl.call(this),this._label=null,this._source.points().length<2||this._source.priceScale()&&(e=this._source.points()[0],t=this._source.points()[1],this._price1=this._source.priceScale().formatter().format(e.price),this._price2=this._source.priceScale().formatter().format(t.price),3===this._source.points().length&&(i=this._source.points()[2],this._price3=this._source.priceScale().formatter().format(i.price),n=t.price-e.price,this._price4=this._source.priceScale().formatter().format(i.price+n)))},n.prototype.renderer=function(){var e,t,i,n,r,s,a,o,d,c,p,_,u,f,g,v,w;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new l,this._points.length<2?e:(t=this._points[0],i=this._points[1],s=this._source.properties(),a=this._model,o=this._source,this._points.length>=3&&((n=this._points[2]).x=i.x,d=i.y-t.y,(r=t.clone()).y=n.y+d,r.data=3,s.fillBackground.value()&&(c=a.timeScale().width(),p=o.priceScale().height(),_=s.extendLeft.value(),u=s.extendRight.value(),this._disjointAngleRenderer.setData({width:c,height:p,extendleft:_,extendright:u,points:[t,i,n,r],backcolor:s.backgroundColor.value(),transparency:s.transparency.value(),hittestOnBackground:TradingView.isMobile.any()}),e.append(this._disjointAngleRenderer))),f=function(e,t){return{points:[e,t],width:a.timeScale().width(),height:o.priceScale().height(),color:s.linecolor.value(),linewidth:s.linewidth.value(),linestyle:s.linestyle.value(),extendleft:s.extendLeft.value(),extendright:s.extendRight.value(),leftend:s.leftEnd.value(),rightend:s.rightEnd.value()}},g=this,v=function(t,i,n,r,s,a){var o;g._source.properties().showPrices.value()&&(o={points:[n],text:s,color:g._source.properties().textcolor.value(),horzAlign:n.x>r.x?"left":"right",vertAlign:"middle",font:g._source.properties().font.value(),offsetX:n.x>r.x?-5:5,offsetY:-5,bold:g._source.properties().bold.value(),italic:g._source.properties().italic.value(),fontsize:g._source.properties().fontsize.value()},t.setData(o),e.append(t),o={points:[r],text:a,color:g._source.properties().textcolor.value(),horzAlign:n.x<r.x?"left":"right",vertAlign:"middle",font:g._source.properties().font.value(),offsetX:n.x>r.x?-5:5,offsetY:-5,bold:g._source.properties().bold.value(),italic:g._source.properties().italic.value(),fontsize:g._source.properties().fontsize.value()},i.setData(o),e.append(i))},this._trendLineRendererPoints12.setData(f(t,i)),e.append(this._trendLineRendererPoints12),v(this._p1LabelRenderer,this._p2LabelRenderer,t,i,this._price1,this._price2),2===this._points.length?(this.addAnchors(e),e):(this._trendLineRendererPoints43.setData(f(r,n)),e.append(this._trendLineRendererPoints43),v(this._p3LabelRenderer,this._p4LabelRenderer,n,r,this._price3,this._price4),this.isAnchorsRequired()&&(w=[t,i,n,r],this._model.lineBeingCreated()===this._source&&w.pop(),e.append(this.createLineAnchor({points:w}))),!TradingView.printing&&this._source.hasAlert.value()&&!this._model.readOnly()&&t&&i&&this._source.getAlertIsActive((function(n){e.append(new h({point1:t,point2:i,color:n?s.linecolor.value():defaults("chartproperties.alertsProperties.drawingIcon.color")}))})),e))},t.DisjointAnglePaneView=n},862:function(e,t,i){"use strict";function n(){this._data=null}function r(e,t){p.call(this,e,t),this._invalidated=!0,this._renderer=new n}var s=i(1).Point,a=i(33).distanceToLine,o=i(193),l=o.rotationMatrix,h=o.scalingMatrix,d=o.translationMatrix,c=o.transformPoint,p=i(12).LineSourcePaneView,_=i(4),u=i(8).CompositeRenderer,f=i(19);n.prototype.setData=function(e){this._data=e,this._data.angleFrom=0,this._data.angleTo=2*Math.PI,this._data.clockwise=!1},n.prototype.draw=function(e){var t,i,n,r,o,p,_,u,g,v,w,y,m;if(!(null===this._data||this._data.points.length<2)){if(t=this._data.points[0],i=this._data.points[1],this._data.points.length<3)return e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),void e.stroke();if(n=this._data.points[2],(r=a(t,i,n).distance)<1)return e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),void e.stroke();o=i.subtract(t),p=t.add(i).scaled(.5),_=(_=new s(-o.y,o.x)).normalized(),n=p.add(_.scaled(r)),e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,u=o.length(),g=o.x/u,v=o.y/u,w=Math.acos(g),v<0&&(w=-w),y=this._data.points[2],m=d(-p.x,-p.y),y=c(m,y),m=l(-w),y=c(m,y),m=h(1,u/(2*r)),(y=c(m,y)).y<0?this._data.clockwise=!0:this._data.clockwise=!1,e.save(),e.beginPath(),e.translate(p.x,p.y),e.rotate(w),e.scale(1,2*r/u),e.arc(0,0,.5*u,this._data.angleFrom,this._data.angleTo,this._data.clockwise),e.restore(),e.stroke(),this._data.fillBackground&&(e.fillStyle=f.generateColor(this._data.backcolor,this._data.transparency),e.fill())}},n.prototype._additionalPointTest=function(e,t){return!0},n.prototype.hitTest=function(e){var t,i,n,r,o,p,u,f,g,v,w,y,m,x;return null===this._data||this._data.points.length<3?null:(t=this._data.points[0],i=this._data.points[1],n=this._data.points[2],r=a(t,i,n).distance,o=i.subtract(t),p=t.add(i).scaled(.5),u=(u=new s(-o.y,o.x)).normalized(),n=p.add(u.scaled(r)),f=o.length(),g=o.x/f,v=o.y/f,w=Math.acos(g),v<0&&(w=-w),y=d(-p.x,-p.y),e=c(y,e),m=c(y,this._data.points[2]),y=l(-w),e=c(y,e),m=c(y,m),y=h(1,f/(2*r)),e=c(y,e),m=c(y,m),x=e.length(),3,this._additionalPointTest(e,m)?Math.abs(x-.5*f)<=3?new _(_.MOVEPOINT):this._data.fillBackground&&!this._data.noHitTestOnBackground&&x<=.5*f?new _(_.MOVEPOINT_BACKGROUND):null:null)},inherit(r,p),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){p.prototype._updateImpl.call(this),this._invalidated=!1},r.prototype.renderer=function(){var e,t,i,n,r,o,l,h,d,c,p,_,f,g;return this._invalidated&&this.updateImpl(),this._points.length<2?t:((e={}).points=this._points,e.color=this._source.properties().color.value(),e.linewidth=this._source.properties().linewidth.value(),e.backcolor=this._source.properties().backgroundColor.value(),e.fillBackground=this._source.properties().fillBackground.value(),e.transparency=this._source.properties().transparency.value(),this._renderer.setData(e),this.isAnchorsRequired()?((t=new u).append(this._renderer),i=e.points[0],n=e.points[1],2===this._points.length?(this.addAnchors(t),t):(r=e.points[2],o=a(i,n,r).distance,l=n.subtract(i),h=i.add(n).scaled(.5),d=(d=new s(-l.y,l.x)).normalized(),r=h.add(d.scaled(o)),c=h.add(d.scaled(-o)),(p=new s(i.x,i.y)).data=0,(_=new s(n.x,n.y)).data=1,(f=new s(r.x,r.y)).data=2,(g=new s(c.x,c.y)).data=3,t.append(this.createLineAnchor({points:[p,_,f,g]})),t)):this._renderer)},t.EllipsePaneView=r},864:function(e,t,i){"use strict";function n(e,t){this._data=e,this._adapter=t}function r(e,t){a.call(this,e,t),this._invalidated=!0}var s=i(1).Point,a=i(12).LineSourcePaneView,o=i(132),l=i(4);n.prototype._textWidth=function(e){var t;return 0===this._adapter.getText().length?0:(e.save(),e.font=this._adapter.getFont(),5,t=e.measureText(this._adapter.getText()).width,e.restore(),5+t)},n.prototype._drawArrow=function(e,t,i){var n,r;e.save(),e.strokeStyle=this._adapter.getArrowColor(),e.fillStyle=this._adapter.getArrowColor(),n=this._adapter.getArrowHeight(),r=this._adapter.getDirection(),e.translate(t,i),"buy"!==r&&e.rotate(Math.PI),CanvasEx.drawArrow(e,0,0,0,n),e.restore()},n.prototype._drawText=function(e,t,i){var n,r,s=this._adapter.getText();s&&(e.save(),e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getFont(),e.fillStyle=this._adapter.getTextColor(),n=t+this._textWidth(e)/2,r=i+o.fontHeight(this._adapter.getFont())/2,e.fillText(s,n,r-1),e.restore())},n.prototype.draw=function(e){var t,i,n,r,s,a=Math.round(this._data.points[0].x+.5),l=Math.round(this._data.points[0].y);this._drawArrow(e,a,l),0!==(t=this._textWidth(e))&&(i=this._adapter.getArrowHeight(),n=this._adapter.getArrowSpacing(),r=o.fontHeight(this._adapter.getFont()),s="buy"===this._adapter.getDirection()?l+i+n:l-i-n-r,this._drawText(e,Math.round(a-t/2),s))},n.prototype.hitTest=function(e){var t,i,n,r=Math.round(this._data.points[0].x),s=Math.round(this._data.points[0].y),a=this._adapter.getArrowHeight();return"buy"===this._adapter.getDirection()?(t=s,i=s+a):(t=s-a,i=s),e.x>=r-2&&e.x<=r+2&&e.y>=t&&e.y<=i?(n=this._adapter.getTooltip(),new l(l.CUSTOM,{mouseDownHandler:function(){TradingView.TradingWidget&&TradingView.TradingWidget.journalDialog()},tooltip:""!==n?{text:n,rect:{x:r,y:t,w:2,h:i-t}}:null})):null},inherit(r,a),r.prototype._renderer=null,r.prototype._rendererCached=!1,r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){a.prototype._updateImpl.call(this),this._renderer=null,this._rendererCached=!1,this._invalidated=!1},r.prototype.renderer=function(e){var t,i,r,a,o,l;return this._invalidated&&this.updateImpl(),this._rendererCached?this._renderer:(this._rendererCached=!0,0===(i=(t=this._source).points()).length?null:(r=t._adapter,a=t._model.timeScale(),o=this._source._model.paneForSource(this._source).executionsPositionController().getXYCoordinate(r,a,i[0].index),!isFinite(o.y)||o.y<0||o.y>e||o.x<0?(this._renderer=null,null):(l={points:[new s(o.x,o.y)]},this._renderer=new n(l,r),this._renderer)))},t.ExecutionPaneView=r},866:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t)}function r(e,t){a.call(this,e,t),this._rendererCache={},this._invalidated=!0,this._baseLineRenderer=new o,this._lastLevelTrendRenderer=new o}var s=i(314).ParallelChannelRenderer,a=i(12).LineSourcePaneView,o=i(16).TrendLineRenderer,l=i(117),h=i(8).CompositeRenderer,d=i(19),c=i(18).LineEnd;inherit(n,s),n.prototype._getColor=function(){return d.generateColor(this._data.backcolor,this._data.transparency,!0)},inherit(r,a),r.prototype.update=function(){this._invalidated=!0},r.prototype._updateImpl=function(){a.prototype._updateImpl.call(this),this._cacheState=this._model._fibChannelLabelsCache.updateSource(this._source),this._floatPoints.length<3||this._source.points().length<3||(this.norm=this._floatPoints[2].subtract(this._floatPoints[0]))},r.prototype.renderer=function(){function e(e,n,r){var s,a,h,c,_;switch(i.horzLabelsAlign.value()){case"left":s=e;break;case"center":(s=e.add(n).scaled(.5)).x+=r.width/2,s.x=Math.round(s.x);break;case"right":(s=n.clone()).x+=r.width,s.x=Math.round(s.x)}a={left:r.left,top:o.topByRow(p._cacheState.row),width:r.width,height:o.rowHeight(p._cacheState.row)},h={left:Math.round(s.x-a.width),top:Math.round(s.y),width:r.width,height:a.height},"middle"===(c=i.vertLabelsAlign.value())&&(h.top-=h.height/2),"bottom"===c&&(h.top-=h.height),_=new l(d,a,h),t.append(_)}var t,i,r,s,a,o,d,p,_,u,f,g,v,w,y,m,x,b,S,P,R,T,L;if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),t=new h,this._floatPoints.length<2)return this.addAnchors(t),t;if(i=this._source.properties(),r=this._floatPoints[0],s=this._floatPoints[1],this._floatPoints.length<3)return a={points:[r,s],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:i.level1.color.value(),linewidth:i.levelsStyle.linewidth.value(),linestyle:i.levelsStyle.linestyle.value(),extendleft:i.extendLeft.value(),extendright:i.extendRight.value(),leftend:c.Normal,rightend:c.Normal},this._baseLineRenderer.setData(a),t.append(this._baseLineRenderer),this.addAnchors(t),t;for(o=this._model._fibChannelLabelsCache,d=o.canvas().get(0),p=this,_=this._source.levelsCount(),u=1;u<_;u++)if((f=i["level"+u]).visible.value()){for(g=null,v=u+1;v<=_;v++)if((w=i["level"+v]).visible.value()){g=w;break}if(!g)break;y=this.norm.scaled(f.coeff.value()),m=r.add(y),x=s.add(y),b=this.norm.scaled(g.coeff.value()),S=r.add(b),P=s.add(b),(R={}).points=[m,x,S,P],R.color=f.color.value(),R.width=this._model.timeScale().width(),R.height=this._source.priceScale().height(),R.linewidth=i.levelsStyle.linewidth.value(),R.linestyle=i.levelsStyle.linestyle.value(),R.extendleft=i.extendLeft.value(),R.extendright=i.extendRight.value(),R.backcolor=f.color.value(),R.transparency=i.transparency.value(),R.skipTopLine=!0,R.fillBackground=i.fillBackground.value(),R.hittestOnBackground=!0,(T=new n).setData(R),t.append(T),(i.showCoeffs.value()||i.showPrices.value())&&e(m,x,this._cacheState.preparedCells.cells[u-1])}for(L=null,u=_;u>=1;u--)if((f=i["level"+u]).visible.value()){L=u;break}return null!=L&&((f=i["level"+L]).visible.value()&&(y=this.norm.scaled(f.coeff.value()),a={points:[m=r.add(y),x=s.add(y)],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:f.color.value(),linewidth:i.levelsStyle.linewidth.value(),linestyle:i.levelsStyle.linestyle.value(),extendleft:i.extendLeft.value(),extendright:i.extendRight.value(),leftend:c.Normal,rightend:c.Normal},this._lastLevelTrendRenderer.setData(a),t.append(this._lastLevelTrendRenderer),(i.showCoeffs.value()||i.showPrices.value())&&e(m,x,this._cacheState.preparedCells.cells[L-1]))),this.addAnchors(t),t},t.FibChannelPaneView=r},868:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._rendererCache={},this._invalidated=!0,this._numericFormatter=new d,this._trendLineRenderer=new a}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(16).TrendLineRenderer,o=i(117),l=i(4),h=i(8).CompositeRenderer,d=i(38).NumericFormatter,c=i(494).EllipseRendererSimple,p=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype._updateImpl=function(){var e,t,i,n,a,o,l,h,d,c,p,_;if(s.prototype._updateImpl.call(this),this._cacheState=this._model._fibCirclesLabelsCache.updateSource(this._source),!(this._source.points().length<2)&&this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!this._model.timeScale().isEmpty())for(e=this._points[0],t=this._points[1],this._center=e.add(t).scaled(.5),i=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y),this._levels=[],a=this._source.properties(),o=this._source.levelsCount(),l=1;l<=o;l++)(h=a["level"+l]).visible.value()&&(d=h.coeff.value(),c=h.color.value(),(p=[]).push(new r(this._center.x-.5*i*d,this._center.y-.5*n*d)),p.push(new r(this._center.x+.5*i*d,this._center.y+.5*n*d)),_=new r(this._center.x,this._center.y+.5*n*d),this._levels.push({color:c,points:p,labelPoint:_,linewidth:h.linewidth.value(),linestyle:h.linestyle.value(),index:l}))},n.prototype.renderer=function(){var e,t,i,n,r,s,a,d,_,u,f,g,v,w,y;if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),e=new h,this._points.length<2)return e;for(i=(t=this._source.properties()).fillBackground.value(),n=t.transparency.value(),s=(r=this._model._fibCirclesLabelsCache).canvas().get(0),a=0;a<this._levels.length;a++)if(d=this._levels[a],(_={}).points=d.points,_.color=d.color,_.linewidth=d.linewidth,_.backcolor=d.color,a>0&&(_.wholePoints=this._levels[a-1].points),_.fillBackground=i,_.transparency=n,u=new l(l.MOVEPOINT,null,d.index),e.append(new c(_,u)),t.showCoeffs.value()){if(!(f=this._cacheState.preparedCells.cells[this._levels[a].index-1]))continue;g={left:f.left,top:r.topByRow(this._cacheState.row),width:f.width,height:r.rowHeight(this._cacheState.row)},v={left:Math.round(d.labelPoint.x-g.width),top:Math.round(d.labelPoint.y-g.height/2),width:f.width,height:g.height},w=new o(s,g,v),e.append(w)}return t.trendline.visible.value()&&(y={points:[this._points[0],this._points[1]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:t.trendline.color.value(),linewidth:t.trendline.linewidth.value(),linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:p.Normal,rightend:p.Normal},this._trendLineRenderer.setData(y),e.append(this._trendLineRenderer)),this.addAnchors(e),e},t.FibCirclesPaneView=n},870:function(e,t,i){"use strict";function n(e,t){a.call(this,e,t),this._rendererCache={},this._invalidated=!0,this._trendLineRenderer=new o}var r=i(1).Point,s=i(70).RectangleRenderer,a=i(12).LineSourcePaneView,o=i(16).TrendLineRenderer,l=i(117),h=i(4),d=i(8).CompositeRenderer,c=i(18).LineEnd;inherit(n,a),n.prototype.update=function(){this._invalidated=!0},n.prototype._updateImpl=function(){var e,t,i,n,r,s,o,l,h,d,c,p,_,u;if(a.prototype._updateImpl.call(this),this._cacheState=this._model._fibRetracementLabelsCache.updateSource(this._source),!(this._source.points().length<2)&&this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!this._model.timeScale().isEmpty()&&(e=this._source.points()[0],t=this._source.points()[1],i=!1,(n=this._source.properties()).reverse&&n.reverse.value()&&(i=n.reverse.value()),this._levels=[],r=i?t.price-e.price:e.price-t.price,s=i?e.price:t.price,!this._source.priceScale().isPercent()||null!==(o=this._source.ownerSource().firstValue())))for(l=this._source.levelsCount(),h=1;h<=l;h++)(d=n["level"+h]).visible.value()&&(c=d.coeff.value(),p=d.color.value(),_=s+c*r,this._source.priceScale().isPercent()&&(_=this._source.priceScale().priceRange().convertToPercent(_,o)),u=this._source.priceScale().priceToCoordinate(_),this._levels.push({color:p,y:u,linewidth:n.levelsStyle.linewidth.value(),linestyle:n.levelsStyle.linestyle.value(),index:h}))},n.prototype.renderer=function(){var e,t,i,n,a,p,_,u,f,g,v,w,y,m,x,b,S,P,R,T,L,C;if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),e=new d,this._points.length<2)return e;for(t=this._points[0],i=this._points[1],n=Math.min(t.x,i.x),a=Math.max(t.x,i.x),_=(p=this._source.properties()).fillBackground.value(),u=p.transparency.value(),f=p.extendLines.value()?this._model.timeScale().width():a,v=(g=this._model._fibRetracementLabelsCache).canvas().get(0),w=0;w<this._levels.length;w++)if(w>0&&_&&(y=this._levels[w-1],t=new r(n,this._levels[w].y),i=new r(f,y.y),(m={}).points=[t,i],m.color=this._levels[w].color,m.linewidth=0,m.backcolor=this._levels[w].color,m.fillBackground=!0,m.transparency=u,(x=new s(void 0,void 0,!0)).setData(m),e.append(x)),b={points:[t=new r(n,this._levels[w].y),i=new r(a,this._levels[w].y)],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._levels[w].color,linewidth:this._levels[w].linewidth,linestyle:this._levels[w].linestyle,extendleft:!1,extendright:p.extendLines.value(),leftend:c.Normal,rightend:c.Normal},(x=new o).setData(b),x.setHitTest(new h(h.MOVEPOINT,null,this._levels[w].index)),e.append(x),p.showCoeffs.value()||p.showPrices.value()){if(!this._cacheState.preparedCells)continue;if(!(S=this._cacheState.preparedCells.cells[this._levels[w].index-1]))continue;switch(p.horzLabelsAlign.value()){case"left":P=t;break;case"center":(P=t.add(i).scaled(.5)).x+=S.width/2,P.x=Math.round(P.x);break;case"right":p.extendLines.value()?P=new r(f-4,this._levels[w].y):((P=new r(f+4,this._levels[w].y)).x+=S.width,P.x=Math.round(P.x))}R={left:S.left,top:g.topByRow(this._cacheState.row),width:S.width,height:g.rowHeight(this._cacheState.row)},T={left:P.x-R.width,top:P.y,width:S.width,height:R.height},"middle"===(L=p.vertLabelsAlign.value())&&(T.top-=T.height/2),"bottom"===L&&(T.top-=T.height),C=new l(v,R,T),e.append(C)}return p.trendline.visible.value()&&(b={points:[this._points[0],this._points[1]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:p.trendline.color.value(),linewidth:p.trendline.linewidth.value(),linestyle:p.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal},this._trendLineRenderer.setData(b),e.append(this._trendLineRenderer)),this.addAnchors(e),e},t.FibRetracementPaneView=n},872:function(e,t,i){"use strict";function n(e,t,i){this._data=e,this._hittest=t||new d(d.MOVEPOINT),this._backHittest=i||new d(d.MOVEPOINT_BACKGROUND)}function r(e,t){o.call(this,e,t),this._rendererCache={},this._invalidated=!0,this._trendLineRenderer=new l}var s=i(1).Point,a=i(56),o=i(12).LineSourcePaneView,l=i(16).TrendLineRenderer,h=i(117),d=i(4),c=i(8).CompositeRenderer,p=i(19),_=i(18).LineEnd;n.prototype.draw=function(e){e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.translate(this._data.center.x,this._data.center.y),e.beginPath(),this._data.fullCircles?e.arc(0,0,this._data.radius,2*Math.PI,0,!1):this._data.dir>0?e.arc(0,0,this._data.radius,0,Math.PI,!1):e.arc(0,0,this._data.radius,Math.PI,0,!1),e.stroke(),this._data.fillBackground&&(this._data.radius2&&(this._data.fullCircles?e.arc(0,0,this._data.radius2,2*Math.PI,0,!0):this._data.dir>0?e.arc(0,0,this._data.radius2,Math.PI,0,!0):e.arc(0,0,this._data.radius2,0,Math.PI,!0)),e.fillStyle=p.generateColor(this._data.color,this._data.transparency,!0),e.fill())},n.prototype.hitTest=function(e){var t;return a.sign(e.y-this._data.center.y)===this._data.dir||this._data.fullCircles?(t=e.subtract(this._data.center).length(),3,Math.abs(t-this._data.radius)<3?this._hittest:this._data.hittestOnBackground&&Math.abs(t)<=this._data.radius+3?this._backHittest:null):null},inherit(r,o),r.prototype.update=function(){this._invalidated=!0},r.prototype._updateImpl=function(){var e,t,i,n,r,l,h,d,c,p,_,u;if(o.prototype._updateImpl.call(this),this._cacheState=this._model._fibSpeedResistanceArcsLabelsCache.updateSource(this._source),!(this._floatPoints.length<2)&&this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!this._model.timeScale().isEmpty())for(e=this._floatPoints[0],t=this._floatPoints[1],i=e.subtract(t).length(),this._levels=[],n=this._source.properties(),r=this._source.levelsCount(),l=1;l<=r;l++)(h=n["level"+l]).visible.value()&&(d=h.coeff.value(),c=h.color.value(),p=t.subtract(e).length()*d,_=a.sign(t.y-e.y),u=new s(e.x,e.y+_*i*d),this._levels.push({color:c,radius:p,dir:_,labelPoint:u,linewidth:h.linewidth.value(),linestyle:h.linestyle.value(),index:l}))},r.prototype.renderer=function(){var e,t,i,r,s,a,o,l,p,u,f,g,v,w,y,m;if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),e=new c,this._floatPoints.length<2)return e;for(t=this._floatPoints[0],r=(i=this._source.properties()).fillBackground.value(),s=i.transparency.value(),o=(a=this._model._fibSpeedResistanceArcsLabelsCache).canvas().get(0),l=0;l<this._levels.length;l++)if(p=this._levels[l],(u={}).center=t,u.color=p.color,u.linewidth=p.linewidth,u.radius=p.radius,u.dir=p.dir,u.transparency=s,u.fillBackground=r,u.hittestOnBackground=!0,u.fullCircles=i.fullCircles.value(),l>0&&(u.radius2=this._levels[l-1].radius),f=new d(d.MOVEPOINT,null,p.index),e.append(new n(u,f)),i.showCoeffs.value()){if(!(g=this._cacheState.preparedCells.cells[this._levels[l].index-1]))continue;v={left:g.left,top:a.topByRow(this._cacheState.row),width:g.width,height:a.rowHeight(this._cacheState.row)},w={left:Math.round(p.labelPoint.x-v.width),top:Math.round(p.labelPoint.y-v.height/2),width:g.width,height:v.height},y=new h(o,v,w),e.append(y)}return i.trendline.visible.value()&&(m={points:[this._floatPoints[0],this._floatPoints[1]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:i.trendline.color.value(),linewidth:i.trendline.linewidth.value(),linestyle:i.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:_.Normal,rightend:_.Normal},this._trendLineRenderer.setData(m),e.append(this._trendLineRenderer)),this.addAnchors(e),e},t.FibSpeedResistanceArcsPaneView=r},874:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._numericFormatter=new c,this._invalidated=!0}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(229).ChannelRenderer,o=i(27).TextRenderer,l=i(16).TrendLineRenderer,h=i(4),d=i(8).CompositeRenderer,c=i(38).NumericFormatter,p=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,r,a,o,l,h,d,c,p,_,u;if(s.prototype._updateImpl.call(this),!(this._source.points().length<2)&&this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!this._model.timeScale().isEmpty()){for(e=this._source.points()[0],t=this._source.points()[1],this._hlevels=[],i=t.price-e.price,this._source.priceScale().isPercent()&&(n=this._source.ownerSource().firstValue()),r=1;r<=7;r++)a="hlevel"+r,(o=this._source.properties()[a]).visible.value()&&(l=o.coeff.value(),h=o.color.value(),d=e.price+l*i,this._source.priceScale().isPercent()&&(d=this._source.priceScale().priceRange().convertToPercent(d,n)),c=this._source.priceScale().priceToCoordinate(d,!0),this._hlevels.push({coeff:l,color:h,y:c,index:r}));for(this._vlevels=[],p=t.index-e.index,r=1;r<=7;r++)a="vlevel"+r,(o=this._source.properties()[a]).visible.value()&&(l=o.coeff.value(),h=o.color.value(),_=Math.round(e.index+l*p),u=this._model.timeScale().indexToCoordinate(_,!0),this._vlevels.push({coeff:l,color:h,x:u,index:r}))}},n.prototype.renderer=function(){var e,t,i,n,s,c,_,u,f,g,v,w,y,m,x,b,S,P,R,T,L,C,k,I;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new d,this._floatPoints.length<2)return e;for(t=this._floatPoints[0],i=this._floatPoints[1],n=Math.min(t.x,i.x),s=Math.min(t.y,i.y),c=Math.max(t.x,i.x),_=Math.max(t.y,i.y),f=(u=this._source.properties()).grid.color.value(),g=u.grid.linewidth.value(),v=u.grid.linestyle.value(),w=0;w<this._hlevels.length;w++)t=new r(n,this._hlevels[w].y),i=new r(c,this._hlevels[w].y),u.grid.visible.value()&&(y={points:[t,i],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:f,linewidth:g,linestyle:v,extendleft:!1,extendright:!1,leftend:p.Normal,rightend:p.Normal},(m=new l).setData(y),e.append(m)),u.showLeftLabels.value()&&(x={points:[t],text:this._numericFormatter.format(this._hlevels[w].coeff),color:this._hlevels[w].color,vertAlign:"middle",horzAlign:"right",font:u.font.value(),offsetX:-5,offsetY:0,fontsize:12},e.append(new o(x))),u.showRightLabels.value()&&(b={points:[i],text:this._numericFormatter.format(this._hlevels[w].coeff),color:this._hlevels[w].color,vertAlign:"middle",horzAlign:"left",font:u.font.value(),offsetX:5,offsetY:0,fontsize:12},e.append(new o(b)));for(w=0;w<this._vlevels.length;w++)t=new r(this._vlevels[w].x,s),i=new r(this._vlevels[w].x,_),u.grid.visible.value()&&(y={points:[t,i],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:f,linewidth:g,linestyle:v,extendleft:!1,extendright:!1,leftend:p.Normal,rightend:p.Normal},(m=new l).setData(y),e.append(m)),u.showTopLabels.value()&&(S={points:[t],text:this._numericFormatter.format(this._vlevels[w].coeff),color:this._vlevels[w].color,vertAlign:"bottom",horzAlign:"center",font:u.font.value(),offsetX:0,offsetY:-5,fontsize:12},e.append(new o(S))),u.showBottomLabels.value()&&(P={points:[i],text:this._numericFormatter.format(this._vlevels[w].coeff),color:this._vlevels[w].color,vertAlign:"top",horzAlign:"center",font:u.font.value(),offsetX:0,offsetY:5,fontsize:12},e.append(new o(P)));for(R=u.fillBackground.value(),T=u.transparency.value(),t=this._floatPoints[0],i=this._floatPoints[1],w=0;w<this._hlevels.length;w++)L=new r(i.x,this._hlevels[w].y),w>0&&R&&(C=new r(i.x,this._hlevels[w-1].y),(k={}).width=this._model.timeScale().width(),k.height=this._source.priceScale().height(),k.p1=t,k.p2=L,k.p3=t,k.p4=C,k.color=this._hlevels[w].color,k.transparency=T,k.hittestOnBackground=!0,(m=new a).setData(k),e.append(m)),y={points:[t,L],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._hlevels[w].color,linewidth:u.linewidth.value(),linestyle:u.linestyle.value(),extendleft:!1,extendright:!0,leftend:p.Normal,rightend:p.Normal},(m=new l).setData(y),m.setHitTest(new h(h.MOVEPOINT,null,{type:"h",index:this._hlevels[w].index})),e.append(m);for(w=0;w<this._vlevels.length;w++)I=new r(this._vlevels[w].x,i.y),w>0&&R&&(C=new r(this._vlevels[w-1].x,i.y),(k={}).width=this._model.timeScale().width(),k.height=this._source.priceScale().height(),k.p1=t,k.p2=I,k.p3=t,k.p4=C,k.color=this._vlevels[w].color,k.transparency=T,k.hittestOnBackground=!0,(m=new a).setData(k),e.append(m)),y={points:[t,I],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._vlevels[w].color,linewidth:u.linewidth.value(),linestyle:u.linestyle.value(),extendleft:!1,extendright:!0,leftend:p.Normal,rightend:p.Normal},(m=new l).setData(y),m.setHitTest(new h(h.MOVEPOINT,null,{type:"v",index:this._vlevels[w].index})),e.append(m);return this.addAnchors(e),e},t.FibSpeedResistanceFanPaneView=n},876:function(e,t,i){"use strict";function n(){this._data=null}function r(e,t){s.call(this,e,t),this._invalidated=!0,this._trendLineRenderer=new a,this._spiralRenderer=new n}var s=i(12).LineSourcePaneView,a=i(16).TrendLineRenderer,o=i(4),l=i(8).CompositeRenderer,h=i(18).LineEnd;n.prototype.setData=function(e){this._data=e},n.prototype._fibNumbers=function(){return[0,1,2,3,5,8,13,21,34,55,89]},n.prototype._continiusFib=function(e){var t,i,n=this._fibNumbers(),r=Math.floor(e),s=Math.ceil(e);return s>=n.length?null:(t=e-r,t=Math.pow(t,1.15),i=n[s]-n[r],n[r]+i*t)},n.prototype.hitTest=function(e){var t,i,n,r,s,a,l,h,d,c,p;if(null===this._data)return null;for(t=this._data.points[0],i=this._data.points[1].subtract(t),n=e.subtract(t),s=(r=i.normalized()).transposed(),a=n.normalized(),l=Math.acos(r.dotProduct(a)),Math.asin(s.dotProduct(a))<0&&(l=2*Math.PI-l),h=n.length(),d=0;d<4;d++)if(c=l/(.5*Math.PI),null!==(p=(p=this._continiusFib(c+4*d))*i.length()/5)&&Math.abs(p-h)<5)return new o(o.MOVEPOINT);return null},n.prototype.draw=function(e){var t,i,n,r,s,a,o,l,h,d,c;if(null!==this._data){for(e.lineCap="round",e.strokeStyle=this._data.color,t=this._data.points[0],i=this._data.points[1],e.translate(t.x,t.y),r=(n=i.subtract(t)).length(),n=n.normalized(),s=Math.acos(n.x),Math.asin(n.y)<0&&(s=2*Math.PI-s),e.rotate(s),e.scale(r/5,r/5),e.lineWidth=this._data.linewidth,CanvasEx.setLineStyle(e,this._data.linestyle),50,a=Math.PI/100,e.moveTo(0,0),o=0;o<50*(this._fibNumbers().length-1);o++)l=o*a,h=this._continiusFib(o/50),d=Math.cos(l)*h,c=Math.sin(l)*h,e.lineTo(d,c);e.scale(5/r,5/r),e.rotate(-s),e.stroke()}},inherit(r,s),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){s.prototype._updateImpl.call(this),this._invalidated=!1},r.prototype.renderer=function(){var e,t;return this._invalidated&&this.updateImpl(),e=new l,this._floatPoints.length<2||((t={}).points=this._floatPoints,t.width=this._model.timeScale().width(),t.height=this._source.priceScale().height(),t.color=this._source.properties().linecolor.value(),t.linewidth=this._source.properties().linewidth.value(),t.linestyle=this._source.properties().linestyle.value(),t.extendleft=!1,t.extendright=!0,t.leftend=h.Normal,t.rightend=h.Normal,this._trendLineRenderer.setData(t),e.append(this._trendLineRenderer),(t={}).points=this._floatPoints,t.width=this._model.timeScale().width(),t.height=this._source.priceScale().height(),t.color=this._source.properties().linecolor.value(),t.linewidth=this._source.properties().linewidth.value(),t.linestyle=this._source.properties().linestyle.value(),this._spiralRenderer.setData(t),e.append(this._spiralRenderer),this.isAnchorsRequired()&&this.addAnchors(e)),e},t.FibSpiralPaneView=r},878:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._levels=[],this._invalidated=!0,this._trendRenderer=new h}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(146).VerticalLineRenderer,o=i(27).TextRenderer,l=i(70).RectangleRenderer,h=i(16).TrendLineRenderer,d=i(4),c=i(8).CompositeRenderer,p=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,r,a,o,l,h;if(s.prototype._updateImpl.call(this),!(this._source.points().length<1)&&this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!this._model.timeScale().isEmpty()&&(e=this._source.points()[0],2===this._source.points().length&&(t=this._source.points()[1]),i=this._source.properties(),n=this._source.points()[0].index,null!==this._model.timeScale().visibleBars()))for(this._levels=[],r=t?t.index-e.index:1,a=1;a<=11;a++)(o=i["level"+a]).visible.value()&&(l=Math.round(n+o.coeff.value()*r),h={index:a,x:this._model.timeScale().indexToCoordinate(l),color:o.color.value(),width:o.linewidth.value(),style:o.linestyle.value()},i.showLabels.value()&&(h.text=o.coeff.value(),h.y=this._source.priceScale().height()),this._levels.push(h))},n.prototype.renderer=function(){var e,t,i,n,s,h,_,u,f,g,v,w,y,m,x,b,S,P;for(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=this._model.timeScale().width(),t=this._source.priceScale().height(),i=new c,n=this._source.properties(),s=0;s<this._levels.length;s++)if((h={}).width=e,h.height=t,h.points=[new r(this._levels[s].x,0)],h.color=this._levels[s].color,h.linewidth=this._levels[s].width,h.linestyle=this._levels[s].style,_=new d(d.MOVEPOINT,null,this._levels[s].index),(u=new a).setData(h),u.setHitTest(_),i.append(u),s>0&&n.fillBackground.value()&&(f=this._levels[s-1],g=new r(this._levels[s].x,0),v=new r(f.x,this._source.priceScale().height()),(w={}).points=[g,v],w.color=this._levels[s].color,w.linewidth=0,w.backcolor=this._levels[s].color,w.fillBackground=!0,w.transparency=n.transparency.value(),(u=new l(void 0,void 0,!0)).setData(w),i.append(u)),void 0!==this._levels[s].text){switch(b="left"===(b=n.horzLabelsAlign.value())?"right":"right"===b?"left":"center"){case"left":m=3;break;case"center":m=0;break;case"right":m=-3}switch(n.vertLabelsAlign.value()){case"top":y=new r(this._levels[s].x,0),x=5;break;case"middle":y=new r(this._levels[s].x,.5*this._levels[s].y),x=0;break;case"bottom":y=new r(this._levels[s].x,this._levels[s].y),x=-10}S={points:[y],text:""+this._levels[s].text,color:h.color,vertAlign:"middle",horzAlign:b,font:n.font.value(),offsetX:m,offsetY:x,fontsize:12},i.append(new o(S))}return 2===this._points.length&&(P={points:[this._points[0],this._points[1]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:p.Normal,rightend:p.Normal},this._trendRenderer.setData(P),i.append(this._trendRenderer)),this.isAnchorsRequired()&&(2===this._source.points().length?i.append(this.createLineAnchor({points:this._points})):this._points.length>0&&i.append(this.createLineAnchor({points:[new r(this._points[0].x,this._source.priceScale().height()/2)],hittestResult:d.MOVEPOINT}))),i},t.FibTimeZonePaneView=n},881:function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._label1=null,this._label2=null,this._invalidated=!0,this._trendLineRendererPoints12=new a,this._trendLineRendererPoints43=new a,this._disjointAngleRenderer=new s,this._p1LabelRenderer=new o({}),this._p2LabelRenderer=new o({}),this._p3LabelRenderer=new o({}),this._p4LabelRenderer=new o({})}var r=i(12).LineSourcePaneView,s=i(493).DisjointAngleRenderer,a=i(16).TrendLineRenderer,o=i(27).TextRenderer,l=i(8).CompositeRenderer,h=i(105).PaneRendererClockIcon;inherit(n,r),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i;r.prototype._updateImpl.call(this),this._label1=null,this._label2=null,this._source.points().length<2||this._source.priceScale()&&(e=this._source.points()[0],t=this._source.points()[1],this._price1=this._source.priceScale().formatter().format(e.price),this._price2=this._source.priceScale().formatter().format(t.price),3===this._source.points().length&&(i=this._source.points()[2],this._price3=this._source.priceScale().formatter().format(i.price)))},n.prototype.renderer=function(){var e,t,i,n,r,s,a,o,d,c,p,_,u,f,g,v;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new l,this._points.length<2?e:(t=this._points[0],i=this._points[1],s=this._source.properties(),a=this._model,o=this._source,3===this._points.length&&((n=this._points[2]).x=i.x,(r=t.clone()).y=n.y,r.data=3,s.fillBackground.value()&&(d=a.timeScale().width(),c=o.priceScale().height(),p=s.extendLeft.value(),_=s.extendRight.value(),this._disjointAngleRenderer.setData({width:d,height:c,extendleft:p,extendright:_,points:[t,i,n,r],backcolor:s.backgroundColor.value(),transparency:s.transparency.value(),hittestOnBackground:TradingView.isMobile.any()}),e.append(this._disjointAngleRenderer))),u=function(e,t){return{points:[e,t],width:a.timeScale().width(),height:o.priceScale().height(),color:s.linecolor.value(),linewidth:s.linewidth.value(),linestyle:s.linestyle.value(),extendleft:s.extendLeft.value(),extendright:s.extendRight.value(),leftend:s.leftEnd.value(),rightend:s.rightEnd.value()}},this._trendLineRendererPoints12.setData(u(t,i)),e.append(this._trendLineRendererPoints12),2===this._points.length?(this.addAnchors(e),e):(f=this,(g=function(t,i,n,r,s,a){var o;f._source.properties().showPrices.value()&&(o={points:[n],text:s,color:f._source.properties().textcolor.value(),horzAlign:n.x>r.x?"left":"right",vertAlign:"middle",font:f._source.properties().font.value(),offsetX:n.x>r.x?-5:5,offsetY:-5,bold:f._source.properties().bold.value(),italic:f._source.properties().italic.value(),fontsize:f._source.properties().fontsize.value()},t.setData(o),e.append(t),o={points:[r],text:a,color:f._source.properties().textcolor.value(),horzAlign:n.x<r.x?"left":"right",vertAlign:"middle",font:f._source.properties().font.value(),offsetX:n.x>r.x?-5:5,offsetY:-5,bold:f._source.properties().bold.value(),italic:f._source.properties().italic.value(),fontsize:f._source.properties().fontsize.value()},i.setData(o),e.append(i))})(this._p1LabelRenderer,this._p2LabelRenderer,t,i,this._price1,this._price2),this._trendLineRendererPoints43.setData(u(r,n)),e.append(this._trendLineRendererPoints43),g(this._p3LabelRenderer,this._p4LabelRenderer,n,r,this._price3,this._price3),this.isAnchorsRequired()&&(v=[t,i,n,r],this._model.lineBeingCreated()===this._source&&v.pop(),e.append(this.createLineAnchor({points:v}))),!TradingView.printing&&this._source.hasAlert.value()&&!this._model.readOnly()&&t&&i&&this._source.getAlertIsActive((function(n){e.append(new h({point1:t,point2:i,color:n?s.linecolor.value():defaults("chartproperties.alertsProperties.drawingIcon.color")}))})),e))},t.FlatBottomPaneView=n},883:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(229).ChannelRenderer,o=i(27).TextRenderer,l=i(16).TrendLineRenderer,h=i(4),d=i(8).CompositeRenderer,c=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,r,a,o,l,h,d,c,p,_,u;if(s.prototype._updateImpl.call(this),!(this._source.points().length<2)&&this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!this._model.timeScale().isEmpty())for(e=this._floatPoints[0],t=this._floatPoints[1],this._fans=[],i=t.x-e.x,n=t.y-e.y,o=1;o<=9;o++)l="level"+o,(h=this._source.properties()[l]).visible.value()&&(p=(d=h.coeff1.value())/(c=h.coeff2.value()),_=h.color.value(),u=d+"/"+c,d>c?(r=t.x,a=e.y+n/p):(r=e.x+i*p,a=t.y),this._fans.push({label:u,color:_,x:r,y:a,linewidth:h.linewidth.value(),linestyle:h.linestyle.value(),index:o}))},n.prototype.renderer=function(){var e,t,i,n,s,p,_,u,f,g,v,w;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new d,this._floatPoints.length<2)return e;for(t=this._floatPoints[0],i=this._source.properties(),n=this._source.properties().fillBackground.value(),s=this._source.properties().transparency.value(),p=0;p<this._fans.length;p++)_=new r(this._fans[p].x,this._fans[p].y),n&&(this._fans[p].index<4?(u=new r(this._fans[p+1].x,this._fans[p+1].y),(f={}).width=this._model.timeScale().width(),f.height=this._source.priceScale().height(),f.p1=t,f.p2=_,f.p3=t,f.p4=u,f.color=this._fans[p].color,f.transparency=s,f.hittestOnBackground=!0,(g=new a).setData(f),e.append(g)):this._fans[p].index>4&&p>0&&(u=new r(this._fans[p-1].x,this._fans[p-1].y),(f={}).width=this._model.timeScale().width(),f.height=this._source.priceScale().height(),f.p1=t,f.p2=_,f.p3=t,f.p4=u,f.color=this._fans[p].color,f.transparency=s,f.hittestOnBackground=!0,(g=new a).setData(f),e.append(g))),v={points:[t,_],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._fans[p].color,linewidth:this._fans[p].linewidth,linestyle:this._fans[p].linestyle,extendleft:!1,extendright:!0,leftend:c.Normal,rightend:c.Normal},(g=new l).setData(v),g.setHitTest(new h(h.MOVEPOINT,null,this._fans[p].index)),e.append(g),i.showLabels.value()&&(w={points:[_],text:this._fans[p].label,color:this._fans[p].color,vertAlign:"middle",horzAlign:"left",font:i.font.value(),offsetX:0,offsetY:-5,fontsize:12},e.append(new o(w)));return this.addAnchors(e),e},t.GannFanPaneView=n},885:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._numericFormatter=new d,this._invalidated=!0}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(27).TextRenderer,o=i(70).RectangleRenderer,l=i(16).TrendLineRenderer,h=i(8).CompositeRenderer,d=i(38).NumericFormatter,c=i(18).LineEnd;inherit(n,s),n.prototype.renderer=function(){function e(e,t,i){function n(t){var i=new l;i.setData(Object.assign({},R,{points:t})),e.append(i)}var a,o,h,f,g,v,w,y,m,x=new r(s,d),b=new r(p,d),S=new r(s,_),P=new r(p,_),R={width:k._model.timeScale().width(),height:k._source.priceScale().height(),color:u.fans.color.value(),linewidth:u.linewidth.value(),linestyle:u.linestyle.value(),extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal};for(a=0;a<t.length;++a)o=i?_:t[a],h=i?d:t[a],f=i?t[a]:s,g=i?t[a]:p,v=new r(g,o),w=new r(f,o),y=new r(g,h),m=new r(f,h),n([S,y]),n([P,m]),n([x,v]),n([b,w])}var t,i,n,s,d,p,_,u,f,g,v,w,y,m,x,b,S,P,R,T,L,C,k;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),t=new h,this._points.length<2)return this.addAnchors(t),t;for(i=this._points[0],n=this._points[1],s=Math.min(i.x,n.x),d=Math.min(i.y,n.y),p=Math.max(i.x,n.x),_=Math.max(i.y,n.y),u=this._source.properties(),f=this._source.properties().fillHorzBackground.value(),g=this._source.properties().horzTransparency.value(),v=this._source.properties().fillVertBackground.value(),w=this._source.properties().vertTransparency.value(),y=0;y<this._hlevels.length;y++)y>0&&f&&(m=this._hlevels[y-1],i=new r(s,this._hlevels[y].y),n=new r(p,m.y),(x={}).points=[i,n],x.color=this._hlevels[y].color,x.linewidth=0,x.backcolor=this._hlevels[y].color,x.fillBackground=!0,x.transparency=g,(b=new o(void 0,void 0,!0)).setData(x),t.append(b)),S={points:[i=new r(s,this._hlevels[y].y),n=new r(p,this._hlevels[y].y)],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._hlevels[y].color,linewidth:u.linewidth.value(),linestyle:u.linestyle.value(),extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal},(b=new l).setData(S),t.append(b),u.showLeftLabels.value()&&(P={points:[i],text:this._numericFormatter.format(this._hlevels[y].coeff),color:this._hlevels[y].color,vertAlign:"middle",horzAlign:"right",font:u.font.value(),offsetX:-5,offsetY:0,fontsize:12},t.append(new a(P))),u.showRightLabels.value()&&(R={points:[n],text:this._numericFormatter.format(this._hlevels[y].coeff),color:this._hlevels[y].color,vertAlign:"middle",horzAlign:"left",font:u.font.value(),offsetX:5,offsetY:0,fontsize:12},t.append(new a(R)));for(y=0;y<this._vlevels.length;y++)i=new r(this._vlevels[y].x,d),n=new r(this._vlevels[y].x,_),y>0&&v&&(m=this._vlevels[y-1],T=new r(m.x,d),(x={}).points=[T,n],x.color=this._vlevels[y].color,x.linewidth=0,x.backcolor=this._vlevels[y].color,x.fillBackground=!0,x.transparency=w,(b=new o(void 0,void 0,!0)).setData(x),t.append(b)),S={points:[i,n],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._vlevels[y].color,linewidth:u.linewidth.value(),linestyle:u.linestyle.value(),extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal},(b=new l).setData(S),t.append(b),u.showTopLabels.value()&&(L={points:[i],text:this._numericFormatter.format(this._vlevels[y].coeff),color:this._vlevels[y].color,vertAlign:"bottom",horzAlign:"center",font:u.font.value(),offsetX:0,offsetY:-5,fontsize:12},t.append(new a(L))),u.showBottomLabels.value()&&(C={points:[n],text:this._numericFormatter.format(this._vlevels[y].coeff),color:this._vlevels[y].color,vertAlign:"top",horzAlign:"center",font:u.font.value(),offsetX:0,offsetY:5,fontsize:12},t.append(new a(C)));return k=this,e(t,this._hfans,!0),e(t,this._vfans,!1),this.addAnchors(t),t},n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,r,a,o,l,h,d,c,p,_,u,f,g,v;if(s.prototype._updateImpl.call(this),!(this._source.points().length<2)&&this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!this._model.timeScale().isEmpty()){for(e=this._source.points()[0],t=this._source.points()[1],n=(i=this._source.properties()).reverse&&i.reverse.value(),this._hlevels=[],r=n?e.price-t.price:t.price-e.price,a=n?t.price:e.price,this._source.priceScale().isPercent()&&(o=this._source.ownerSource().firstValue()),l=1;l<=7;l++)(h=i["hlevel"+l]).visible.value()&&(d=h.coeff.value(),c=h.color.value(),p=a+d*r,this._source.priceScale().isPercent()&&(p=this._source.priceScale().priceRange().convertToPercent(p,o)),_=this._source.priceScale().priceToCoordinate(p),this._hlevels.push({coeff:d,color:c,y:_}));for(this._vlevels=[],u=n?e.index-t.index:t.index-e.index,f=n?t.index:e.index,l=1;l<=7;l++)(h=i["vlevel"+l]).visible.value()&&(d=h.coeff.value(),c=h.color.value(),g=Math.round(f+d*u),v=this._model.timeScale().indexToCoordinate(g),this._vlevels.push({coeff:d,color:c,x:v}));if(this._hfans=[],this._vfans=[],i.fans.visible.value())for(l=1;l<=7;l++)g=Math.round(f+i["hlevel"+l].coeff.value()*u),p=a+i["vlevel"+l].coeff.value()*r,this._source.priceScale().isPercent()&&(p=this._source.priceScale().priceRange().convertToPercent(p,o)),this._hfans.push(this._model.timeScale().indexToCoordinate(g)),this._vfans.push(this._source.priceScale().priceToCoordinate(p))}},t.GannSquarePaneView=n},887:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0}var r=i(56),s=i(12).LineSourcePaneView,a=i(16).TrendLineRenderer,o=i(4),l=i(279).PaneRendererCandles,h=i(8).CompositeRenderer,d=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){s.prototype._updateImpl.call(this),this._invalidated=!0},n.prototype.udpateImpl=function(){var e=this;this._segments=[],e._points.length<2||(this._segments=this._source.segments().map((function(t,i){var n,s,a,o,l,h,d,c,p,_,u,f=e._source.points();return i>=e._points.length-1?null:(n=e._points[i].x,s=f[i].price,a=f[i+1].price,o=f[i+1].index-f[i].index,l=e._model.timeScale().barSpacing()*r.sign(o),h=(a-s)/(t.bars().length-1),d=e._source.properties(),c=d.candleStyle.upColor.value(),p=d.candleStyle.downColor.value(),_=d.candleStyle.borderUpColor.value(),u=d.candleStyle.borderDownColor.value(),{bars:t.bars().map((function(t,i){var r=t.c>=t.o;return{time:n+i*l,open:e.priceToCoordinate(t.o+s+i*h),high:e.priceToCoordinate(t.h+s+i*h),low:e.priceToCoordinate(t.l+s+i*h),close:e.priceToCoordinate(t.c+s+i*h),color:r?c:p,borderColor:r?_:u,hollow:!1}}))})})).filter((function(e){return!!e})))},n.prototype.renderer=function(){var e,t,i,n,r,s,c,p,_,u,f;for(this._invalidated&&(this.udpateImpl(),this._invalidated=!1),e=new h,t=1;t<this._points.length;t++)i={points:[this._points[t-1],this._points[t]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:d.Normal,rightend:d.Normal},(n=new a).setData(i),n.setHitTest(new o(o.MOVEPOINT,null)),e.append(n);for(s=(r=this._source.properties()).candleStyle.drawWick.value(),c=r.candleStyle.drawBorder.value(),p=r.candleStyle.borderColor.value(),_=r.candleStyle.wickColor.value(),(u=new h).setGlobalAlpha(1-r.transparency.value()/100),t=0;t<this._segments.length;t++)f={bars:this._segments[t].bars,barSpacing:this._model.timeScale().barSpacing(),drawWick:s,drawBorder:c,borderColor:p,wickColor:_,hittest:new o(o.MOVEPOINT,null)},u.append(new l(f));return e.append(u),this.addAnchors(e),e},t.GhostFeedPaneView=n},889:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._trendLineRenderer=new a,this._triangleRendererPoints234=new o,this._intersect1Renderer=new o,this._intersect2Renderer=new o,this._leftShoulderLabelRenderer=new l({}),this._headLabelRenderer=new l({}),this._rightShoulderLabelRenderer=new l({})}var r=i(98).intersectLineSegments,s=i(12).LineSourcePaneView,a=i(16).TrendLineRenderer,o=i(230).TriangleRenderer,l=i(27).TextRenderer,h=i(8).CompositeRenderer,d=i(19),c=i(18).LineEnd;inherit(n,s),n.prototype._i18nCache=function(){return{leftShoulder:$.t("Left Shoulder"),rightShoulder:$.t("Right Shoulder"),head:$.t("Head")}},n.prototype.renderer=function(){var e,t,i,n,r,s,o,l,p,_,u,f,g,v,w,y;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),this._points.length<2)return null;for(e=this._source.properties(),t=new h,i=this,n=function(t,n){return{points:[t],text:$.t(n),color:e.textcolor.value(),horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:i._source.properties().color.value(),backgroundRoundRect:4}},r=function(t,n,r,s){return{points:[t,n],width:i._model.timeScale().width(),height:i._source.priceScale().height(),color:d.generateColor(i._source.properties().color.value(),r),linewidth:s||e.linewidth.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal}},s=function(t,i,n){var r=[t,i,n],s={};return s.points=r,s.color=e.color.value(),s.linewidth=0,s.backcolor=e.backgroundColor.value(),s.fillBackground=e.fillBackground.value(),s.transparency=e.transparency.value(),s},o=1;o<this._points.length;o++)l=r(this._points[o-1],this._points[o],0),(p=new a).setData(l),t.append(p);return this._points.length>=5&&(f=!1,g=!1,this._intersect1?_=this._intersect1:(_=this._points[2],f=!0),this._intersect2?u=this._intersect2:(u=this._points[4],g=!0),(l=r(_,u,0)).extendleft=f,l.extendright=g,this._trendLineRenderer.setData(l),t.append(this._trendLineRenderer),v=s(this._points[2],this._points[3],this._points[4]),this._triangleRendererPoints234.setData(v),t.append(this._triangleRendererPoints234)),this._intersect1&&(v=s(this._intersect1,this._points[1],this._points[2]),this._intersect1Renderer.setData(v),t.append(this._intersect1Renderer)),this._intersect2&&(v=s(this._points[4],this._points[5],this._intersect2),this._intersect2Renderer.setData(v),t.append(this._intersect2Renderer)),w=this._i18nCache(),this._points.length>=2&&(y=n(this._points[1],w.leftShoulder),this._points[1].y<this._points[0].y?(y.vertAlign="bottom",y.offsetY=-10):(y.vertAlign="top",y.offsetY=5),this._leftShoulderLabelRenderer.setData(y),t.append(this._leftShoulderLabelRenderer)),this._points.length>=4&&(y=n(this._points[3],w.head),this._points[3].y<this._points[2].y?(y.vertAlign="bottom",y.offsetY=-10):(y.vertAlign="top",y.offsetY=5),this._headLabelRenderer.setData(y),t.append(this._headLabelRenderer)),this._points.length>=6&&(y=n(this._points[5],w.rightShoulder),this._points[5].y<this._points[4].y?(y.vertAlign="bottom",y.offsetY=-10):(y.vertAlign="top",y.offsetY=5),this._rightShoulderLabelRenderer.setData(y),t.append(this._rightShoulderLabelRenderer)),this.addAnchors(t),t},n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,a,o,l,h;s.prototype._updateImpl.call(this),delete this._intersect1,delete this._intersect2,this._points.length>=5&&(e=this._points[0],t=this._points[1],i=this._points[2],n=this._points[4],null!==(a=r(i,n,e,t))&&(o=n.subtract(i),this._intersect1=i.add(o.scaled(a))),7===this._points.length&&(l=this._points[5],h=this._points[6],null!==(a=r(i,n,l,h))&&(o=n.subtract(i),this._intersect2=i.add(o.scaled(a)))))},t.LineToolHeadAndShouldersPaneView=n},891:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._rendererCache={},this._labelRenderer=new a({}),this._lineRenderer=new h,this._lineRenderer.setHitTest(new o(o.MOVEPOINT))}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(27).TextRenderer,o=i(4),l=i(8).CompositeRenderer,h=i(122).HorizontalLineRenderer,d=i(105).PaneRendererClockIcon;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){s.prototype._updateImpl.call(this)},n.prototype.renderer=function(){var e,t,i,n,s,a,o,h,c,p,_;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new l,(t={}).width=this._model.timeScale().width(),t.height=this._source.priceScale().height(),t.points=this._points,t.color=this._source.properties().linecolor.value(),t.linewidth=this._source.properties().linewidth.value(),t.linestyle=this._source.properties().linestyle.value(),this._lineRenderer.setData(t),i=this._source.properties(),e.append(this._lineRenderer),this._source.properties().showLabel.value()&&1===this._points.length&&(n=i.vertLabelsAlign.value(),s=i.horzLabelsAlign.value(),a=this._points[0],o=0,h=0,"left"===s?a.x=3:"right"===s?(a.x=this._model.timeScale().width(),h=-5):a.x=this._model.timeScale().width()/2,"middle"===n?o=-this._source.properties().fontsize.value()/6:"bottom"===n&&(o=-4),c={points:[a],text:i.text.value(),color:i.textcolor.value(),vertAlign:n,horzAlign:s,font:i.font.value(),offsetX:h,offsetY:o,bold:this._source.properties().bold.value(),italic:this._source.properties().italic.value(),fontsize:this._source.properties().fontsize.value()},this._labelRenderer.setData(c),e.append(this._labelRenderer)),1===this._points.length&&this.isAnchorsRequired()&&((p=new r(this._model.timeScale().width()/2,this._points[0].y)).data=0,e.append(this.createLineAnchor({points:[p]}))),TradingView.printing||!this._source.hasAlert.value()||this._model.readOnly()||1!==this._points.length||(_=new r(this._model.timeScale().width()/2,this._points[0].y),this._source.getAlertIsActive((function(i){e.append(new d({point1:_,color:i?t.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))}))),e},t.HorzLinePaneView=n},893:function(e,t,i){"use strict";function n(){this._data=null}function r(e,t){s.call(this,e,t),this._invalidated=!0,this._renderer=new n,this._labelRenderer=new a({})}var s=i(12).LineSourcePaneView,a=i(27).TextRenderer,o=i(4),l=i(8).CompositeRenderer,h=i(105).PaneRendererClockIcon;n.prototype.setData=function(e){this._data=e},n.prototype.draw=function(e){var t,i,n,r;if(null===this._data||0===this._data.points.length)return null;t=e.canvas.width,i=this._data.points[0].y,n=Math.max(0,this._data.points[0].x),r=Math.max(t,this._data.points[0].x),e.lineCap="square",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle,CanvasEx.drawLine(e,n,i,r,i)},n.prototype.hitTest=function(e){return null===this._data||0===this._data.points.length||e.x<this._data.points[0].x?null:Math.abs(e.y-this._data.points[0].y)<=3?new o(this._data.hitTestResult):null},inherit(r,s),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){s.prototype._updateImpl.call(this)},r.prototype.renderer=function(){var e,t,i,n,r,s,a,d,c;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new l,(t={}).points=this._points,t.color=this._source.properties().linecolor.value(),t.linewidth=this._source.properties().linewidth.value(),t.linestyle=this._source.properties().linestyle.value(),t.hitTestResult=o.MOVEPOINT,i=this._source.properties(),this._renderer.setData(t),e.append(this._renderer),this._source.properties().showLabel.value()&&1===this._points.length&&(n=i.vertLabelsAlign.value(),r=i.horzLabelsAlign.value(),s=this._points[0].clone(),a=0,d=0,"right"===r?(s.x=this._model.timeScale().width(),d=-5):"center"===r&&(s.x=(s.x+this._model.timeScale().width())/2),"middle"===n?a=-this._source.properties().fontsize.value()/6:"bottom"===n&&(a=-4),c={points:[s],text:i.text.value(),color:i.textcolor.value(),vertAlign:n,horzAlign:r,font:i.font.value(),offsetX:d,offsetY:a,bold:this._source.properties().bold.value(),italic:this._source.properties().italic.value(),fontsize:this._source.properties().fontsize.value()},this._labelRenderer.setData(c),e.append(this._labelRenderer)),this.addAnchors(e),TradingView.printing||!this._source.hasAlert.value()||this._model.readOnly()||1!==this._points.length||this._source.getAlertIsActive((function(i){e.append(new h({point1:t.points[0],color:i?t.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))})),e},t.HorzRayPaneView=r},895:function(e,t,i){"use strict";function n(e){this._data=null,this._cache=e}function r(e,t){h.call(this,e,t),this._cache={},this._invalidated=!0,this._dashRenderer=new d,this._dashRenderer.setHitTest(null),this._iconRenderer=new n(this._cache)}var s=i(1).Point,a=i(193),o=a.rotationMatrix,l=a.transformPoint,h=i(12).LineSourcePaneView,d=i(16).TrendLineRenderer,c=i(4),p=i(8).CompositeRenderer,_=i(18).LineEnd;n.prototype.setData=function(e){this._data=e},n.prototype.draw=function(e){var t,i,n,r;null!=this._data&&(t=String.fromCharCode(this._data.icon),e.font=this._data.size+"px FontAwesome",i=e.measureText(t).width,e.textBaseline="middle",n=this._data.point,e.translate(n.x,n.y),e.rotate(this._data.angle-Math.PI/2),e.scale(this._data.scale,1),r=65536*this._data.icon+this._data.size,this._cache[r]=i,this._data.selected&&(e.fillStyle="rgba(80, 80, 80, 0.2)",e.fillRect(-this._cache[r]/2,-this._data.size/2,this._cache[r],this._data.size)),e.fillStyle=this._data.color,e.fillText(t,-this._cache[r]/2,0))},n.prototype.hitTest=function(e){var t,i,n,r;return null===this._data?null:(t=65536*this._data.icon+this._data.size,i=this._cache[t]*this._data.scale,n=o(-this._data.angle),r=e.subtract(this._data.point),r=l(n,r),Math.abs(r.y)<=i/2&&Math.abs(r.x)<=this._data.size/2?new c(c.MOVEPOINT):null)},inherit(r,h),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){h.prototype._updateImpl.call(this),this._invalidated=!1},r.prototype.renderer=function(){var e,t,i,n,r,a,h,d,c,u,f,g,v,w,y,m,x,b;return this._invalidated&&this.updateImpl(),e=new p,this._points.length<1||(t=this._source.properties(),i={point:this._points[0],color:t.color.value(),size:t.size.value(),icon:t.icon.value(),angle:t.angle.value(),scale:t.scale.value(),selected:this.isAnchorsRequired()},n=this._model,r=this._source,this._iconRenderer.setData(i),e.append(this._iconRenderer),this.isAnchorsRequired()&&(a=65536*i.icon+i.size,h=this._cache[a],d=i.size,c=this._points[0],u=t.scale.value(),f=this._source.getAnchorLimit(),g=new s(Math.max(f,d)/2,0),v=new s(0,Math.max(f,u*h)/2),w=o(t.angle.value()),g=l(w,g),v=l(w,v),(y=c.add(g)).data=0,(m=c.subtract(g)).data=1,(x=c.add(v)).data=2,x.square=!0,(b=c.subtract(v)).data=3,b.square=!0,i={points:[y,m],width:n.timeScale().width(),height:r.priceScale().height(),color:"#808080",linewidth:1,linestyle:CanvasEx.LINESTYLE_DASHED,extendleft:!1,extendright:!1,leftend:_.Normal,rightend:_.Normal},this._dashRenderer.setData(i),e.append(this._dashRenderer),e.append(this.createLineAnchor({points:[y,m,x,b]})))),e},t.IconPaneView=r},899:function(e,t,i){"use strict";function n(){}function r(e){this._source=e,this._data=null}function s(e,t){l.call(this,e,t),this._rendererSource=new n,this._invalidated=!0,this._renderer=new r(this._rendererSource)}var a=i(1).Point,o=i(49).pointInRectangle,l=i(12).LineSourcePaneView,h=i(27).TextRenderer,d=i(74).SelectionRenderer,c=i(4),p=i(8).CompositeRenderer,_=i(19);n.prototype.update=function(e){this._data&&(!this._data||e.markerColor===this._data.markerColor&&e.width===this._data.width&&e.height===this._data.height)||this._createSource(e.width,e.height,e.markerColor),this._data=e},n.prototype._createSource=function(e,t,i){var n,r;this._sourceCanvas=document.createElement("canvas"),this._sourceCanvas.width=e,this._sourceCanvas.height=t,this._translate=new a(-e/2,.5-t),this._translate.x%1==0&&(this._translate.x+=.5),r=.6*e,(n=this._sourceCanvas.getContext("2d")).fillStyle=i,n.beginPath(),n.moveTo(e/2,t),n.quadraticCurveTo(e,e/1.15,e,e/2),n.arc(e/2,e/2,e/2,0,Math.PI,!0),n.quadraticCurveTo(0,e/1.15,e/2,t),n.fill(),n.globalCompositeOperation="destination-out",n.beginPath(),n.moveTo((e-r)/2,e/2),n.arc(e/2,e/2,r/2,0,2*Math.PI),n.fill()},n.prototype.drawOn=function(e){var t=new a(Math.round(this._data.point.x),Math.round(this._data.point.y)).add(this._translate);e.drawImage(this._sourceCanvas,t.x,t.y)},n.prototype.hasPoint=function(e){var t=this._data.point.add(this._translate),i=new a(this._data.point.x-this._translate.x,this._data.point.y);return o(e,t,i)},r.prototype.setData=function(e){this._data=e},r.prototype.draw=function(e){null!==this._data&&(this._source.drawOn(e),this._data.tooltipVisible&&this.drawTooltipOn(e))},r.prototype.drawTooltipOn=function(e){var t,i,n,r,s,a,o,l,d,c,p,u,f,g,v;for(e.save(),t=(this._data.text+"").replace(/^\s+|\s+$/g,"").replace(/[\r\n]+/g,"\n"),e.font=(this._data.bold?"bold ":"")+(this._data.italic?"italic ":"")+this._data.fontSize+"px "+this._data.font,i=this._data.tooltipWidth-2*this._data.tooltipPadding,n=h.prototype.wordWrap(t,i,e.font),r=this._data.point,s=this._data.tooltipLineSpacing,a=this._data.tooltipWidth,o=n.length*this._data.fontSize+2*this._data.tooltipPadding,n.length>1&&(o+=(n.length-1)*s),l=Math.round(r.x-a/2),d=Math.round(r.y-this._data.height-o-8),p=(c=r.x<20||r.x+20>this._data.vpWidth)?null:"top",u=c?null:Math.round(r.x),d<10?d=r.y+13:p="bottom",l<10?l+=Math.abs(l-10):l+a+10>this._data.vpWidth&&(l-=l+a+10-this._data.vpWidth),e.fillStyle=_.generateColor(this._data.backgroundColor,this._data.backgroundTransparency),e.strokeStyle=this._data.markerColor,e.lineWidth=1,e.beginPath(),e.moveTo(l,d),c||"top"!==p||(e.lineTo(u-7,d),e.lineTo(u,d-7),e.lineTo(u+7,d)),e.lineTo(l+a,d),e.lineTo(l+a,d+o),c||"bottom"!==p||(e.lineTo(u+7,d+o),e.lineTo(u,d+o+7),e.lineTo(u-7,d+o)),e.lineTo(l,d+o),e.closePath(),e.fill(),e.stroke(),e.textBaseline="middle",e.fillStyle=this._data.textColor,f=l+this._data.tooltipPadding,g=d+this._data.tooltipPadding+this._data.fontSize/2,v=0;v<n.length;v++)e.fillText(n[v].replace(/^\s+/,""),f,g),g+=this._data.fontSize+s;e.restore()},r.prototype.hitTest=function(e){return null!==this._data&&this._source.hasPoint(e)?new c(c.MOVEPOINT):null},inherit(s,l),s.prototype.update=function(){this._invalidated=!0},s.prototype.updateImpl=function(){l.prototype._updateImpl.call(this),this._invalidated=!1},s.prototype.isLabelVisible=function(){return this.isHoveredSource()||this.isSelectedSource()},s.prototype.renderer=function(){var e,t,i,n,r,s;return this._invalidated&&this.updateImpl(),e=new p,(i=(t=this._source.properties()).locked&&t.locked.value()?this._source.fixedPoints():this._points).length<1||(r=n=this.isLabelVisible(),s=$.extend(t.state(),{point:i[0],width:24,height:32,tooltipVisible:r,vpWidth:this._model.m_timeScale.m_width,vpHeight:this._source.m_priceScale.m_height,tooltipWidth:this._source.getTooltipWidth(),tooltipPadding:this._source.getTooltipPadding(),tooltipLineSpacing:this._source.getTooltipLineSpacing()}),this._rendererSource.update(s),this._renderer.setData(s),e.append(this._renderer),n&&e.append(new d({points:i}))),e},t.NotePaneView=s},900:function(e,t,i){"use strict";function n(e,t){this._data=null,this._cache=e,this._adapter=t}function r(e,t){a.call(this,e,t),this._rendererCache={},this._renderer=new n(this._rendererCache,e._adapter)}var s=i(132),a=i(12).LineSourcePaneView,o=i(4),l=i(481).splitThousands;n.prototype.setData=function(e){this._data=e},n.prototype._height=function(){return Math.max(20,1+Math.max(s.fontHeight(this._adapter.getBodyFont()),s.fontHeight(this._adapter.getQuantityFont())))},n.prototype._bodyWidth=function(e){var t;return 0===this._adapter.getText().length?0:(e.save(),e.font=this._adapter.getBodyFont(),10,10,t=e.measureText(this._adapter.getText()).width,e.restore(),Math.round(20+t))},n.prototype._getQuantity=function(){return l(this._adapter.getQuantity()," ")},n.prototype._quantityWidth=function(e){var t;return 0===this._getQuantity().length?0:(e.save(),e.font=this._adapter.getQuantityFont(),10,t=e.measureText(this._getQuantity()).width,e.restore(),Math.round(Math.max(this._height(),10+t)))},n.prototype._cancelButtonWidth=function(){return this._adapter.isOnCancelCallbackPresent()?this._height():0},n.prototype._drawLines=function(e,t,i,n,r){e.save(),e.strokeStyle=this._adapter.getLineColor(),e.lineStyle=this._adapter.getLineStyle(),e.lineWidth=this._adapter.getLineWidth(),CanvasEx.drawLine(e,i,n,r,n),this._adapter.getExtendLeft()&&CanvasEx.drawLine(e,0,n,t,n),e.restore()},n.prototype._drawMovePoints=function(e,t,i){var n,r,s,a,o;for(e.save(),e.strokeStyle=this._adapter.getBodyBorderColor(),e.fillStyle=this._adapter.getBodyBorderColor(),2,4,5,r=(n=t+4)+2,s=Math.floor((this._height()-10)/2)+1,a=0;a<s;++a)o=i+5+2*a,CanvasEx.drawLine(e,n,o,r,o);e.restore()},n.prototype._drawBody=function(e,t,i){var n,r;e.strokeStyle=this._adapter.getBodyBorderColor(),e.fillStyle=this._adapter.getBodyBackgroundColor(),n=this._bodyWidth(e),r=this._height(),e.fillRect(t+.5,i+.5,n-1,r-1),e.strokeRect(t,i,n,r)},n.prototype._drawBodyText=function(e,t,i){var n,r;e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getBodyFont(),e.fillStyle=this._adapter.getBodyTextColor(),n=t+this._bodyWidth(e)/2,r=i+this._height()/2,e.fillText(this._adapter.getText(),5+n-2,r)},n.prototype._drawQuantity=function(e,t,i,n){var r,s;e.save(),e.strokeStyle=this._adapter.getQuantityBorderColor(),e.fillStyle=this._adapter.getQuantityBackgroundColor(),r=this._quantityWidth(e),s=this._height(),e.fillRect(t+.5,i+.5,r-1,s-1),n&&e.clip&&(e.beginPath(),e.rect(t+.5,i-.5,r+1,s+1),e.clip()),e.strokeRect(t,i,r,s),e.restore()},n.prototype._drawQuantityText=function(e,t,i){var n,r;e.save(),e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getQuantityFont(),e.fillStyle=this._adapter.getQuantityTextColor(),n=t+this._quantityWidth(e)/2,r=i+this._height()/2,e.fillText(this._getQuantity(),n,r),e.restore()},n.prototype._drawCancelButton=function(e,t,i,n){var r,s,a,o,l,h;e.strokeStyle=this._adapter.getCancelButtonBorderColor(),e.fillStyle=this._adapter.getCancelButtonBackgroundColor(),r=this._cancelButtonWidth(),s=this._height(),e.fillRect(t+.5,i+.5,r-1,s-1),this._adapter._blocked&&(e.fillStyle="rgba(140, 140, 140, 0.75)",e.fillRect(t+.5,i+.5,r-1,s-1)),e.save(),n&&e.clip&&(e.beginPath(),e.rect(t+.5,i-.5,r+1,s+1),e.clip()),e.strokeRect(t,i,r,s),e.restore(),a=t+r,o=i+s,e.strokeStyle=this._adapter.getCancelButtonIconColor(),l=(this._cancelButtonWidth()-8)/2,h=(this._height()-8)/2,CanvasEx.drawPoly(e,[{x:t+l,y:i+h},{x:a-l,y:o-h}],!0),CanvasEx.drawPoly(e,[{x:a-l,y:i+h},{x:t+l,y:o-h}],!0)},n.prototype.draw=function(e){var t,i,n,r,s,a,o,l,h,d,c;null===this._data||!this._data.points||this._data.points.length<1||(s=(t=this._data.width)-(r=(i=this._bodyWidth(e))+(n=this._quantityWidth(e))+this._cancelButtonWidth()),a=Math.max(this._adapter.getLineLength()/100*t,1),l=(o=Math.round(t-Math.min(s,a)))-r,h=Math.round(this._data.points[0].y),d=Math.round(h-(this._height()+1)/2),this._cache.bodyRight=l+i,this._cache.quantityRight=l+i+n,this._cache.top=d,this._cache.bottom=d+this._height(),this._cache.left=l,this._cache.right=o,this._drawLines(e,l,o,h,t),c=!1,0!==i&&(this._drawBody(e,l,d),this._drawMovePoints(e,l,d),this._drawBodyText(e,l,d),c=!0),0!==n&&(this._drawQuantity(e,l+i,d,c),this._drawQuantityText(e,l+i,d),c=!0),0!==this._cancelButtonWidth()&&this._drawCancelButton(e,l+i+n,d,c))},n.prototype.hitTest=function(e){return null===this._data||0===this._data.points.length||e.y<this._cache.top||e.y>this._cache.bottom?null:this._adapter._blocked&&e.x>=this._cache.left&&e.x<this._cache.right?new o(o.CUSTOM,{}):this._adapter._editable&&e.x>=this._cache.left&&e.x<this._cache.bodyRight?0===this._adapter.getTooltip().length?new o(o.MOVEPOINT):new o(o.MOVEPOINT,{tooltip:{text:this._adapter.getTooltip(),rect:{x:this._cache.left,y:this._cache.top,w:this._cache.bodyRight-this._cache.left,h:this._cache.bottom-this._cache.top}}}):this._adapter._editable&&e.x>=this._cache.bodyRight&&e.x<this._cache.quantityRight?new o(o.CUSTOM,{mouseDownHandler:this._adapter.callOnModify.bind(this._adapter),tooltip:{text:$.t("Edit Order"),rect:{x:this._cache.bodyRight,y:this._cache.top,w:this._cache.quantityRight-this._cache.bodyRight,h:this._cache.bottom-this._cache.top}}}):this._adapter._editable&&e.x>=this._cache.quantityRight&&e.x<this._cache.right?new o(o.CUSTOM,{mouseDownHandler:this._adapter.callOnCancel.bind(this._adapter),tooltip:{text:$.t("Cancel Order"),rect:{x:this._cache.quantityRight,y:this._cache.top,w:this._cache.right-this._cache.quantityRight,h:this._cache.bottom-this._cache.top}}}):null},inherit(r,a),r.prototype.renderer=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer.setData({points:this._points,width:this._model.timeScale().width()}),this._renderer},t.OrderPaneView=r},902:function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._invalidated=!0,this._renderer=new s,this._p3=null,this._p4=null}var r=i(12).LineSourcePaneView,s=i(314).ParallelChannelRenderer,a=i(105).PaneRendererClockIcon,o=i(8).CompositeRenderer;inherit(n,r),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,s,a,o,l,h,d;r.prototype._updateImpl.call(this),this._source.priceScale()&&!this._source.priceScale().isEmpty()&&0!==this._source.points().length&&(this._source._priceOffset||this._source.calculatePriceDiff(),3===this._points.length&&this._source._priceOffset&&(e=this._points[0],t=this._points[1],i=this._source._priceOffset+this._source.points()[0].price,n=this._source._priceOffset+this._source.points()[1].price,this._p3=e.clone(),this._p4=t.clone(),(s=this._source.priceScale()).isLog()?(a=.5*(i+n)-this._source._priceOffset,o=.5*(i+n),l=this._source.priceScale().priceToCoordinate(a),h=this._source.priceScale().priceToCoordinate(o)-l,this._p3.y+=h,this._p4.y+=h):(s.isPercent()&&(d=this._source.ownerSource().firstValue(),i=s.priceRange().convertToPercent(i,d),n=s.priceRange().convertToPercent(n,d)),this._p3.y=this._source.priceScale().priceToCoordinate(i),this._p4.y=this._source.priceScale().priceToCoordinate(n))))},n.prototype.renderer=function(){var e,t,i,n,r,s;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),(e={}).points=[],this._points.length>1&&(e.points.push(this._points[0]),e.points.push(this._points[1])),this._points.length>2&&null!==this._p3&&null!==this._p4&&(e.points.push(this._p3),e.points.push(this._p4)),e.color=this._source.properties().linecolor.value(),e.width=this._model.timeScale().width(),e.height=this._source.priceScale().height(),t=this._source.properties(),e.linewidth=t.linewidth.value(),e.linestyle=t.linestyle.value(),e.extendleft=t.extendLeft.value(),e.extendright=t.extendRight.value(),e.fillBackground=t.fillBackground.value(),e.backcolor=t.backgroundColor.value(),e.transparency=t.transparency.value(),e.showMidline=t.showMidline.value(),e.midlinewidth=t.midlinewidth.value(),e.midlinestyle=t.midlinestyle.value(),e.midcolor=t.midlinecolor.value(),e.fillBackground=t.fillBackground.value(),e.hittestOnBackground=!0,this._renderer.setData(e),(i=new o).append(this._renderer),this.isAnchorsRequired()&&(n=[],this._points[0]&&n.push(this._points[0]),this._points[1]&&n.push(this._points[1]),this._p3&&(n.push(this._p3.add(this._p4).scaled(.5)),n[n.length-1].data=n.length-1),r=3===this._points.length&&!this._p3,this._model.lineBeingCreated()!==this._source||r||n.pop(),i.append(this.createLineAnchor({points:n}))),!TradingView.printing&&this._source.hasAlert.value()&&!this._model.readOnly()&&this._points.length>=2&&(s=this._points,this._source.getAlertIsActive((function(e){i.append(new a({point1:s[0],point2:s[1],color:e?t.linecolor.value():defaults("chartproperties.alertsProperties.drawingIcon.color")}))}))),i},t.ParallelChannelPaneView=n},904:function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._invalidated=!0,this._medianRenderer=new a,this._sideRenderer=new a}var r=i(12).LineSourcePaneView,s=i(229).ChannelRenderer,a=i(16).TrendLineRenderer,o=i(4),l=i(8).CompositeRenderer,h=i(18).LineEnd;inherit(n,r),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){r.prototype._updateImpl.call(this),0!==this._floatPoints.length&&(3===this._floatPoints.length?(this._medianPoint=this._floatPoints[1].add(this._floatPoints[2]).scaled(.5),this._medianPoint.data=3):2===this._floatPoints.length?(this._medianPoint=this._floatPoints[1],this._medianPoint.data=3):(this._medianPoint=this._floatPoints[0],this._medianPoint.data=3))},n.prototype.renderer=function(){var e,t,i,n,r,d,c,p,_,u,f,g,v,w,y,m;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new l,this._floatPoints.length<2)return e;if(!this._medianPoint)return e;if(t={points:[this._floatPoints[0],this._medianPoint],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!0,leftend:h.Normal,rightend:h.Normal},this._medianRenderer.setData(t),e.append(this._medianRenderer),this._floatPoints.length<3)return this.addAnchors(e),e;for(i={points:[this._floatPoints[1],this._floatPoints[2]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:h.Normal,rightend:h.Normal},this._sideRenderer.setData(i),e.append(this._sideRenderer),n=0,r=this._floatPoints[2].subtract(this._floatPoints[1]).scaled(.5),d=this._source.properties().fillBackground.value(),c=this._source.properties().transparency.value(),p=0;p<=8;p++)_="level"+p,(u=this._source.properties()[_]).visible.value()&&(f=this._medianPoint.addScaled(r,u.coeff.value()),g=this._medianPoint.addScaled(r,-u.coeff.value()),d&&((v={}).width=this._model.timeScale().width(),v.height=this._source.priceScale().height(),v.p1=this._floatPoints[0],v.p2=f,v.p3=this._floatPoints[0],v.p4=this._medianPoint.addScaled(r,n),v.color=u.color.value(),v.transparency=c,v.hittestOnBackground=!0,(w=new s).setData(v),e.append(w),(v={}).width=this._model.timeScale().width(),v.height=this._source.priceScale().height(),v.p1=this._floatPoints[0],v.p2=g,v.p3=this._floatPoints[0],v.p4=this._medianPoint.addScaled(r,-n),v.color=u.color.value(),v.transparency=c,v.hittestOnBackground=!0,(w=new s).setData(v),e.append(w)),n=u.coeff.value(),y={points:[this._floatPoints[0],f],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:u.color.value(),linewidth:u.linewidth.value(),linestyle:u.linestyle.value(),extendleft:!1,extendright:!0,leftend:h.Normal,rightend:h.Normal},(w=new a).setData(y),w.setHitTest(new o(o.MOVEPOINT,null,p)),e.append(w),m={points:[this._floatPoints[0],g],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:u.color.value(),linewidth:u.linewidth.value(),linestyle:u.linestyle.value(),extendleft:!1,extendright:!0,leftend:h.Normal,rightend:h.Normal},(w=new a).setData(m),w.setHitTest(new o(o.MOVEPOINT,null,p)),e.append(w));return this.addAnchors(e),e},t.PitchfanLinePaneView=n},906:function(e,t,i){"use strict";function n(e,t){l.call(this,e,t),this._invalidated=!0,this._medianRenderer=new h,this._sideRenderer=new h}function r(e,t){n.call(this,e,t),this._invalidated=!0,this._backSideRenderer=new h}function s(e,t){r.call(this,e,t),this._invalidated=!0}function a(e,t){n.call(this,e,t),this._invalidated=!0,this._backSideRenderer=new h,this._centerRenderer=new h}var o=i(1).Point,l=i(12).LineSourcePaneView,h=i(16).TrendLineRenderer,d=i(229).ChannelRenderer,c=i(4),p=i(8).CompositeRenderer,_=i(18).LineEnd;inherit(n,l),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){l.prototype._updateImpl.call(this),0!==this._floatPoints.length&&(3===this._floatPoints.length?(this._medianPoint=this._floatPoints[1].add(this._floatPoints[2]).scaled(.5),this._medianPoint.data=3):2===this._floatPoints.length?(this._medianPoint=this._floatPoints[1],this._medianPoint.data=3):(this._medianPoint=this._floatPoints[0],this._medianPoint.data=3))},n.prototype.renderer=function(){var e,t,i,n,r,s,a,o,l,u,f,g,v,w,y,m,x,b,S,P,R;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new p,this._floatPoints.length<2)return e;if(!this._medianPoint)return e;if(t={points:[this._floatPoints[0],this._medianPoint],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!0,leftend:_.Normal,rightend:_.Normal},this._medianRenderer.setData(t),e.append(this._medianRenderer),this._floatPoints.length<3)return this.addAnchors(e),e;for(i={points:[this._floatPoints[1],this._floatPoints[2]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:_.Normal,rightend:_.Normal},this._sideRenderer.setData(i),e.append(this._sideRenderer),n=this._floatPoints[2].subtract(this._floatPoints[1]).scaled(.5),r=this._medianPoint.subtract(this._floatPoints[0]),s=0,a=this._source.properties().fillBackground.value(),o=this._source.properties().transparency.value(),l=0;l<=8;l++)u="level"+l,(f=this._source.properties()[u]).visible.value()&&(v=(g=this._medianPoint.addScaled(n,f.coeff.value())).add(r),y=(w=this._medianPoint.addScaled(n,-f.coeff.value())).add(r),a&&((m={}).p1=g,m.p2=v,m.p3=this._medianPoint.addScaled(n,s),m.p4=m.p3.add(r),m.color=f.color.value(),m.width=this._model.timeScale().width(),m.height=this._source.priceScale().height(),m.transparency=o,m.hittestOnBackground=!0,(x=new d).setData(m),e.append(x),(m={}).p1=w,m.p2=y,m.p3=this._medianPoint.addScaled(n,-s),m.p4=m.p3.add(r),m.color=f.color.value(),m.width=this._model.timeScale().width(),m.height=this._source.priceScale().height(),m.transparency=o,m.hittestOnBackground=!0,(x=new d).setData(m),e.append(x)),s=f.coeff.value(),b={points:[g,v],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:f.color.value(),linewidth:f.linewidth.value(),linestyle:f.linestyle.value(),extendleft:!1,extendright:!0,leftend:_.Normal,rightend:_.Normal},(S=new h).setData(b),S.setHitTest(new c(c.MOVEPOINT,null,l)),e.append(S),P={points:[w,y],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:f.color.value(),linewidth:f.linewidth.value(),linestyle:f.linestyle.value(),extendleft:!1,extendright:!0,leftend:_.Normal,rightend:_.Normal},(R=new h).setData(P),R.setHitTest(new c(c.MOVEPOINT,null,l)),e.append(R));return this.addAnchors(e),e},inherit(r,n),r.prototype.renderer=function(){var e,t,i,n,r,s,a,o,l,u,f,g,v,w,y,m,x,b,S,P;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new p,this._floatPoints.length<2)return e;if(t={points:[this._floatPoints[0],this._floatPoints[1]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:_.Normal,rightend:_.Normal},this._backSideRenderer.setData(t),e.append(this._backSideRenderer),!this._medianPoint||!this._modifiedBase)return this.addAnchors(e),e;if(i={points:[this._modifiedBase,this._medianPoint],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!0,leftend:_.Normal,rightend:_.Normal},this._medianRenderer.setData(i),e.append(this._medianRenderer),this._floatPoints.length<3)return this.addAnchors(e),e;for(n={points:[this._floatPoints[1],this._floatPoints[2]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:_.Normal,rightend:_.Normal},this._sideRenderer.setData(n),e.append(this._sideRenderer),r=this._floatPoints[2].subtract(this._floatPoints[1]).scaled(.5),s=this._medianPoint.subtract(this._modifiedBase),a=0,o=this._source.properties().fillBackground.value(),l=this._source.properties().transparency.value(),u=0;u<=8;u++)f="level"+u,(g=this._source.properties()[f]).visible.value()&&(w=(v=this._medianPoint.addScaled(r,g.coeff.value())).add(s),m=(y=this._medianPoint.addScaled(r,-g.coeff.value())).add(s),o&&((t={}).p1=v,t.p2=w,t.p3=this._medianPoint.addScaled(r,a),t.p4=t.p3.add(s),t.color=g.color.value(),t.width=this._model.timeScale().width(),t.height=this._source.priceScale().height(),t.transparency=l,t.hittestOnBackground=!0,(x=new d).setData(t),e.append(x),(t={}).p1=y,t.p2=m,t.p3=this._medianPoint.addScaled(r,-a),t.p4=t.p3.add(s),t.color=g.color.value(),t.width=this._model.timeScale().width(),t.height=this._source.priceScale().height(),t.transparency=l,t.hittestOnBackground=!0,(x=new d).setData(t),e.append(x)),a=g.coeff.value(),b={points:[v,w],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:g.color.value(),linewidth:g.linewidth.value(),linestyle:g.linestyle.value(),extendleft:!1,extendright:!0,leftend:_.Normal,rightend:_.Normal},(S=new h).setData(b),S.setHitTest(new c(c.MOVEPOINT,null,u)),e.append(S),P={points:[y,m],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:g.color.value(),linewidth:g.linewidth.value(),linestyle:g.linestyle.value(),extendleft:!1,extendright:!0,leftend:_.Normal,rightend:_.Normal},(x=new h).setData(P),x.setHitTest(new c(c.MOVEPOINT,null,u)),e.append(x));return this.addAnchors(e),e},r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){n.prototype.updateImpl.call(this),this._floatPoints.length>1&&(this._modifiedBase=this._floatPoints[0].add(this._floatPoints[1]).scaled(.5))},inherit(s,r),s.prototype.update=function(){this._invalidated=!0},s.prototype.updateImpl=function(){var e,t,i;n.prototype.updateImpl.call(this),this._floatPoints.length>2&&(e=this._floatPoints[0].x,t=.5*(this._floatPoints[0].y+this._floatPoints[1].y),i=new o(e,t),this._modifiedBase=i)},inherit(a,n),a.prototype.update=function(){this._invalidated=!0},a.prototype.updateImpl=function(){n.prototype.updateImpl.call(this),this._floatPoints.length>1&&(this._modifiedBase=this._floatPoints[0].add(this._floatPoints[1]).scaled(.5))},a.prototype.renderer=function(){var e,t,i,n,r,s,a,o,l,u,f,g,v,w,y,m,x,b,S,P,R;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new p,this._floatPoints.length<2)return e;if(!this._medianPoint||!this._modifiedBase)return this.addAnchors(e),e;if(3===this._floatPoints.length&&(t={points:[this._modifiedBase,this._floatPoints[2]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:_.Normal,rightend:_.Normal},this._medianRenderer.setData(t),e.append(this._medianRenderer)),i={points:[this._floatPoints[0],this._floatPoints[1]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:_.Normal,rightend:_.Normal},this._backSideRenderer.setData(i),e.append(this._backSideRenderer),this._floatPoints.length<3)return this.addAnchors(e),e;for(n={points:[this._floatPoints[1],this._floatPoints[2]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!1,leftend:_.Normal,rightend:_.Normal},this._sideRenderer.setData(n),e.append(this._sideRenderer),r=this._floatPoints[2].subtract(this._floatPoints[1]).scaled(.5),s=this._floatPoints[2].subtract(this._modifiedBase),a=0,o=this._source.properties().fillBackground.value(),l=this._source.properties().transparency.value(),u={points:[this._medianPoint,this._medianPoint.add(s)],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._source.properties().median.color.value(),linewidth:this._source.properties().median.linewidth.value(),linestyle:this._source.properties().median.linestyle.value(),extendleft:!1,extendright:!0,leftend:_.Normal,rightend:_.Normal},this._centerRenderer.setData(u),e.append(this._centerRenderer),f=0;f<=8;f++)g="level"+f,(v=this._source.properties()[g]).visible.value()&&(y=(w=this._medianPoint.addScaled(r,v.coeff.value())).add(s),x=(m=this._medianPoint.addScaled(r,-v.coeff.value())).add(s),o&&((i={}).p1=w,i.p2=y,i.p3=this._medianPoint.addScaled(r,a),i.p4=i.p3.add(s),i.color=v.color.value(),i.width=this._model.timeScale().width(),i.height=this._source.priceScale().height(),i.transparency=l,i.hittestOnBackground=!0,(b=new d).setData(i),e.append(b),(i={}).p1=m,i.p2=x,i.p3=this._medianPoint.addScaled(r,-a),i.p4=i.p3.add(s),i.color=v.color.value(),i.width=this._model.timeScale().width(),i.height=this._source.priceScale().height(),i.transparency=l,i.hittestOnBackground=!0,(b=new d).setData(i),e.append(b)),a=v.coeff.value(),S={points:[w,y],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:v.color.value(),linewidth:v.linewidth.value(),linestyle:v.linestyle.value(),extendleft:!1,extendright:!0,leftend:_.Normal,rightend:_.Normal},(P=new h).setData(S),P.setHitTest(new c(c.MOVEPOINT,null,f)),e.append(P),R={points:[m,x],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:v.color.value(),linewidth:v.linewidth.value(),linestyle:v.linestyle.value(),extendleft:!1,extendright:!0,leftend:_.Normal,rightend:_.Normal},(b=new h).setData(R),b.setHitTest(new c(c.MOVEPOINT,null,f)),e.append(b));return this.addAnchors(e),e},t.PitchforkLinePaneView=n,t.SchiffPitchforkLinePaneView=r,t.SchiffPitchfork2LinePaneView=s,t.InsidePitchforkLinePaneView=a},907:function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._invalidated=!0,this._renderer=new s}var r=i(12).LineSourcePaneView,s=i(164),a=i(8).CompositeRenderer;inherit(n,r),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){r.prototype._updateImpl.call(this),this._invalidated=!1},n.prototype.renderer=function(){var e,t;return this._invalidated&&this.updateImpl(),(e={}).points=this._points,e.color=this._source.properties().linecolor.value(),e.linewidth=this._source.properties().linewidth.value(),e.linestyle=this._source.properties().linestyle.value(),e.filled=this._source.properties().filled.value(),e.backcolor=this._source.properties().backgroundColor.value(),e.fillBackground=this._source.properties().fillBackground.value(),e.transparency=this._source.properties().transparency.value(),this._renderer.setData(e),this.isAnchorsRequired()?((t=new a).append(this._renderer),this.addAnchors(t),t):this._renderer},t.PolylinePaneView=n},909:function(e,t,i){"use strict";function n(e,t){this._data=null,this._cache=e,this._adapter=t}function r(e,t){s.call(this,e,t),this._rendererCache={},this._renderer=new n(this._rendererCache,e._adapter)}var s=i(12).LineSourcePaneView,a=i(132),o=i(4),l=i(481).splitThousands;n.prototype.setData=function(e){this._data=e},n.prototype._height=function(){return Math.max(20,1+Math.max(a.fontHeight(this._adapter.getBodyFont()),a.fontHeight(this._adapter.getQuantityFont())))},n.prototype._bodyWidth=function(e){var t;return 0===this._adapter.getText().length?0:(e.save(),e.font=this._adapter.getBodyFont(),10,t=e.measureText(this._adapter.getText()).width,e.restore(),Math.round(10+t))},n.prototype._getQuantity=function(){return l(this._adapter.getQuantity()," ")},n.prototype._quantityWidth=function(e){var t;return 0===this._getQuantity().length?0:(e.save(),e.font=this._adapter.getQuantityFont(),10,t=e.measureText(this._getQuantity()).width,e.restore(),Math.round(Math.max(this._height(),10+t)))},n.prototype._reverseButtonWidth=function(){return this._adapter.isOnReverseCallbackPresent()?this._height():0},n.prototype._closeButtonWidth=function(){return this._adapter.isOnCloseCallbackPresent()?this._height():0},n.prototype._drawLines=function(e,t,i,n,r){e.save(),e.strokeStyle=this._adapter.getLineColor(),e.lineStyle=this._adapter.getLineStyle(),e.lineWidth=this._adapter.getLineWidth(),CanvasEx.drawLine(e,i,n,r,n),this._adapter.getExtendLeft()&&CanvasEx.drawLine(e,0,n,t,n),e.restore()},n.prototype._drawBody=function(e,t,i){var n,r;e.strokeStyle=this._adapter.getBodyBorderColor(),e.fillStyle=this._adapter.getBodyBackgroundColor(),n=this._bodyWidth(e),r=this._height(),e.fillRect(t+.5,i+.5,n-1,r-1),e.strokeRect(t,i,n,r)},n.prototype._drawBodyText=function(e,t,i){var n,r;e.save(),e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getBodyFont(),e.fillStyle=this._adapter.getBodyTextColor(),n=t+this._bodyWidth(e)/2,r=i+this._height()/2,e.fillText(this._adapter.getText(),n,r),e.restore()},n.prototype._drawQuantity=function(e,t,i){var n,r;e.strokeStyle=this._adapter.getQuantityBorderColor(),e.fillStyle=this._adapter.getQuantityBackgroundColor(),n=this._quantityWidth(e),r=this._height(),e.fillRect(t+.5,i+.5,n-1,r-1),e.strokeRect(t,i,n,r)},n.prototype._drawQuantityText=function(e,t,i){var n,r;e.save(),e.textAlign="center",e.textBaseline="middle",e.font=this._adapter.getQuantityFont(),e.fillStyle=this._adapter.getQuantityTextColor(),n=t+this._quantityWidth(e)/2,r=i+this._height()/2,e.fillText(this._getQuantity(),n,r),e.restore()},n.prototype._drawReverseButton=function(e,t,i){var n,r,s,a,o;e.save(),e.strokeStyle=this._adapter.getReverseButtonBorderColor(),e.fillStyle=this._adapter.getReverseButtonBackgroundColor(),n=this._reverseButtonWidth(),r=this._height(),e.fillRect(t+.5,i+.5,n-1,r-1),e.strokeRect(t,i,n,r),e.strokeStyle=this._adapter.getReverseButtonIconColor(),s=function(e,t){CanvasEx.drawLine(e,0,0,0,t),CanvasEx.drawLine(e,-1,1,1,1),CanvasEx.drawLine(e,-2,2,2,2)},a=t+Math.round((this._reverseButtonWidth()-6)/2),o=i+5,e.save(),e.translate(a,o),s(e,10),e.translate(6,10),e.rotate(Math.PI),s(e,10),e.restore(),this._adapter._blocked&&(e.fillStyle="rgba(140, 140, 140, 0.75)",e.fillRect(t+.5,i+.5,n-1,r-1)),e.restore()},n.prototype._drawCloseButton=function(e,t,i){var n,r,s,a,o,l;e.save(),e.strokeStyle=this._adapter.getCloseButtonBorderColor(),e.fillStyle=this._adapter.getCloseButtonBackgroundColor(),n=this._closeButtonWidth(),r=this._height(),e.fillRect(t+.5,i+.5,n-1,r-1),e.strokeRect(t,i,n,r),s=t+n,a=i+r,e.strokeStyle=this._adapter.getCloseButtonIconColor(),o=(this._closeButtonWidth()-8)/2,l=(this._height()-8)/2,CanvasEx.drawPoly(e,[{x:t+o,y:i+l},{x:s-o,y:a-l}],!0),CanvasEx.drawPoly(e,[{x:s-o,y:i+l},{x:t+o,y:a-l}],!0),this._adapter._blocked&&(e.fillStyle="rgba(140, 140, 140, 0.75)",e.fillRect(t+.5,i+.5,n-1,r-1)),e.restore()},n.prototype.draw=function(e){var t,i,n,r,s,a,o,l,h,d,c;null===this._data||!this._data.points||this._data.points.length<1||(a=(t=this._data.width)-(s=(i=this._bodyWidth(e))+(n=this._quantityWidth(e))+(r=this._reverseButtonWidth(e))+this._closeButtonWidth()),o=Math.max(this._adapter.getLineLength()/100*t,1),h=(l=Math.round(t-Math.min(a,o)))-s,d=Math.round(this._data.points[0].y),c=Math.round(d-(this._height()+1)/2),this._cache.bodyRight=h+i,this._cache.quantityRight=this._cache.bodyRight+n,this._cache.reverseButtonRight=this._cache.quantityRight+r,this._cache.top=c,this._cache.bottom=c+this._height(),this._cache.left=h,this._cache.right=l,this._drawLines(e,h,l,d,t),0!==i&&(this._drawBody(e,h,c),this._drawBodyText(e,h,c)),0!==n&&(this._drawQuantity(e,this._cache.bodyRight,c),this._drawQuantityText(e,this._cache.bodyRight,c)),0!==r&&this._drawReverseButton(e,this._cache.quantityRight,c),0!==this._closeButtonWidth()&&this._drawCloseButton(e,this._cache.reverseButtonRight,c))},n.prototype.hitTest=function(e){return null===this._data||0===this._data.points.length||e.y<this._cache.top||e.y>this._cache.bottom||e.x<this._cache.left||this._cache.right<e.x?null:this._adapter._blocked?new o(o.CUSTOM,{}):e.x>=this._cache.bodyRight&&e.x<this._cache.quantityRight&&this._adapter._onModifyCallback?new o(o.CUSTOM,{mouseDownHandler:this._adapter.callOnModify.bind(this._adapter),tooltip:{text:$.t("Edit Position"),rect:{x:this._cache.bodyRight,y:this._cache.top,w:this._cache.quantityRight-this._cache.bodyRight,h:this._cache.bottom-this._cache.top}}}):e.x>=this._cache.quantityRight&&e.x<this._cache.reverseButtonRight?new o(o.CUSTOM,{mouseDownHandler:this._adapter.callOnReverse.bind(this._adapter),tooltip:{text:$.t("Reverse Position"),rect:{x:this._cache.quantityRight,y:this._cache.top,w:this._cache.reverseButtonRight-this._cache.quantityRight,h:this._cache.bottom-this._cache.top}}}):e.x>=this._cache.reverseButtonRight&&e.x<this._cache.right?new o(o.CUSTOM,{mouseDownHandler:this._adapter.callOnClose.bind(this._adapter),tooltip:{text:$.t("Close Position"),rect:{x:this._cache.reverseButtonRight,y:this._cache.top,w:this._cache.right-this._cache.reverseButtonRight,h:this._cache.bottom-this._cache.top}}}):new o(o.REGULAR,{mouseDownHandler:function(){}})},inherit(r,s),r.prototype.renderer=function(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer.setData({points:this._points,width:this._model.timeScale().width()}),this._renderer},t.PositionPaneView=r},911:function(e,t,i){"use strict";function n(){this._data=null,this._targetFontSize1=11,this._targetFontSize2=11,this._targetFontSize3=14,this._font="Arial",this._sourceFontSize1=12,this._sourceFontSize2=10}function r(e,t){h.call(this,e,t),this._clockWhite=_("prediction-clock-white",TradingView.wrapUrl("images/prediction-clock-white.png")),this._clockBlack=_("prediction-clock-black",TradingView.wrapUrl("images/prediction-clock-black.png")),this._successIcon=_("prediction-success-white",TradingView.wrapUrl("images/prediction-success-white.png")),this._failureIcon=_("prediction-failure-white",TradingView.wrapUrl("images/prediction-failure-white.png")),this._percentageFormatter=new f,this._invalidated=!0,this._renderer=new n}var s=i(1).Point,a=i(53),o=a.parseRgb,l=a.rgbToBlackWhiteString,h=i(12).LineSourcePaneView,d=i(57).Interval,c=i(4),p=i(8).CompositeRenderer,_=i(392),u=i(56),f=i(94).PercentageFormatter,g=i(228).DateFormatter,v=i(174).TimeFormatter,w=i(175).TimeSpanFormatter,y=i(19),m=i(487);n.prototype.setData=function(e){this._data=e},n.prototype.drawBalloon=function(e,t,i,n,r,a){var o,l,h=a||20;return e.beginPath(),"down"===r?(o=new s(t.x-h,t.y-6-5-n),e.moveTo(o.x+3,o.y),e.lineTo(o.x+i-3,o.y),e.arcTo(o.x+i,o.y,o.x+i,o.y+3,3),e.lineTo(o.x+i,o.y+n-3),e.arcTo(o.x+i,o.y+n,o.x+i-3,o.y+n,3),e.lineTo(o.x+h+5,o.y+n),e.lineTo(o.x+h,o.y+n+5),e.lineTo(o.x+h-5,o.y+n),e.lineTo(o.x+3,o.y+n),e.arcTo(o.x,o.y+n,o.x,o.y+n-3,3),e.lineTo(o.x,o.y+3),e.arcTo(o.x,o.y,o.x+3,o.y,3),o):(l=new s(t.x-h,t.y+6+5+n),e.moveTo(l.x+3,l.y),e.lineTo(l.x+i-3,l.y),e.arcTo(l.x+i,l.y,l.x+i,l.y-3,3),e.lineTo(l.x+i,l.y-n+3),e.arcTo(l.x+i,l.y-n,l.x+i-3,l.y-n,3),e.lineTo(l.x+h+5,l.y-n),e.lineTo(l.x+h,l.y-n-5),e.lineTo(l.x+h-5,l.y-n),e.lineTo(l.x+3,l.y-n),e.arcTo(l.x,l.y-n,l.x,l.y-n+3,3),e.lineTo(l.x,l.y-3),e.arcTo(l.x,l.y,l.x+3,l.y,3),new s(l.x,l.y-n))},n.prototype.drawTargetLabel=function(e){var t,i,n,r,s,a,o,l,h,d,c,p,_,u,f,g,v,w=this._data.points[1];if(e.save(),e.translate(.5,.5),e.font="normal "+this._targetFontSize3+"px "+this._font,t=1.5*this._targetFontSize1+1.5*this._targetFontSize2+3,i=e.measureText(this._data.targetLine1).width,n=e.measureText(this._data.targetLine2).width,e.font="normal "+this._targetFontSize2+"px "+this._font,r=e.measureText(this._data.targetLine3).width,s=e.measureText(this._data.targetLine4).width,a=Math.max(i+n,r+s+10)+20,o="up"===this._data.direction?"down":"up",l=w.x+a-e.canvas.width+5,l=Math.max(20,Math.min(a-15,l)),h=this.drawBalloon(e,w,a,t,o,l),e.save(),e.fillStyle=y.generateColor(this._data.targetBackColor,this._data.transparency),e.fill(),e.restore(),e.save(),e.lineWidth=2,e.strokeStyle=y.generateColor(this._data.targetStrokeColor,this._data.transparency),e.stroke(),e.restore(),3,e.beginPath(),e.arc(w.x,w.y,3,0,2*Math.PI,!1),e.fillStyle=this._data.centersColor,e.fill(),e.textAlign="left",6,4,e.fillStyle=this._data.targetTextColor,e.font="normal "+this._targetFontSize3+"px "+this._font,e.fillText(this._data.targetLine1,h.x+6,h.y+this._targetFontSize1+4),13,5,e.fillText(this._data.targetLine2,h.x+6+i+5,h.y+this._targetFontSize1+4),e.font="normal "+this._targetFontSize2+"px "+this._font,d=h.y+this._targetFontSize1+8+this._targetFontSize2,e.fillText(this._data.targetLine3,h.x+6,d),e.drawImage(this._data.clockWhite,h.x+6+r+6,d-this._targetFontSize2+3),e.fillText(this._data.targetLine4,h.x+6+r+13+5,d),this._data.status){switch(c=this._targetFontSize1+4,e.font="bold "+this._targetFontSize1+"px "+this._font,this._data.status){case m.AlertStatus.Success:p=$.t("SUCCESS"),_=y.generateColor(this._data.successBackground,this._data.transparency),u=this._data.successTextColor,f=this._data.successIcon;break;case m.AlertStatus.Failure:p=$.t("FAILURE"),_=y.generateColor(this._data.failureBackground,this._data.transparency),u=this._data.failureTextColor,f=this._data.failureIcon}g=e.measureText(p).width,v=Math.round((a-g)/2),e.fillStyle=_,"up"===this._data.direction?(e.roundRect(h.x-1,h.y-c-2,a+2,c,5),e.fill(),e.fillStyle=u,e.fillText(p,h.x+v,h.y-5),e.drawImage(f,h.x+v-13,h.y-14)):(e.roundRect(h.x-1,h.y+t+3,a+2,c,5),e.fill(),e.fillStyle=u,e.fillText(p,h.x+v,h.y+t+c-1),e.drawImage(f,h.x+v-13,h.y+t+5)),e.restore()}else e.restore()},n.prototype.drawStartLabel=function(e){var t,i,n,r,s,a;e.save(),e.translate(.5,.5),e.font="normal "+this._sourceFontSize1+"px "+this._font,t=1.5*this._sourceFontSize1+1.5*this._sourceFontSize2,i=e.measureText(this._data.sourceLine1).width,e.font="normal "+this._fontsize2+"px "+this._font,n=e.measureText(this._data.sourceLine2).width,r=Math.max(i,n)-5,s=this._data.points[0],a=this.drawBalloon(e,s,r,t,this._data.direction),e.fillStyle=y.generateColor(this._data.sourceBackColor,this._data.transparency),e.fill(),e.lineWidth=2,e.strokeStyle=y.generateColor(this._data.sourceStrokeColor,this._data.transparency),e.stroke(),e.beginPath(),e.arc(s.x,s.y,3,0,2*Math.PI,!1),e.fillStyle=this._data.centersColor,e.fill(),e.textAlign="left",e.fillStyle=this._data.sourceTextColor,e.font="normal "+this._sourceFontSize1+"px "+this._font,e.fillText(this._data.sourceLine1,a.x+3,a.y+this._sourceFontSize1+2),e.font="normal "+this._sourceFontSize2+"px "+this._font,e.fillText(this._data.sourceLine2,a.x+3,a.y+this._sourceFontSize1+4+this._sourceFontSize2),e.restore()},n.prototype.draw=function(e){var t,i,n,r,s,a,o,l,h,d,c,p,_,u;if(!(null===this._data||this._data.points.length<2)){if(e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.lineStyle=this._data.linestyle,t=this._data.points[0],n=(i=this._data.points[1]).subtract(t),Math.abs(n.x)<1||Math.abs(n.y)<1?(e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(i.x,i.y),e.stroke()):(e.save(),e.beginPath(),e.translate(t.x,t.y),e.scale(1,n.y/n.x),e.moveTo(0,0),e.arcTo(n.x,0,n.x,n.x,Math.abs(n.x)),e.lineTo(n.x,n.x),e.restore(),e.stroke()),this.drawTargetLabel(e),this.drawStartLabel(e),r=Math.max(8,4*this._data.linewidth),e.fillStyle=this._data.color,s=n.y<0?1:-1,Math.abs(n.x)<1||Math.abs(n.y)<1)a=Math.atan(n.x/n.y);else{if(o=Math.abs(n.x),l=Math.abs(n.y),c=((h=0)+(d=Math.PI/2))/2,n.length()>r)for(;p=o*Math.sin(c),_=l*(1-Math.cos(c)),u=Math.sqrt((p-o)*(p-o)+(_-l)*(_-l)),!(Math.abs(u-r)<1);)u>r?h=c:d=c,c=(h+d)/2;a=Math.atan((o-p)/(l-_)),n.x*n.y<0&&(a=-a)}e.save(),e.beginPath(),e.translate(i.x,i.y),e.rotate(-a),e.moveTo(0,0),e.lineTo(-r/2,s*r),e.lineTo(r/2,s*r),e.lineTo(0,0),e.restore(),e.fill()}},n.prototype.targetLabelHitTest=function(e){var t,i,n,r,s,a,o,l=this._data.points[1],h=1.5*this._targetFontSize1+1.5*this._targetFontSize2,d=this._targetFontSize1*this._data.targetLine1.length,p=this._targetFontSize1*this._data.targetLine2.length,_=this._targetFontSize2*this._data.targetLine3.length,u=this._targetFontSize2*this._data.targetLine4.length;return this._data.status&&(h+=1.5*this._targetFontSize1),t=Math.max(d+p,_+u)-20,20,5,i="up"===this._data.direction?-1:1,n=l.x-20,r=l.y+5*i,s=l.y+(5+h)*i,a=Math.min(r,s),o=Math.max(r,s),e.x>=n&&e.x<=n+t&&e.y>=a&&e.y<=o?new c(c.MOVEPOINT):null},n.prototype.sourceLabelHitTest=function(e){var t=1.5*this._sourceFontSize1+1.5*this._sourceFontSize2,i=this._sourceFontSize1*this._data.sourceLine1.length,n=this._sourceFontSize2*this._data.sourceLine2.length,r=Math.max(i,n),s=this._data.points[0],a="up"===this._data.direction?1:-1,o=s.x-20,l=s.y+5*a,h=s.y+(5+t)*a,d=Math.min(l,h),p=Math.max(l,h);return e.x>=o&&e.x<=o+r&&e.y>=d&&e.y<=p?new c(c.MOVEPOINT):null},n.prototype.hitTest=function(e){var t,i,n,r,s,a,o;return null===this._data||this._data.points.length<2?null:(t=this._data.points[0],(i=this._data.points[1]).subtract(t),n=i.subtract(t),r=e.subtract(t),s=Math.abs(n.x),a=Math.abs(n.y),o=u.sign(n.y)*(a-a*Math.sqrt(1-r.x*r.x/(s*s))),3,Math.abs(o-r.y)<3?new c(c.MOVEPOINT):this.targetLabelHitTest(e)||this.sourceLabelHitTest(e))},inherit(r,h),r.prototype.renderer=function(){var e,t,i;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),(e={}).points=this._points,e.color=this._source.properties().linecolor.value(),e.linewidth=this._source.properties().linewidth.value(),e.targetLine1=this._targetLine1,e.targetLine2=this._targetLine2,e.targetLine3=this._targetLine3,e.targetLine4=this._targetLine4,e.status=this._source.properties().status.value(),e.transparency=this._source.properties().transparency.value(),e.targetBackColor=this._source.properties().targetBackColor.value(),e.targetStrokeColor=this._source.properties().targetStrokeColor.value(),e.targetTextColor=this._source.properties().targetTextColor.value(),e.sourceBackColor=this._source.properties().sourceBackColor.value(),e.sourceStrokeColor=this._source.properties().sourceStrokeColor.value(),e.sourceTextColor=this._source.properties().sourceTextColor.value(),e.successBackground=this._source.properties().successBackground.value(),e.successTextColor=this._source.properties().successTextColor.value(),e.failureBackground=this._source.properties().failureBackground.value(),e.failureTextColor=this._source.properties().failureTextColor.value(),e.intermediateBackColor=this._source.properties().intermediateBackColor.value(),e.intermediateTextColor=this._source.properties().intermediateTextColor.value(),e.sourceLine1=this._sourceLine1,e.sourceLine2=this._sourceLine2,e.direction=this._direction,e.clockWhite=this._clockWhite,e.clockBlack=this._clockBlack,e.successIcon=this._successIcon,e.failureIcon=this._failureIcon,e.finished=this._finished,t=l(o(this._model._properties.paneProperties.background.value()),150),e.centersColor="black"===t?"white":"black",this._renderer.setData(e),this.isAnchorsRequired()?((i=new p).append(this._renderer),this.addAnchors(i),i):this._renderer},r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){var e,t,i,n,r,s,a,o,l,c,p;h.prototype._updateImpl.call(this),this._targetLine1="",this._targetLine2="",this._targetLine3="",this._targetLine4="",this._source.points().length<2||this._source.priceScale()&&(e=this._source.points()[1],t=this._source.points()[0],this._targetLine3=this._source.priceScale().formatter().format(e.price),n=(i=e.price-t.price)<0?"-":"+",this._targetLine1=this._source.priceScale().formatter().format(Math.abs(i)),r=Math.abs(Math.round(i/t.price*1e4)/100),this._targetLine1=n+this._targetLine1+" ("+n+this._percentageFormatter.format(r)+")",s=this._model.timeScale().indexToUserTime(t.index),a=this._model.timeScale().indexToUserTime(e.index),t.time&&e.time&&(s=TradingView.isString(t.time)?new Date(Date.parse(t.time)):t.time,a=TradingView.isString(e.time)?new Date(Date.parse(e.time)):e.time),o=this._model.mainSeries().isDWM(),l=d.kind(this._model.mainSeries().interval())===d.SECONDS,a&&s&&(this._targetLine4=(new g).format(a),o||(this._targetLine4=this._targetLine4+"  "+new v(l?"%h:%m:%s":"%h:%m").format(a)),c=(a.valueOf()-s.valueOf())/1e3,this._targetLine2=$.t("in",{context:"dates"})+" "+(new w).format(c)),this._sourceLine1=this._source.priceScale().formatter().format(t.price),this._sourceLine2="",(p=this._model.timeScale().indexToUserTime(t.index))&&(this._sourceLine2=(new g).format(p),o||(this._sourceLine2=this._sourceLine2+" "+new v(l?"%h:%m:%s":"%h:%m").format(p))),this._direction=this._source.direction()===m.Direction.Up?"up":"down",this._finished=this._model.lineBeingCreated()!==this._source&&this._model.lineBeingEdited()!==this._source&&this._model.sourceBeingMoved()!==this._source)},t.PredictionPaneView=r},913:function(e,t,i){"use strict";function n(e,t){this._data=null,this._measureCache=e,this._chartModel=t,this._points=null}function r(e,t,i){o.call(this,e,t),this._image=c("price_label",TradingView.wrapUrl("images/price_label.png")),this._rendererCache={},this._invalidated=!0,this._renderer=new n(this._rendererCache,t)}var s=i(1).Point,a=i(49).pointInRectangle,o=i(12).LineSourcePaneView,l=i(74).SelectionRenderer,h=i(4),d=i(8).CompositeRenderer,c=i(392),p=i(19);n.prototype.setData=function(e){this._data=e,this._points=e.points},n.prototype.draw=function(e){var t,i,n,r,s,a;null!==this._data&&null!==this._points&&0!==this._points.length&&(e.font=[this._data.fontWeight,this._data.fontSize+"px",this._data.fontFamily].join(" "),(t=e.measureText(this._data.label)).height=this._data.fontSize,3,15,-9,i={left:10,top:5},n=t.width+2*i.left,r=t.height+2*i.top,s=this._points[0].x- -9,a=this._points[0].y-(r+15),this._measureCache&&$.extend(this._measureCache,{innerWidth:n,innerHeight:r,tailLeft:-9,tailHeight:15}),e.translate(.5+s,.5+a),e.beginPath(),e.moveTo(12,r),e.lineTo(-9,r+15),e.lineTo(-10,r+15-1),e.lineTo(5,r),e.lineTo(3,r),e.arcTo(0,r,0,0,3),e.lineTo(0,3),e.arcTo(0,0,n,0,3),e.lineTo(n-3,0),e.arcTo(n,0,n,r,3),e.lineTo(n,r-3),e.arcTo(n,r,0,r,3),e.lineTo(12,r),e.fillStyle=p.generateColor(this._data.backgroundColor,this._data.transparency),e.fill(),e.strokeStyle=this._data.borderColor,e.lineWidth=2,e.stroke(),e.closePath(),e.textBaseline="top",e.fillStyle=this._data.color,e.fillText(this._data.label,i.left,i.top-1),e.translate(-.5,-.5),e.beginPath(),e.arc(-9,r+15,2.5,0,2*Math.PI,!1),e.fillStyle=p.generateColor(this._data.borderColor,this._data.transparency),e.fill(),e.strokeStyle=this._chartModel.backgroundColor(),e.lineWidth=1,e.stroke(),e.closePath())},n.prototype.hitTest=function(e){var t,i;return null===this._data||null===this._points||0===this._points.length?null:(t=this._points[0].x-this._measureCache.tailLeft,i=this._points[0].y-(this._measureCache.innerHeight+this._measureCache.tailHeight),a(e,new s(t,i),new s(t+this._measureCache.innerWidth,i+this._measureCache.innerHeight))?new h(h.MOVEPOINT):null)},inherit(r,o),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){var e,t,i;if(o.prototype._updateImpl.call(this),this._source.points().length>0){if(e=this._source.points()[0].price,!(t=this._source.priceScale())||t.isEmpty())return;t.isPercent()&&(i=this._source.ownerSource().firstValue(),e=t.priceRange().convertToPercent(e,i)),this._priceLabel=t.formatter().format(e)}},r.prototype.renderer=function(){var e,t;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),(e={}).points=this._points,e.borderColor=this._source.properties().borderColor.value(),e.backgroundColor=this._source.properties().backgroundColor.value(),e.color=this._source.properties().color.value(),e.fontWeight=this._source.properties().fontWeight.value(),e.fontSize=this._source.properties().fontsize.value(),e.fontFamily=this._source.properties().font.value(),e.transparency=this._source.properties().transparency.value(),e.label=this._priceLabel,e.image=this._image,this._renderer.setData(e),this.isAnchorsRequired()&&1===e.points.length?((t=new d).append(this._renderer),t.append(new l({points:e.points})),t):this._renderer},t.PriceLabelPaneView=r},915:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._percentageFormatter=new d,this._pipFormatter=null,this._lastSymbolInfo=null,this._topBorderRenderer=new l,this._bottomBorderRenderer=new l,this._distanceRenderer=new l,this._backgroundRenderer=new o,this._labelRenderer=new a({})}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(27).TextRenderer,o=i(70).RectangleRenderer,l=i(16).TrendLineRenderer,h=i(8).CompositeRenderer,d=i(94).PercentageFormatter,c=i(145).PipFormatter,p=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){s.prototype._updateImpl.call(this)},n.prototype.renderer=function(){var e,t,i,n,s,a,o,l,d,_,u,f,g,v,w,y,m,x,b,S,P,R,T,L,C,k,I,B;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new h,this._points.length<2||this._source.points().length<2||(i=(t=this._source.properties()).extendLeft.value(),n=t.extendRight.value(),s=this._model.timeScale().width(),a=this._points[0],o=this._points[1],l=i?0:Math.min(a.x,o.x),d=n?s:Math.max(a.x,o.x),t.fillBackground&&t.fillBackground.value()&&((_={}).points=[new r(l,a.y),new r(d,o.y)],_.color="white",_.linewidth=0,_.backcolor=t.backgroundColor.value(),_.fillBackground=!0,_.transparency=t.backgroundTransparency.value(),this._backgroundRenderer.setData(_),e.append(this._backgroundRenderer)),u=this,(f=function(t,i,n){var r={};r.points=[i,n],r.width=u._model.timeScale().width(),r.height=u._source.priceScale().height(),r.color=u._source.properties().linecolor.value(),r.linewidth=u._source.properties().linewidth.value(),r.linestyle=CanvasEx.LINESTYLE_SOLID,r.extendleft=!1,r.extendright=!1,r.leftend=p.Normal,r.rightend=p.Normal,t.setData(r),e.append(t)})(this._topBorderRenderer,new r(l,a.y),new r(d,a.y)),f(this._bottomBorderRenderer,new r(l,o.y),new r(d,o.y)),a=this._points[0],o=this._points[1],g=(a.x+o.x)/2,v=new r(g,a.y),w=new r(g,o.y),(_={}).points=[v,w],_.width=u._model.timeScale().width(),_.height=u._source.priceScale().height(),_.color=u._source.properties().linecolor.value(),_.linewidth=u._source.properties().linewidth.value(),_.linestyle=CanvasEx.LINESTYLE_DASHED,_.extendleft=!1,_.extendright=!1,_.leftend=p.Normal,_.rightend=p.Arrow,this._distanceRenderer.setData(_),e.append(this._distanceRenderer),y=this._source.points()[0].price,b=100*(x=(m=this._source.points()[1].price)-y)/y,(S=this._model.mainSeries().symbolInfo())&&S!==this._lastSymbolInfo&&(this._pipFormatter=new c(S.pricescale,S.minmov,S.type,S.minmove2),this._lastSymbolInfo=S),P=this._source.priceScale().formatter().format(x)+" ("+this._percentageFormatter.format(b)+") "+(this._pipFormatter?this._pipFormatter.format(x):""),_={},m>y?((R=o.clone()).y-=2*t.fontsize.value(),R.x=.5*(a.x+o.x),_.points=[R]):((R=o.clone()).x=.5*(a.x+o.x),R.y+=.7*t.fontsize.value(),_.points=[R]),T={x:0,y:10},_.text=P,_.color=t.textcolor.value(),_.height=u._source.priceScale().height(),_.font=t.font.value(),_.offsetX=T.x,_.offsetY=T.y,_.vertAlign="middle",_.horzAlign="center",_.fontsize=t.fontsize.value(),_.backgroundRoundRect=4,_.backgroundHorzInflate=.4*t.fontsize.value(),_.backgroundVertInflate=.2*t.fontsize.value(),t.fillLabelBackground&&t.fillLabelBackground.value()&&(_.backgroundColor=t.labelBackgroundColor.value(),_.backgroundTransparency=1-t.labelBackgroundTransparency.value()/100||0),t.drawBorder&&t.drawBorder.value()&&(_.borderColor=t.borderColor.value()),L=.5*(a.x+o.x),C=o.y,k=new r(L,C),this._labelRenderer.setData(_),I=this._labelRenderer.measure(),B={x:L+_.backgroundHorzInflate+I.textBgPadding-I.width/I.textBgPadding,y:a.y>o.y?k.y-I.height-2*I.textBgPadding-T.y>0?C-I.height-T.y-2*I.textBgPadding:T.y-2*I.textBgPadding:k.y+I.height+I.textBgPadding+T.y>_.height?_.height-I.height-T.y:C+I.textBgPadding},this._labelRenderer.setPoints([new r(L,B.y)]),e.append(this._labelRenderer),this.addAnchors(e)),e},t.PriceRangePaneView=n},917:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._baseTrendRenderer=new a,this._edgeTrendRenderer=new a,this._arcWedgeRenderer=new r}var r=i(491).ArcWedgeRenderer,s=i(414).FibWedgePaneView,a=i(16).TrendLineRenderer,o=i(8).CompositeRenderer,l=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){s.prototype.update.call(this)},n.prototype.renderer=function(){var e,t,i,n,r,s,a,h,d,c,p,_;return this._invalidated&&(this._updateImpl(),this._invalidated=!1),e=new o,this._points.length<2?e:(t=this._source.properties(),s={points:[n=(i=this._points)[0],r=i[1]],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:t.trendline.color.value(),linewidth:t.linewidth.value(),linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:l.Normal,rightend:l.Normal},this._baseTrendRenderer.setData(s),e.append(this._baseTrendRenderer),this._points.length<3?(this.addAnchors(e),e):(h=(a=i[2]).data,d=r.subtract(n).length(),c=a.subtract(n).normalized(),(a=n.add(c.scaled(d))).data=h,s={points:[n,a],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:t.trendline.color.value(),linewidth:t.linewidth.value(),linestyle:t.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:l.Normal,rightend:l.Normal},this._edgeTrendRenderer.setData(s),e.append(this._edgeTrendRenderer),p=this._levels[0],(_={}).center=this._points[0],_.radius=p.radius,_.prevRadius=0,_.edge=this._edge,_.color=t.trendline.color.value(),_.color1=t.color1.value(),_.color2=t.color2.value(),_.linewidth=t.linewidth.value(),_.edge1=this._edge1,_.edge2=this._edge2,_.p1=p.p1,_.p2=p.p2,_.fillBackground=t.fillBackground.value(),_.transparency=t.transparency.value(),_.gradient=!0,this._arcWedgeRenderer.setData(_),e.append(this._arcWedgeRenderer),this.addAnchors(e),e))},t.ProjectionLinePaneView=n},920:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._renderer=new o}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(8).CompositeRenderer,o=i(70).RectangleRenderer;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){s.prototype._updateImpl.call(this),this._invalidated=!1},n.prototype.renderer=function(){var e,t,i,n,s,o;return this._invalidated&&this.updateImpl(),(e={}).points=this._points,e.color=this._source.properties().color.value(),e.linewidth=this._source.properties().linewidth.value(),e.backcolor=this._source.properties().backgroundColor.value(),e.fillBackground=this._source.properties().fillBackground.value(),e.transparency=this._source.properties().transparency.value(),this._renderer.setData(e),this.isAnchorsRequired()?((t=new a).append(this._renderer),i=this._points[0],n=this._points[1],(s=new r(i.x,n.y)).data=2,(o=new r(n.x,i.y)).data=3,t.append(this.createLineAnchor({points:[i,n,s,o]})),t):this._renderer},t.RectanglePaneView=n},922:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._percentageFormatter=new c,this._numericFormatter=new p,this._pipFormatter=null,this._lastSymbolInfo=null,this._entryLineRenderer=new a,this._stopLineRenderer=new a,this._targetLineRenderer=new a,this._positionLineRenderer=new a,this._fullStopBgRenderer=new l(new h(h.MOVEPOINT),new h(h.MOVEPOINT)),this._stopBgRenderer=new l(new h(h.MOVEPOINT),new h(h.MOVEPOINT)),this._fullTargetBgRenderer=new l(new h(h.MOVEPOINT),new h(h.MOVEPOINT)),this._targetBgRenderer=new l(new h(h.MOVEPOINT),new h(h.MOVEPOINT)),this._stopLabelRenderer=new o({}),this._middleLabelRenderer=new o({}),this._profitLabelRenderer=new o({})}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(16).TrendLineRenderer,o=i(27).TextRenderer,l=i(70).RectangleRenderer,h=i(4),d=i(8).CompositeRenderer,c=i(94).PercentageFormatter,p=i(38).NumericFormatter,_=i(145).PipFormatter,u=i(19),f=i(18).LineEnd,g=i(488).RiskRewardPointIndex;inherit(n,s),n.prototype.i18nCache={pnl:$.t("{0} P&L: {1}"),open:$.t("Open",{context:"line_tool_position"}),closed:$.t("Closed",{context:"line_tool_position"}),ratio:$.t("Risk/Reward Ratio: {0}"),stop:$.t("Stop: {0} ({1}) {2}, Amount: {3}"),target:$.t("Target: {0} ({1}) {2}, Amount: {3}"),qty:$.t("Qty: {0}")},n.prototype._formatInTicks=function(e){var t=this._model.mainSeries().base();return Math.round(e*t)},n.prototype.isLabelVisible=function(){return this.isHoveredSource()||this.isSelectedSource()},n.prototype.update=function(){this._invalidated=!0},n.prototype._updateImpl=function(){var e,t,i,n,r,a,o;s.prototype._updateImpl.call(this),this._stopLevel=null,this._profitLevel=null,e=this._model.timeScale(),!(t=this._source.priceScale())||t.isEmpty()||e.isEmpty()||0!==this._source.points().length&&0!==this._points.length&&null!==this._model.mainSeries().bars().last()&&(this._source.points().length<2||0!==this._model.mainSeries().bars().length&&(this._isClosed=4===this._source.points().length,(i=this._source.lastBarData())&&(n=this._source.priceScale(),r=this._source.stopPrice(),a=this._source.profitPrice(),this._pl=this._source.points().length>1?this._source.calculatePL(i.closePrice):0,n.isPercent()&&(o=this._source.ownerSource().firstValue(),r=n.priceRange().convertToPercent(r,o),a=n.priceRange().convertToPercent(a,o),i.closePrice=n.priceRange().convertToPercent(i.closePrice,o)),this._entryLevel=this._points[g.Entry].y,this._stopLevel=t.priceToCoordinate(r),this._profitLevel=t.priceToCoordinate(a),this._closeLevel=t.priceToCoordinate(i.closePrice),this._closeBar=this._source._model.timeScale().indexToCoordinate(i.index))))},n.prototype.renderer=function(){var e,t,i,n,s,a,o,l,h,c,p,v,w,y,m,x,b,S,P,R,T,L,C,k,I,B,M,A,D,E,O,N,V,z,F,W;return this._invalidated&&(this._updateImpl(),this._invalidated=!1),e=new d,this._points.length<2||this._source.points().length<2||(t=this,i=this._source.properties(),n=this._points[g.Entry].x,s=this._points[g.ActualEntry]?this._points[g.ActualEntry].x:this._points[g.Close].x,a=this._points[g.ActualClose]?this._points[g.ActualClose].x:this._points[g.Close].x,o=this._points[g.Close].x,l=new r(n,this._entryLevel),h=new r(o,this._stopLevel),(c={}).points=[l,h],c.color="white",c.linewidth=0,c.backcolor=i.stopBackground.value(),c.fillBackground=!0,c.transparency=i.stopBackgroundTransparency.value(),this._fullStopBgRenderer.setData(c),e.append(this._fullStopBgRenderer),this._pl<0&&(l=new r(s,this._entryLevel),h=new r(a,this._closeLevel),(c={}).points=[l,h],c.color="white",c.linewidth=0,c.backcolor=i.stopBackground.value(),c.fillBackground=!0,v=100-100*(1-(p=.01*i.stopBackgroundTransparency.value())*p*p),c.transparency=v,this._stopBgRenderer.setData(c),e.append(this._stopBgRenderer)),l=new r(n,this._entryLevel),h=new r(o,this._profitLevel),(c={}).points=[l,h],c.color="white",c.linewidth=0,c.backcolor=i.profitBackground.value(),c.fillBackground=!0,c.transparency=i.profitBackgroundTransparency.value(),this._fullTargetBgRenderer.setData(c),e.append(this._fullTargetBgRenderer),this._pl>0&&(l=new r(s,this._entryLevel),h=new r(a,this._closeLevel),(c={}).points=[l,h],c.color="white",c.linewidth=0,c.backcolor=i.profitBackground.value(),c.fillBackground=!0,w=100-100*(1-(p=.01*i.profitBackgroundTransparency.value())*p*p),c.transparency=w,this._targetBgRenderer.setData(c),e.append(this._targetBgRenderer)),y=function(i,n,r,s){var a={};a.points=[n,r],a.width=t._model.timeScale().width(),a.height=t._source.priceScale().height(),a.color=s||t._source.properties().linecolor.value(),a.linewidth=t._source.properties().linewidth.value(),a.linestyle=CanvasEx.LINESTYLE_SOLID,a.extendleft=!1,a.extendright=!1,a.leftend=f.Normal,a.rightend=f.Normal,i.setData(a),e.append(i)},this._points[g.ActualEntry]&&(l=this._points[g.ActualEntry],h=this._isClosed?this._points[g.ActualClose]:new r(this._closeBar,this._closeLevel),(c={}).points=[l,h],c.width=t._model.timeScale().width(),c.height=t._source.priceScale().height(),c.color=t._source.properties().linecolor.value(),c.linewidth=1,c.linestyle=CanvasEx.LINESTYLE_DASHED,c.extendleft=!1,c.extendright=!1,c.leftend=f.Normal,c.rightend=f.Arrow,this._positionLineRenderer.setData(c),e.append(this._positionLineRenderer)),t=this,m=function(n,r,s,a,o,l,h){if(t.isLabelVisible()||TradingView.printing){var d={};d.points=[r],d.text=s,d.color=i.textcolor.value(),d.font=i.font.value(),d.offsetX=3,d.offsetY=l,d.vertAlign=o,d.horzAlign="center",d.backgroundRoundRect=4,d.backgroundColor=u.resetTransparency(a),d.fontsize=i.fontsize.value(),d.backgroundHorzInflate=4,d.backgroundVertInflate=2,h&&(d.borderColor=h),n.setData(d),e.append(n)}},x=this._source.entryPrice(),b=this._source.stopPrice(),S=this._source.profitPrice(),P=Math.abs(b-x),R=Math.round(1e4*P/x)/100,T=Math.abs(S-x),L=Math.round(1e4*T/x)/100,C=Math.abs(x-S)/Math.abs(x-b),l=new r(n,this._points[g.Entry].y),h=new r(o,this._points[g.Entry].y),y(this._entryLineRenderer,l,h),k=new r((n+o)/2,Math.round(this._points[0].y)+.5),I="",B="",M=this._numericFormatter.format(Math.round(100*C)/100),this._points[1]&&void 0!==this._pl&&(B=this._source.priceScale().formatter().format(this._pl)),i.compact.value()?(I+=B?B+" ~ ":"",I+=i.qty.value()+"\n",I+=M):(A=this._isClosed?this.i18nCache.closed:this.i18nCache.open,I+=B?this.i18nCache.pnl.format(A,B)+", ":"",I+=this.i18nCache.qty.format(i.qty.value())+"\n",I+=this.i18nCache.ratio.format(M)+" "),D=i.linecolor.value(),this._pl<0?D=i.stopBackground.value():this._pl>0&&(D=i.profitBackground.value()),m(this._middleLabelRenderer,k,I,D,"middle",0,"white"),l=new r(n,this._stopLevel),h=new r(o,this._stopLevel),y(this._stopLineRenderer,l,h,i.stopBackground.value()),(E=this._model.mainSeries().symbolInfo())&&E!==this._lastSymbolInfo&&(this._pipFormatter=new _(E.pricescale,E.minmov,E.type,E.minmove2),this._lastSymbolInfo=E),k=new r((n+o)/2,this._stopLevel),I="",O=this._source.priceScale().formatter().format(P),N=this._percentageFormatter.format(R),I=i.compact.value()?O+" ("+N+") "+i.amountStop.value():this.i18nCache.stop.format(this._source.priceScale().formatter().format(P),this._percentageFormatter.format(R),this._pipFormatter?this._pipFormatter.format(P):"",i.amountStop.value()),m(this._stopLabelRenderer,k,I,i.stopBackground.value(),x<b?"bottom":"top",x<b?-12:-1),l=new r(n,this._profitLevel),h=new r(o,this._profitLevel),y(this._targetLineRenderer,l,h,i.profitBackground.value()),k=new r((n+o)/2,this._profitLevel),I="",O=this._source.priceScale().formatter().format(T),N=this._percentageFormatter.format(L),I=i.compact.value()?O+" ("+N+") "+i.amountTarget.value():this.i18nCache.target.format(this._source.priceScale().formatter().format(T),this._percentageFormatter.format(L),this._pipFormatter?this._pipFormatter.format(T):"",i.amountTarget.value()),m(this._profitLabelRenderer,k,I,i.profitBackground.value(),x<b?"top":"bottom",x<b?-1:-12),this.isAnchorsRequired()&&((V=this._points[0].clone()).data=0,(z=new r(n,this._stopLevel)).data=1,(F=new r(n,this._profitLevel)).data=2,(W=new r(o,V.y)).data=3,e.append(this.createLineAnchor({points:[V,z,F,W]})))),e},t.RiskRewardPaneView=n},923:function(e,t,i){"use strict";function n(e,t){a.call(this,e,t),this._invalidated=!0,this._poligonRenderer=new l}var r=i(1).Point,s=i(33).distanceToLine,a=i(12).LineSourcePaneView,o=i(16).TrendLineRenderer,l=i(164),h=i(8).CompositeRenderer,d=i(18).LineEnd;inherit(n,a),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){a.prototype._updateImpl.call(this),this._distance=0,3===this._points.length&&(this._distance=s(this._points[0],this._points[1],this._points[2]).distance)},n.prototype.renderer=function(){var e,t,i,n,s,a,l,c,p,_,u,f,g,v;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new h,t=this._source.properties(),i=this._points[0],n=this._points[1],2===this._points.length?((p={}).points=this._points,p.floatPoints=this._floatPoints,p.width=this._model.timeScale().width(),p.height=this._source.priceScale().height(),p.color=t.color.value(),p.linewidth=1,p.linestyle=CanvasEx.LINESTYLE_SOLID,p.extendleft=!1,p.extendright=!1,p.leftend=d.Normal,p.rightend=d.Normal,(_=new o).setData(p),e.append(_)):3===this._points.length&&(u=n.subtract(i),g=(f=new r(u.y,-u.x).normalized().scaled(this._distance)).scaled(-1),s=i.add(f),a=n.add(f),l=i.add(g),c=n.add(g),(p={}).points=[s,a,c,l],p.color=t.color.value(),p.linewidth=this._source.properties().linewidth.value(),p.linestyle=CanvasEx.LINESTYLE_SOLID,p.filled=!0,p.backcolor=t.backgroundColor.value(),p.fillBackground=t.fillBackground.value(),p.transparency=t.transparency.value(),this._poligonRenderer.setData(p),e.append(this._poligonRenderer)),this.isAnchorsRequired()&&((v=[]).push(i),this._points.length>=2&&v.push(n),3===this._points.length&&(s.data=2,l.data=2,a.data=2,c.data=2,v.push(s),v.push(l),v.push(a),v.push(c)),e.append(this.createLineAnchor({points:v}))),e},t.RotatedRectanglePaneView=n},927:function(e,t,i){"use strict";function n(e){this._data=e}function r(e,t){a.call(this,e,t),this._invalidated=!0}var s=i(1).Point,a=i(12).LineSourcePaneView,o=i(4),l=i(8).CompositeRenderer;n.prototype.draw=function(e){var t,i,n;for(e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,CanvasEx.setLineStyle(e,this._data.linestyle),e.beginPath(),e.moveTo(this._data.point.x,this._data.point.y),t=1;t<=2*this._data.width;t++)i=t*Math.PI/this._data.width,n=Math.sin(i-Math.PI/2)*this._data.height/2,e.lineTo(this._data.point.x+t,this._data.point.y+n+this._data.height/2);e.stroke()},n.prototype.hitTest=function(e){var t,i;return e.x<this._data.point.x||e.x>this._data.point.x+2*this._data.width?null:(t=(e.x-this._data.point.x)*Math.PI/this._data.width,i=Math.sin(t-Math.PI/2)*this._data.height/2,i=this._data.point.y+i+this._data.height/2,3,Math.abs(i-e.y)<=3?new o(o.MOVEPOINT):null)},inherit(r,a),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){a.prototype._updateImpl.call(this),this._invalidated=!1},r.prototype.renderer=function(){var e,t,i,r,a,o,h,d,c,p,_,u,f,g,v,w,y;if(this._invalidated&&this.updateImpl(),this._points.length<2)return null;if(t=(e=this._source.points())[0],i=e[1],r=Math.min(t.index,i.index),a=2*(Math.max(t.index,i.index)-r),o=this._points[0],h=this._points[1],d=Math.abs(o.x-h.x),c=h.y-o.y,p=new l,_=this._source.properties(),u=this._model.timeScale(),0===a)return null;for(f=u.indexToCoordinate(r),g=[],v=r;f>-d;v-=a)f=u.indexToCoordinate(v),g.push(f);for(f=f=u.indexToCoordinate(r+a),v=r+a;f<u.width();v+=a)f=u.indexToCoordinate(v),g.push(f);for(w=0;w<g.length;w++)y=new n({point:new s(g[w],o.y),width:d,height:c,color:_.linecolor.value(),linewidth:_.linewidth.value(),linestyle:_.linestyle.value()}),p.append(y);return this.addAnchors(p),p},t.SineLinePaneView=r},929:function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._numericFormatter=new l,this._invalidated=!0,this._retrace1LabelRenderer=new a({}),this._retrace12LabelRenderer=new a({})}var r=i(12).LineSourcePaneView,s=i(16).TrendLineRenderer,a=i(27).TextRenderer,o=i(8).CompositeRenderer,l=i(38).NumericFormatter,h=i(19),d=i(18).LineEnd;inherit(n,r),n.prototype.renderer=function(){var e,t,i,n,r,a,l,c,p;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),this._points.length<2)return null;for(e=this._source.properties(),t=new o,i=this,n=function(t,n){return{points:[t],text:n,color:e.textcolor.value(),vertAlign:"middle",horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:i._source.properties().color.value(),backgroundRoundRect:4}},r=function(t,n,r,s){return{points:[t,n],width:i._model.timeScale().width(),height:i._source.priceScale().height(),color:h.generateColor(i._source.properties().color.value(),r),linewidth:s||e.linewidth.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:d.Normal,rightend:d.Normal}},a=1;a<this._points.length;a++)l=r(this._points[a-1],this._points[a],0),(c=new s).setData(l),t.append(c);return this._retrace1&&(l=r(this._points[1],this._points[3],70,1),(c=new s).setData(l),t.append(c),p=n(this._points[1].add(this._points[3]).scaled(.5),this._numericFormatter.format(this._retrace1)),this._retrace1LabelRenderer.setData(p),t.append(this._retrace1LabelRenderer)),this._retrace2&&(l=r(this._points[3],this._points[5],70,1),(c=new s).setData(l),t.append(c),p=n(this._points[5].add(this._points[3]).scaled(.5),this._numericFormatter.format(this._retrace2)),this._retrace12LabelRenderer.setData(p),t.append(this._retrace12LabelRenderer)),this.addAnchors(t),t},n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,s;r.prototype._updateImpl.call(this),delete this._retrace1,delete this._retrace2,this._source.points().length>=4&&(e=this._source.points()[1],t=this._source.points()[2],i=this._source.points()[3],this._retrace1=Math.round(100*Math.abs((i.price-t.price)/(t.price-e.price)))/100),this._source.points().length>=6&&(i=this._source.points()[3],n=this._source.points()[4],s=this._source.points()[5],this._retrace2=Math.round(100*Math.abs((s.price-n.price)/(n.price-i.price)))/100)},t.LineToolThreeDrivesPaneView=n},931:function(e,t,i){"use strict";function n(){this._data=null}function r(e,t){a.call(this,e,t),this._invalidated=!0}var s=i(1).Point,a=i(12).LineSourcePaneView,o=i(4),l=i(8).CompositeRenderer,h=i(19);n.prototype.setData=function(e){this._data=e},n.prototype.draw=function(e){null!==this._data&&(e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,CanvasEx.setLineStyle(e,this._data.linestyle),e.save(),e.translate(this._data.point.x+1,this._data.point.y),e.scale(this._data.width,this._data.height),e.beginPath(),e.arc(.5,0,.5,Math.PI,0,!1),e.restore(),e.stroke(),this._data.fillBackground&&(e.fillStyle=h.generateColor(this._data.backcolor,this._data.transparency),e.fill()))},n.prototype.hitTest=function(e){var t,i,n,r;return null===this._data||e.y>this._data.point.y||e.x<this._data.point.x||e.x>this._data.point.x+this._data.width?null:(t=new s(this._data.point.x+this._data.width/2,this._data.point.y),i=e.subtract(t),n=this._data.height/this._data.width,i.y/=n,r=i.length(),3,Math.abs(r-this._data.width/2)<3?new o(o.MOVEPOINT):null)},inherit(r,a),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){a.prototype._updateImpl.call(this),this._invalidated=!1},r.prototype.renderer=function(){var e,t,i,r,a,o,h,d,c,p,_,u,f,g,v,w,y,m;if(this._invalidated&&this.updateImpl(),this._points.length<2)return null;if(t=(e=this._source.points())[0],i=e[1],r=Math.min(t.index,i.index),o=(a=Math.max(t.index,i.index))-r,h=this._points[0],d=this._points[1],c=Math.abs(h.x-d.x),p=new l,_=this._source.properties(),u=this._model.timeScale(),0===o)return null;for(f=Math.min(h.x,d.x),g=[],v=r;f>-c;v-=o)f=u.indexToCoordinate(v),g.push(f);for(f=Math.max(h.x,d.x),v=a;f<u.width();v+=o)f=u.indexToCoordinate(v),g.push(f);for(w=0;w<g.length;w++)y={point:new s(g[w],h.y),width:c,height:c,color:_.linecolor.value(),linewidth:_.linewidth.value(),linestyle:_.linestyle.value(),fillBackground:_.fillBackground.value(),backcolor:_.backgroundColor.value(),transparency:_.transparency.value()},(m=new n).setData(y),p.append(m);return this.addAnchors(p),p},t.TimeCyclesPaneView=r},933:function(e,t,i){"use strict";function n(){this._data=null}function r(e,t){a.call(this,e,t),this._label=null,this._rendererCache={},this._invalidated=!0,this._pipFormatter=null,this._lastSymbolInfo=null,this._trendLineRenderer=new h,this._angleRenderer=new n,this._angleLabelRenderer=new l({})}var s=i(1).Point,a=i(12).LineSourcePaneView,o=i(423).TrendLineStatsRenderer,l=i(27).TextRenderer,h=i(16).TrendLineRenderer,d=i(8).CompositeRenderer,c=i(94).PercentageFormatter,p=i(74).SelectionRenderer,_=i(145).PipFormatter,u=i(18).LineEnd,f=i(313).LabelSettings,g=i(105).PaneRendererClockIcon;n.prototype.setData=function(e){this._data=e},n.prototype.hitTest=function(){return null},n.prototype.draw=function(e){var t,i;null!==this._data&&(e.save(),e.translate(this._data.point.x,this._data.point.y),e.strokeStyle=this._data.color,t=[1,2],"function"==typeof e.setLineDash?e.setLineDash(t):void 0!==e.mozDash?e.mozDash=t:void 0!==e.webkitLineDash&&(e.webkitLineDash=t),i=this._data.size,e.beginPath(),e.moveTo(0,0),e.lineTo(i,0),e.arc(0,0,i,0,-this._data.angle,this._data.angle>0),e.stroke(),e.restore())},inherit(r,a),r.prototype.update=function(){this._invalidated=!0},r.prototype.updateImpl=function(){var e,t,i,n,r,o,l,h,d,p,u,f;a.prototype._updateImpl.call(this),this._points.length>0&&void 0!==this._source._angle&&(e=this._points[0],t=Math.cos(this._source._angle),i=-Math.sin(this._source._angle),n=new s(t,i),this._secondPoint=e.addScaled(n,this._source._distance),this._secondPoint.data=1,this._middlePoint=this._source.calcMiddlePoint(this._points[0],this._secondPoint)),this._label=null,this._source.points().length<2||(e=this._source.points()[0],r=this._source.points()[1],o=[],this._source.properties().showPriceRange.value()&&this._source.priceScale()&&(p=(d=r.price-e.price)/e.price,l=this._source.priceScale().formatter().format(d)+" ("+(new c).format(100*p)+")",(u=this._model.mainSeries().symbolInfo())&&u!==this._lastSymbolInfo&&(this._pipFormatter=new _(u.pricescale,u.minmov,u.type,u.minmove2),this._lastSymbolInfo=u),l+=this._pipFormatter?", "+this._pipFormatter.format(d):"",o.push("priceRange")),this._source.properties().showBarsRange.value()&&(h="",f=r.index-e.index,h+=$.t("{0} bars").format(f),o.push("barsRange")),this._label=[l,h].filter((function(e){return e})).join("\n")||null,this._icons=o)},r.prototype.renderer=function(){var e,t,i,n,r,s,a,l,h,c,_;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new d,t={},n=(i=this.isAnchorsRequired())||this._source.properties().alwaysShowStats.value(),r=(this.isHoveredSource()||this.isSelectedSource())&&this._source.properties().showMiddlePoint.value(),this._secondPoint&&this._points.length>0&&(t.points=[this._points[0],this._secondPoint],t.width=this._model.timeScale().width(),t.height=this._source.priceScale().height(),t.color=this._source.properties().linecolor.value(),t.linewidth=this._source.properties().linewidth.value(),t.linestyle=this._source.properties().linestyle.value(),t.extendleft=this._source.properties().extendLeft.value(),t.extendright=this._source.properties().extendRight.value(),t.leftend=u.Normal,t.rightend=u.Normal,this._trendLineRenderer.setData(t),e.append(this._trendLineRenderer),n&&this._label&&2===this._points.length&&(s={points:[this._secondPoint],text:this._label,color:this._source.properties().textcolor.value(),font:f.font,fontsize:f.fontSize,lineSpacing:f.lineSpacing,backgroundColor:f.bgColor,borderColor:f.borderColor,borderWidth:1,padding:f.padding,paddingLeft:30,doNotAlignText:!0,icons:this._icons},a=f.offset,this._points[1].y<this._points[0].y?(s.vertAlign="bottom",s.offsetY=-a):s.offsetY=a,this._points[1].x<this._points[0].x?(s.horzAlign="right",s.offsetX=-a):s.offsetX=a,e.append(new o(s,this._rendererCache))),r&&this._middlePoint&&e.append(new p({points:[this._middlePoint]})),(l={}).point=this._points[0],l.angle=this._source._angle,l.color=this._source.properties().linecolor.value(),l.size=50,this._angleRenderer.setData(l),e.append(this._angleRenderer),h=Math.round(180*l.angle/Math.PI)+"",(c=this._points[0].clone()).x=c.x+50,_={points:[c],text:h,color:this._source.properties().textcolor.value(),horzAlign:"left",font:this._source.properties().font.value(),offsetX:5,offsetY:0,bold:this._source.properties().bold.value(),italic:this._source.properties().italic.value(),fontsize:this._source.properties().fontsize.value(),vertAlign:"middle"},this._angleLabelRenderer.setData(_),e.append(this._angleLabelRenderer)),!TradingView.printing&&this._source.hasAlert.value()&&!this._model.readOnly()&&t&&t.points&&t.points.length>=2&&this._source.getAlertIsActive((function(i){e.append(new g({point1:t.points[0],point2:t.points[1],color:i?t.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))})),this._secondPoint&&this._points.length>0&&i&&e.append(this.createLineAnchor({points:[this._points[0],this._secondPoint]})),e},t.TrendAnglePaneView=r},935:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._rendererCache={},this._trendLineRendererPoints12=new o,this._trendLineRendererPoints23=new o}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(70).RectangleRenderer,o=i(16).TrendLineRenderer,l=i(117),h=i(4),d=i(8).CompositeRenderer,c=i(18).LineEnd;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype._updateImpl=function(){var e,t,i,n,r,a,o,l,h,d,c,p,_,u;if(s.prototype._updateImpl.call(this),this._cacheState=this._model._trendBasedFibExtensionLabelsCache.updateSource(this._source),!(this._source.points().length<3)&&this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!this._model.timeScale().isEmpty())for(e=this._source.points()[0],t=this._source.points()[1],i=this._source.points()[2],n=!1,(r=this._source.properties()).reverse&&r.reverse.value()&&(n=r.reverse.value()),this._levels=[],a=n?e.price-t.price:t.price-e.price,this._source.priceScale().isPercent()&&(o=this._source.ownerSource().firstValue()),l=this._source.levelsCount(),h=1;h<=l;h++)(d=r["level"+h]).visible.value()&&(c=d.coeff.value(),p=d.color.value(),_=i.price+c*a,this._source.priceScale().isPercent()&&(_=this._source.priceScale().priceRange().convertToPercent(_,o)),u=this._source.priceScale().priceToCoordinate(_),this._levels.push({color:p,y:u,linewidth:r.levelsStyle.linewidth.value(),linestyle:r.levelsStyle.linestyle.value(),index:h}))},n.prototype.renderer=function(){var e,t,i,n,s,p,_,u,f,g,v,w,y,m,x,b,S,P,R,T,L,C,k,I;if(this._invalidated&&(this._updateImpl(),this._invalidated=!1),e=new d,this._points.length<2)return e;if(t=this._points[0],i=this._points[1],(n=this._source.properties()).trendline.visible.value()&&(s={points:[t,i],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal},this._trendLineRendererPoints12.setData(s),e.append(this._trendLineRendererPoints12)),this._points.length<3)return this.addAnchors(e),e;for(p=this._points[2],n.trendline.visible.value()&&(s={points:[i,p],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal},this._trendLineRendererPoints23.setData(s),e.append(this._trendLineRendererPoints23)),_=Math.min(p.x,i.x),u=Math.max(p.x,i.x),f=n.fillBackground.value(),g=n.transparency.value(),v=n.extendLines.value()?this._model.timeScale().width():u,y=(w=this._model._trendBasedFibExtensionLabelsCache).canvas().get(0),m=0;m<this._levels.length;m++)if(m>0&&f&&(x=this._levels[m-1],t=new r(_,this._levels[m].y),i=new r(v,x.y),(b={}).points=[t,i],b.color=this._levels[m].color,b.linewidth=0,b.backcolor=this._levels[m].color,b.fillBackground=!0,b.transparency=g,(S=new a(void 0,void 0,!0)).setData(b),e.append(S)),s={points:[t=new r(_,this._levels[m].y),i=new r(u,this._levels[m].y)],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:this._levels[m].color,linewidth:this._levels[m].linewidth,linestyle:this._levels[m].linestyle,extendleft:!1,extendright:n.extendLines.value(),leftend:c.Normal,rightend:c.Normal},(P=new o).setData(s),P.setHitTest(new h(h.MOVEPOINT,null,this._levels[m].index)),e.append(P),n.showCoeffs.value()||n.showPrices.value()){if(!(R=this._cacheState.preparedCells.cells[this._levels[m].index-1]))continue;switch(n.horzLabelsAlign.value()){case"left":T=t;break;case"center":(T=t.add(i).scaled(.5)).x+=R.width/2,T.x=Math.round(T.x);break;case"right":n.extendLines.value()?T=new r(v-4,this._levels[m].y):((T=new r(v+4,this._levels[m].y)).x+=R.width,T.x=Math.round(T.x))}L={left:R.left,top:w.topByRow(this._cacheState.row),width:R.width,height:w.rowHeight(this._cacheState.row)},C={left:T.x-L.width,top:T.y,width:R.width,height:L.height},"middle"===(k=n.vertLabelsAlign.value())&&(C.top-=C.height/2),"bottom"===k&&(C.top-=C.height),I=new l(y,L,C),e.append(I)}return this.addAnchors(e),e},t.TrendBasedFibExtensionPaneView=n},937:function(e,t,i){"use strict";function n(e,t){a.call(this,e,t),this._invalidated=!0,this._trendLineRendererPoints12=new h,this._trendLineRendererPoints23=new h}var r=i(1).Point,s=i(146).VerticalLineRenderer,a=i(12).LineSourcePaneView,o=i(27).TextRenderer,l=i(70).RectangleRenderer,h=i(16).TrendLineRenderer,d=i(4),c=i(8).CompositeRenderer,p=i(18).LineEnd;inherit(n,a),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,r,s,o,l,h,d,c,p;if(a.prototype._updateImpl.call(this),!(this._source.points().length<3)&&this._source.priceScale()&&!this._source.priceScale().isEmpty()&&!this._model.timeScale().isEmpty()&&(e=this._source.points()[0],t=this._source.points()[1],i=this._source.points()[2],this._levels=[],t.index!==e.index&&(n=t.index-e.index,r=this._source.properties(),s=i.index,null!==this._model.timeScale().visibleBars())))for(o=1;o<=11;o++)(l=r["level"+o]).visible.value()&&(h=l.coeff.value(),d=l.color.value(),c=Math.round(s+h*n),p={x:this._model.timeScale().indexToCoordinate(c),coeff:h,color:d,linewidth:l.linewidth.value(),linestyle:l.linestyle.value(),index:o},r.showCoeffs.value()&&(p.text=h,p.y=this._source.priceScale().height()),this._levels.push(p))},n.prototype.renderer=function(){var e,t,i,n,a,h,_,u,f,g,v,w,y,m,x,b,S,P,R,T,L;if(this._invalidated&&(this.updateImpl(),this._invalidated=!1),e=new c,this._points.length<2)return e;if(t=this._points[0],i=this._points[1],(n=this._source.properties()).trendline.visible.value()&&(a={points:[t,i],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:p.Normal,rightend:p.Normal},this._trendLineRendererPoints12.setData(a),e.append(this._trendLineRendererPoints12)),this._points.length<3)return this.addAnchors(e),e;for(h=this._points[2],n.trendline.visible.value()&&(a={points:[i,h],width:this._model.timeScale().width(),height:this._source.priceScale().height(),color:n.trendline.color.value(),linewidth:n.trendline.linewidth.value(),linestyle:n.trendline.linestyle.value(),extendleft:!1,extendright:!1,leftend:p.Normal,rightend:p.Normal},this._trendLineRendererPoints23.setData(a),e.append(this._trendLineRendererPoints23)),_=n.fillBackground.value(),u=n.transparency.value(),f=this._model.timeScale().width(),g=this._source.priceScale().height(),v=0;v<this._levels.length;v++){if(v>0&&_&&(w=this._levels[v-1],t=new r(w.x,0),i=new r(this._levels[v].x,this._source.priceScale().height()),(y={}).points=[t,i],y.color=this._levels[v].color,y.linewidth=0,y.backcolor=this._levels[v].color,y.fillBackground=!0,y.transparency=u,(m=new l(void 0,void 0,!0)).setData(y),e.append(m)),void 0!==this._levels[v].text){switch(P="left"===(P=n.horzLabelsAlign.value())?"right":"right"===P?"left":"center"){case"left":b=3;break;case"center":b=0;break;case"right":b=-3}switch(n.vertLabelsAlign.value()){case"top":x=new r(this._levels[v].x,0),S=5;break;case"middle":x=new r(this._levels[v].x,.5*this._levels[v].y),S=0;break;case"bottom":x=new r(this._levels[v].x,this._levels[v].y),S=-10}R={points:[x],text:""+this._levels[v].text,color:this._levels[v].color,vertAlign:"middle",horzAlign:P,font:n.font.value(),offsetX:b,offsetY:S,fontsize:12},e.append(new o(R))}(T={}).width=f,T.height=g,T.points=[new r(this._levels[v].x,0)],T.color=this._levels[v].color,T.linewidth=this._levels[v].linewidth,T.linestyle=this._levels[v].linestyle,L=new d(d.MOVEPOINT,null,this._levels[v].index),(m=new s).setData(T),m.setHitTest(L),e.append(m)}return this.addAnchors(e),e},t.TrendBasedFibTimePaneView=n},939:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._label=null,this._rendererCache={},this._invalidated=!0,this._labelDataInvalidated=!0,this._percentageFormatter=new h,this._numericFormatter=new d,this._pipFormatter=null,this._lastSymbolInfo=null,this._trendRenderer=new u}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(117),o=i(105).PaneRendererClockIcon,l=i(8).CompositeRenderer,h=i(94).PercentageFormatter,d=i(38).NumericFormatter,c=i(175).TimeSpanFormatter,p=i(145).PipFormatter,_=i(74).SelectionRenderer,u=i(16).TrendLineRenderer,f=i(313).LabelSettings;inherit(n,s),n.prototype.update=function(){this._invalidated=!0,this._labelDataInvalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,r,a,o,l,h,d,c=this._source.points();c.length<2||(e=c[0],t=c[1],null!==(i=this._model.timeScale().visibleBars())&&(n=this._source.properties(),e.index<i.firstBar()&&t.index<i.firstBar()&&!n.extendLeft.value()&&!n.extendRight.value()||(s.prototype._updateImpl.call(this),this._points.length<2||(r=n.showBarsRange.value(),a=n.showDateTimeRange.value(),o=n.showDistance.value(),l=n.showPriceRange.value(),h=n.showAngle.value(),l||r||a||o||h?(d=this,this._statCache=this._model._trendLineStatsCache.updateSource(this._source,(function(){return d._statLabelData()}))):(this._model._trendLineStatsCache.removeSource(this._source.id()),this._label=null,this._labelData&&(this._labelData.text="",this._labelData.lines=[])),this._invalidated=!1))))},n.prototype._statLabelData=function(){var e,t,i,n,s,a,o,l,h,d,_,u,g,v,w,y,m,x,b,S,P,R,T,L,C;return this._labelDataInvalidated&&(t=(e=this._source.points())[0],i=e[1],s=[],(n=this._source.properties()).showPriceRange.value()&&this._source.priceScale()&&(_=(h=i.price-t.price)/t.price,a=this._source.priceScale().formatter().format(h)+" ("+this._percentageFormatter.format(100*_)+")",(u=this._model.mainSeries().symbolInfo())&&u!==this._lastSymbolInfo&&(this._pipFormatter=new p(u.pricescale,u.minmov,u.type,u.minmove2),this._lastSymbolInfo=u),a+=this._pipFormatter?", "+this._pipFormatter.format(h):"",s.push("priceRange")),g=n.showBarsRange.value(),v=n.showDateTimeRange.value(),w=n.showDistance.value(),(g||v||w)&&(o="",g&&(d=i.index-t.index,o+=$.t("{0} bars").format(d)),v&&(y=this._model.timeScale().indexToUserTime(t.index),m=this._model.timeScale().indexToUserTime(i.index),y&&m&&(x=(m.valueOf()-y.valueOf())/1e3,(b=(new c).format(x))&&(o+=g?" ("+b+")":b))),w&&(o&&(o+=", "),void 0===h&&(h=i.price-t.price),void 0===d&&(d=i.index-t.index),S=Math.round(1e5*Math.sqrt(h*h+d*d))/1e5,o+=$.t("distance: {0}").format(this._numericFormatter.format(S))),o&&s.push("barsRange")),n.showAngle.value()&&(P=this._source.pointToScreenPoint(t),R=this._source.pointToScreenPoint(i),P=P instanceof Array?P[0]:P instanceof r?P:null,R=R instanceof Array?R[0]:R instanceof r?R:null,P instanceof r&&R instanceof r&&((L=R.subtract(P)).length()>0&&(L=L.normalized(),T=Math.acos(L.x),L.y>0&&(T=-T))),"number"!=typeof T||TradingView.isNaN(T)||(l=Math.round(180*T/Math.PI)+"",s.push("angle"))),this._label=[a,o,l].filter((function(e){return e})).join("\n")||null,this._icons=s,this._labelDataInvalidated=!1),C={points:[this._points[1]],text:this._label,color:this._source.properties().textcolor.value(),font:f.font,fontsize:f.fontSize,lineSpacing:f.lineSpacing,backgroundColor:f.bgColor,borderColor:f.borderColor,borderWidth:1,padding:f.padding,paddingLeft:30,doNotAlignText:!0,icons:this._icons},this._points[1].y<this._points[0].y&&(C.vertAlign="bottom"),this._points[1].x<this._points[0].x&&(C.horzAlign="right"),this._labelData=C,C},n.prototype.renderer=function(){var e,t,i,n,r,s,h,d,c;return this._invalidated&&this.updateImpl(),e=new l,this._invalidated?e:this._source.priceScale()?((t={}).points=this._points,t.floatPoints=this._floatPoints,t.width=this._model.timeScale().width(),t.height=this._source.priceScale().height(),t.color=this._source.properties().linecolor.value(),t.linewidth=this._source.properties().linewidth.value(),t.linestyle=this._source.properties().linestyle.value(),t.extendleft=this._source.properties().extendLeft.value(),t.extendright=this._source.properties().extendRight.value(),t.leftend=this._source.properties().leftEnd.value(),t.rightend=this._source.properties().rightEnd.value(),this._trendRenderer.setData(t),e.append(this._trendRenderer),i=this.isAnchorsRequired()||this._source.properties().alwaysShowStats.value(),n=(this.isHoveredSource()||this.isSelectedSource())&&this._source.properties().showMiddlePoint.value(),i&&this._label&&2===this._points.length&&(r=this._points[1],s={left:0,top:this._model._trendLineStatsCache.topByRow(this._statCache.row),width:this._model._trendLineStatsCache.rowWidth(this._statCache.row),height:this._model._trendLineStatsCache.rowHeight(this._statCache.row)},h={left:r.x,top:r.y,width:s.width,height:s.height},"right"===this._labelData.horzAlign?h.left-=f.padding+h.width:h.left+=f.padding,"bottom"===this._labelData.vertAlign?h.top-=f.padding+h.height:h.top+=f.padding,d=this._model._trendLineStatsCache.canvas(),c=new a(d.get(0),s,h),e.append(c)),n&&this._middlePoint&&e.append(new _({points:[this._middlePoint]})),this.addAnchors(e),!TradingView.printing&&this._source.hasAlert.value()&&!this._model.readOnly()&&t.points.length>=2&&this._source.getAlertIsActive((function(i){e.append(new o({point1:t.points[0],point2:t.points[1],color:i?t.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))})),e):e},t.TrendLinePaneView=n},940:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._trendLineRendererPoints01=new o,this._trendLineRendererPoints12=new o,this._trendLineRendererPoints23=new o,this._intersectionRenderer=new a,this._poligonRenderer=new h,this._aLabelRenderer=new l({}),this._bLabelRenderer=new l({}),this._cLabelRenderer=new l({}),this._dLabelRenderer=new l({})}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(230).TriangleRenderer,o=i(16).TrendLineRenderer,l=i(27).TextRenderer,h=i(164),d=i(8).CompositeRenderer,c=i(18).LineEnd;inherit(n,s),n.prototype.renderer=function(){var e,t,i,n,r,s,a,o,l;return this._invalidated&&(this.updateImpl(),this._invalidated=!1),this._points.length<2?null:(e=this._source.properties(),t=new d,i=this,n=function(t,n){return{points:[t],text:n,color:e.textcolor.value(),vertAlign:"middle",horzAlign:"center",font:e.font.value(),offsetX:0,offsetY:0,bold:e.bold&&e.bold.value(),italic:e.italic&&e.italic.value(),fontsize:e.fontsize.value(),backgroundColor:i._source.properties().color.value(),backgroundRoundRect:4}},s=(r=function(t,n){return{points:[t,n],width:i._model.timeScale().width(),height:i._source.priceScale().height(),color:i._source.properties().color.value(),linewidth:e.linewidth.value(),linestyle:CanvasEx.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:c.Normal,rightend:c.Normal}})(this._points[0],this._points[1]),this._trendLineRendererPoints01.setData(s),t.append(this._trendLineRendererPoints01),this._points.length>=3&&(s=r(this._points[1],this._points[2]),this._trendLineRendererPoints12.setData(s),t.append(this._trendLineRendererPoints12)),4===this._points.length&&(s=r(this._points[2],this._points[3]),this._trendLineRendererPoints23.setData(s),t.append(this._trendLineRendererPoints23),this._intersectPoint?(a=[this._startPoint1,this._startPoint2,this._intersectPoint],(o={}).points=a,o.color=e.color.value(),o.linewidth=e.linewidth.value(),o.backcolor=e.backgroundColor.value(),o.fillBackground=e.fillBackground.value(),o.transparency=e.transparency.value(),this._intersectionRenderer.setData(o),t.append(this._intersectionRenderer)):this._intersectPoint1&&this._intersectPoint2&&(a=[this._startPoint1,this._startPoint2,this._intersectPoint2,this._intersectPoint1],(o={}).filled=!0,o.fillBackground=!0,o.points=a,o.color=e.color.value(),o.linewidth=e.linewidth.value(),o.backcolor=e.backgroundColor.value(),o.transparency=e.transparency.value(),this._poligonRenderer.setData(o),t.append(this._poligonRenderer))),l=n(this._points[0],"A"),this._points[1].y>this._points[0].y?(l.vertAlign="bottom",l.offsetY=-10):(l.vertAlign="top",l.offsetY=5),this._aLabelRenderer.setData(l),t.append(this._aLabelRenderer),l=n(this._points[1],"B"),this._points[1].y<this._points[0].y?(l.vertAlign="bottom",l.offsetY=-10):(l.vertAlign="top",l.offsetY=5),this._bLabelRenderer.setData(l),t.append(this._bLabelRenderer),this._points.length>2&&(l=n(this._points[2],"C"),this._points[2].y<this._points[1].y?(l.vertAlign="bottom",l.offsetY=-10):(l.vertAlign="top",l.offsetY=5),this._cLabelRenderer.setData(l),t.append(this._cLabelRenderer)),this._points.length>3&&(l=n(this._points[3],"D"),this._points[3].y<this._points[2].y?(l.vertAlign="bottom",l.offsetY=-10):(l.vertAlign="top",l.offsetY=5),this._dLabelRenderer.setData(l),t.append(this._dLabelRenderer)),this.addAnchors(t),t)},n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){var e,t,i,n,a,o,l,h,d,c,p,_;if(s.prototype._updateImpl.call(this),this._valid=!1,delete this._intersectPoint,delete this._intersectPoint1,delete this._intersectPoint2,4===this._points.length){if(e=this._points[0],t=this._points[1],i=this._points[2],n=this._points[3],Math.abs(i.x-e.x)<1||Math.abs(n.x-t.x)<1)return;if(a=Math.min(e.x,t.x),a=Math.min(a,i.x),a=Math.min(a,n.x),o=(i.y-e.y)/(i.x-e.x),l=e.y+(a-e.x)*o,h=(n.y-t.y)/(n.x-t.x),d=t.y+(a-t.x)*h,Math.abs(o-h)<1e-6)return;this._startPoint1=new r(a,l),this._startPoint2=new r(a,d),c=(t.y-e.y+(e.x*o-t.x*h))/(o-h),this._valid=!0,c<a&&(p=Math.max(e.x,t.x),p=Math.max(p,i.x),p=Math.max(p,n.x),l=e.y+(p-e.x)*o,d=t.y+(p-t.x)*h,this._startPoint1=new r(p,l),this._startPoint2=new r(p,d)),_=e.y+(c-e.x)*o,this._intersectPoint=new r(c,_)}},t.LineToolTrianglePatternPaneView=n},942:function(e,t,i){"use strict";function n(e,t){r.call(this,e,t),this._invalidated=!0,this._renderer=new a}var r=i(12).LineSourcePaneView,s=i(8).CompositeRenderer,a=i(230).TriangleRenderer;inherit(n,r),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){r.prototype._updateImpl.call(this),this._invalidated=!1},n.prototype.renderer=function(){var e,t;return this._invalidated&&this.updateImpl(),(e={}).points=this._points,e.color=this._source.properties().color.value(),e.linewidth=this._source.properties().linewidth.value(),e.backcolor=this._source.properties().backgroundColor.value(),e.fillBackground=this._source.properties().fillBackground.value(),e.transparency=this._source.properties().transparency.value(),this._renderer.setData(e),this.isAnchorsRequired()?((t=new s).append(this._renderer),this.addAnchors(t),t):this._renderer},t.TrianglePaneView=n},944:function(e,t,i){"use strict";function n(e,t){s.call(this,e,t),this._invalidated=!0,this._lineRenderer=new l}var r=i(1).Point,s=i(12).LineSourcePaneView,a=i(105).PaneRendererClockIcon,o=i(8).CompositeRenderer,l=i(146).VerticalLineRenderer;inherit(n,s),n.prototype.update=function(){this._invalidated=!0},n.prototype.updateImpl=function(){s.prototype._updateImpl.call(this),this._invalidated=!1},n.prototype.renderer=function(){var e,t,i;return this._invalidated&&this.updateImpl(),(e={}).width=this._model.timeScale().width(),e.height=this._source.priceScale().height(),e.points=this._points,e.color=this._source.properties().linecolor.value(),e.linewidth=this._source.properties().linewidth.value(),e.linestyle=this._source.properties().linestyle.value(),this._lineRenderer.setData(e),(t=new o).append(this._lineRenderer),this.addAnchors(t),TradingView.printing||!this._source.hasAlert.value()||this._model.readOnly()||1!==e.points.length||(i=new r(this._points[0].x,this._source.priceScale().height()/2),this._source.getAlertIsActive((function(n){t.append(new a({point1:i,color:n?e.color:defaults("chartproperties.alertsProperties.drawingIcon.color")}))}))),t},t.VertLinePaneView=n},1133:function(e,t,i){"use strict";var n,r,s,a;Object.defineProperty(t,"__esModule",{value:!0}),n=i(1),r=i(19),s=i(4),a=function(){function e(){this._data=null}return e.prototype.setData=function(e){this._data=e},e.prototype.draw=function(e){var t,i,s,a,o,l;null!==this._data&&(e.lineCap="butt",e.strokeStyle=this._data.color,e.lineWidth=this._data.linewidth,e.translate(this._data.center.x,this._data.center.y),i=(t=this._data.edge.subtract(this._data.center)).y/t.x,s=this._data.point.subtract(this._data.center),a=(s=new n.Point(s.x,s.y/i)).length(),o=this._data.prevPoint.subtract(this._data.center),l=(o=new n.Point(o.x,o.y/i)).length(),e.scale(1,i),this._data.fillBack&&(this._data.point.x<this._data.center.x&&(a=-a,l=-l),e.beginPath(),e.moveTo(l,0),e.lineTo(a,0),e.arcTo(a,a,0,a,Math.abs(a)),e.lineTo(0,l),e.arcTo(l,l,l,0,Math.abs(l)),e.fillStyle=r.generateColor(this._data.color,this._data.transparency,!0),e.fill()),e.beginPath(),this._data.point.x>this._data.center.x?e.arc(0,0,Math.abs(a),0,Math.PI/2,!1):e.arc(0,0,Math.abs(a),-Math.PI/2,-Math.PI,!0),e.scale(1,1/i),e.stroke())},e.prototype.hitTest=function(e){var t,i,r,a,o,l,h;return null===this._data?null:(e=e.subtract(this._data.center),i=(t=this._data.edge.subtract(this._data.center)).y/t.x,e=new n.Point(e.x,e.y/i),r=this._data.point.subtract(this._data.center),a=(r=new n.Point(r.x,r.y/i)).length(),o=e.length(),l=this._data.prevPoint.subtract(this._data.center),h=(l=new n.Point(l.x,l.y/i)).length(),Math.abs(o-a)<5&&t.x*e.x>=0&&t.y*e.y>=0?new s(s.MOVEPOINT):this._data.fillBack&&o>=h&&o<=a&&t.x*e.x>=0&&t.y*e.y>=0?new s(s.MOVEPOINT_BACKGROUND):null)},e}(),t.GannArcRenderer=a},1134:function(e,t,i){"use strict";var n,r,s,a,o,l,h,d,c;Object.defineProperty(t,"__esModule",{value:!0}),n=i(5),r=i(1),s=i(12),a=i(16),o=i(8),l=i(18),h=i(115),d=i(1133),c=function(e){function t(t,i){var n=e.call(this,t,i)||this;return n._verticalLevelsRenderers=[],n._horizontalLevelsRenderers=[],n._fanRenderers=[],n._arcRenderers=[],n._initRenderers(),n}return n.__extends(t,e),t.prototype.renderer=function(e){var t,i,n,r,s,a,l,h,d,c,p,_;return this._invalidated&&(this._updateImpl(),this._invalidated=!1),t=this._getSource(),i=this._getPoints(),n=new o.CompositeRenderer,i.length<2?(this.addAnchors(n),n):(r=i[0],a=(s=3===i.length?i[2]:i[1]).x-r.x,l=s.y-r.y,h=r,d=s,p={paneHeight:e,paneWidth:(c=this._getModel()).timeScale().width(),barsCoordsRange:a,priceCoordsRange:l,startPoint:h,endPoint:d,p1:r,p2:s},this._prepareLevels(n,p),this._prepareFanLines(n,p),this._prepareArcs(n,p),this.isAnchorsRequired()&&(_=[r,i[1]],c.lineBeingCreated()===t&&_.pop(),n.append(this.createLineAnchor({points:_}))),n)},t.prototype._updateImpl=function(){var t,i,n,r,s;e.prototype._updateImpl.call(this),t=this._getSource(),i=this._getPoints(),n=t.getScreenPoints(),i.length<2||n.length<2||(r=n[0],s=n[1],i[1]=r,i[1].data=1,i[2]=s)},t.prototype._initRenderers=function(){var e,t,i,n=this._getSource(),r=n.levelsCount();for(e=0;e<r;e++)this._verticalLevelsRenderers.push(new a.TrendLineRenderer),this._horizontalLevelsRenderers.push(new a.TrendLineRenderer);for(t=n.fanLinesCount(),e=0;e<t;e++)this._fanRenderers.push(new a.TrendLineRenderer);for(i=n.arcsCount(),e=0;e<i;e++)this._arcRenderers.push(new d.GannArcRenderer)},t.prototype._prepareLevels=function(e,t){var i,n,s,a,o,d,c,p,_,u,f=t.startPoint,g=t.endPoint,v=t.paneHeight,w=t.paneWidth,y=t.barsCoordsRange,m=t.priceCoordsRange;for(i=0,n=this._getSource().levels();i<n.length;i++)(s=n[i]).visible&&(a=s.index/5,o=f.x+a*y,d={points:[new r.Point(o,f.y),new r.Point(o,g.y)],width:w,height:v,color:s.color,linewidth:s.width,linestyle:h.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:l.LineEnd.Normal,rightend:l.LineEnd.Normal},(c=this._verticalLevelsRenderers[s.index]).setData(d),e.append(c),p=f.y+a*m,_={points:[new r.Point(f.x,p),new r.Point(g.x,p)],width:w,height:v,color:s.color,linewidth:s.width,linestyle:h.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:l.LineEnd.Normal,rightend:l.LineEnd.Normal},(u=this._horizontalLevelsRenderers[s.index]).setData(_),e.append(u))},t.prototype._prepareFanLines=function(e,t){var i,n,s,a,o,d,c,p,_,u,f=t.p1,g=t.startPoint,v=t.endPoint,w=t.paneHeight,y=t.paneWidth,m=t.barsCoordsRange,x=t.priceCoordsRange;for(i=0,n=this._getSource().fanLines();i<n.length;i++)(s=n[i]).visible&&(d=void 0,c=void 0,(a=s.x)>(o=s.y)?(d=v.x,p=o/a,c=g.y+p*x):(c=v.y,p=a/o,d=g.x+p*m),_={points:[f,new r.Point(d,c)],width:y,height:w,color:s.color,linewidth:s.width,linestyle:h.LINESTYLE_SOLID,extendleft:!1,extendright:!1,leftend:l.LineEnd.Normal,rightend:l.LineEnd.Normal},(u=this._fanRenderers[s.index]).setData(_),e.append(u))},t.prototype._prepareArcs=function(e,t){var i,n,s,a,o,l,h,d,c,p=t.p1,_=t.startPoint,u=t.endPoint,f=t.barsCoordsRange,g=t.priceCoordsRange,v=p,w=this._getSource(),y=w.isArcsBackgroundFilled(),m=w.arcsBackgroundTransparency();for(i=0,n=w.arcs();i<n.length;i++)(s=n[i]).visible&&(a=s.x/5,o=s.y/5,l=_.x+a*f,h=_.y+o*g,d={center:_,point:new r.Point(l,h),edge:u,color:s.color,linewidth:s.width,fillBack:y,transparency:m,prevPoint:v},(c=this._arcRenderers[s.index]).setData(d),e.append(c),v=d.point)},t}(s.LineSourcePaneView),t.GannComplexPaneView=c}});