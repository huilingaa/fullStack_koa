(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{xfLJ:function(e,t,i){"use strict";i.r(t);var n=i("lSNA"),s=i.n(n),a=i("vKDJ"),o=i("L2JU");function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach((function(t){s()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var m={name:"EmailVerified",data:function(){return{emailForm:{password:"",mobileCode:"",emailCode:"",email:""},emailRules:{password:[{required:!0,message:this.$t("user.smsauthentication.please_enter_login_password"),trigger:"blur"}],email:[{required:!0,message:this.$t("user.smsauthentication.please_enter_email_number"),trigger:"blur"},{type:"email",message:this.$t("login.please_input_the_correct_email_address"),trigger:"blur"}],mobileCode:[{required:!0,message:this.$t("user.smsauthentication.please_enter_sms_code"),trigger:"blur"}],emailCode:[{required:!0,message:this.$t("user.smsauthentication.please_enter_email_code"),trigger:"blur"}]},isBtnDisabled:!1,sendSmsCountDown:0,sendEmailCountDown:0,geetest_challenge:null,geetest_validate:null,geetest_seccode:null,captchaObj:null}},computed:r(r({},Object(o.d)(["token","lang","userInfo"])),{},{sendSmsBtnText:function(){return 0===this.sendSmsCountDown?this.$t("common.send_code"):this.sendSmsCountDown+"S"},sendEmailBtnText:function(){return 0===this.sendEmailCountDown?this.$t("common.send_code"):this.sendEmailCountDown+"S"}}),methods:{checkAndSend:function(){this.sendMobileAuthNo()},sendMobileAuthNo:function(){var e=this;a.a.sendBindEmailSms({email:this.emailForm.email}).then((function(){e.sendSmsCountDown=60,e.countSmsDown()})).catch((function(){e.sendSmsCountDown=0}))},sendEmail:function(){var e=this;this.emailForm.email?C.Utils.isEmail(this.emailForm.email)?a.a.sendBindEmailCodeByEmail({email:this.emailForm.email}).then((function(){e.sendEmailCountDown=60,e.countEmailDown()})).catch((function(){e.sendEmailCountDown=0})):this.$message.warning(this.$t("login.please_input_the_correct_email_address")):this.$message.warning(this.$t("user.smsauthentication.please_enter_email_number"))},countSmsDown:function(){this.sendSmsCountDown>0&&(this.sendSmsCountDown=this.sendSmsCountDown-1,setTimeout(this.countSmsDown,1e3))},countEmailDown:function(){this.sendEmailCountDown=this.sendEmailCountDown-1,this.sendEmailCountDown>0&&setTimeout(this.countEmailDown,1e3)},saveEmailVerified:function(){var e=this;this.$refs.emailForm.validate((function(t){if(!t)return!1;e.isBtnDisabled=!0,e.bindEmail()}))},bindEmail:function(){var e=this,t={loginPassword:this.emailForm.password,email:this.emailForm.email,phoneVerificationCode:this.emailForm.mobileCode,emailVerificationCode:this.emailForm.emailCode};a.a.bindEmail(t).then((function(){e.$message({type:"success",message:e.$t("user.smsauthentication.bind_successfully")}),e.$router.back()})).finally((function(){e.isBtnDisabled=!1}))}}},u=i("KHd+"),d=Object(u.a)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-card",{staticClass:"uc-content"},[i("div",{staticClass:"uc-content-header",attrs:{slot:"header"},slot:"header"},[e._v("\n      "+e._s(e.$t("user.email_authentication"))+"\n    ")]),e._v(" "),i("div",[i("div",{staticStyle:{margin:"10px auto",width:"300px"}},[i("el-form",{ref:"emailForm",staticClass:"demo-ruleForm",attrs:{"hide-required-asterisk":!0,"status-icon":!1,size:"medium",model:e.emailForm,rules:e.emailRules}},[i("el-form-item",{attrs:{label:e.$t("common.login_password"),prop:"password"}},[i("el-input",{attrs:{type:"password"},model:{value:e.emailForm.password,callback:function(t){e.$set(e.emailForm,"password",t)},expression:"emailForm.password"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("user.smsauthentication.email_number"),prop:"email"}},[i("el-input",{attrs:{type:"text"},model:{value:e.emailForm.email,callback:function(t){e.$set(e.emailForm,"email",t)},expression:"emailForm.email"}})],1),e._v(" "),i("el-form-item",{staticClass:"btnDisabled",attrs:{label:e.$t("user.smsauthentication.sms_code"),prop:"mobileCode"}},[i("el-input",{attrs:{type:"text",maxlength:"6"},model:{value:e.emailForm.mobileCode,callback:function(t){e.$set(e.emailForm,"mobileCode",t)},expression:"emailForm.mobileCode"}},[i("el-button",{staticClass:"send-btn",attrs:{slot:"append",type:"plain",disabled:e.sendSmsCountDown>0},on:{click:e.checkAndSend},slot:"append"},[e._v("\n                "+e._s(e.sendSmsBtnText)+"\n              ")])],1)],1),e._v(" "),i("el-form-item",{staticClass:"btnDisabled",attrs:{label:e.$t("common.email_code"),prop:"emailCode"}},[i("el-input",{attrs:{type:"text",maxlength:"6"},model:{value:e.emailForm.emailCode,callback:function(t){e.$set(e.emailForm,"emailCode",t)},expression:"emailForm.emailCode"}},[i("el-button",{staticClass:"send-btn",attrs:{slot:"append",type:"plan",disabled:e.sendEmailCountDown>0},on:{click:e.sendEmail},slot:"append"},[e._v("\n                "+e._s(e.sendEmailBtnText)+"\n              ")])],1)],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",disabled:e.isBtnDisabled},on:{click:e.saveEmailVerified}},[e._v("\n              "+e._s(e.$t("user.email_authentication_enable"))+"\n            ")])],1)],1)],1)])])],1)}),[],!1,null,"0d4a114a",null);t.default=d.exports}}]);