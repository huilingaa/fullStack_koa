(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{"Ix+M":function(e,t,i){"use strict";i.r(t);var r=i("lSNA"),a=i.n(r),s=i("vKDJ"),o=i("L2JU");function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){a()(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var l={name:"Verified",data:function(){return{verifiedStatus:!1,operReason:"",readonly:null,verifiedForm:{country:"",firstName:"",idNo:"",idCardBackURI:"",idCardFrontURI:"",idCardInhandURI:"",idCardFront:"",idCardBack:"",idCardInhand:""},countrys:{},loading:!1,isBtnDisabled:!1,showFileList:!1,myHeaders:{Authorization:""},dialogVisible:!1}},computed:d(d({},Object(o.d)(["token"])),{},{verifiedFormRules:function(){return{country:[{required:!0,message:this.$t("user.kyc.please_select_country"),trigger:"change"}],lastName:[{required:!0,message:this.$t("user.kyc.please_enter_last_name"),trigger:"blur"}],firstName:[{required:!0,message:this.$t("user.kyc.please_enter_first_name"),trigger:"blur"}],idNo:[{required:!0,message:this.$t("user.kyc.please_enter_id_card_number"),trigger:"blur"}]}},countrysObj:function(){for(var e=this.countrys,t={},i=0;i<e.length;i++)t[e[i].code]=e[i].name;return t}}),mounted:function(){var e=this;s.a.getCountries().then((function(t){e.countrys=t;for(var i=0;i<t.length;i++)e.countrysObj[t[i].code]=t[i].name})),this.myHeaders.Authorization=this.token,this.getIdCert()},methods:{saveUserKyc:function(){0!==this.verifiedForm.firstName.indexOf(this.verifiedForm.lastName)||"zh"!==this.$store.state.lang?this.submitData():this.dialogVisible=!0},submitData:function(){var e=this;this.dialogVisible=!1,this.$refs.verifiedForm.validate((function(t){if(!t)return!1;e.isBtnDisabled=!0,s.a.saveUserKyc(e.verifiedForm).then((function(t){e.isBtnDisabled=!1,e.verifiedStatus="SUBMITTED",e.$message({type:"success",message:e.$t("user.kyc.kcy_submit_successfully")}),e.$router.back()})).finally((function(){e.isBtnDisabled=!1}))}))},uploadError:function(){this.loading=!1},handleIdCardInhandProgress:function(){this.loading=!0},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type||"image/gif"===e.type,i=e.size/1024/1024<2;return t||this.$message({type:"error",message:this.$t("user.kyc.uploading_images_can_only_be_in_jpg_format")}),i||this.$message({type:"error",message:this.$t("user.kyc.upload_image_size_cannot_exceed_2mb")}),t&&i},uploadRequestIdCardFront:function(e){var t=this,i=new FormData;i.append("file",e.file),s.a.uploadFile(i).then((function(e){t.loading=!1,t.verifiedForm.idCardFront=e,t.verifiedForm.idCardFrontURI=t.getImageUrl(e)}))},uploadRequestIdCardBack:function(e){var t=this,i=new FormData;i.append("file",e.file),s.a.uploadFile(i).then((function(e){t.loading=!1,t.verifiedForm.idCardBack=e,t.verifiedForm.idCardBackURI=t.getImageUrl(e)}))},uploadRequestIdCardInhand:function(e){var t=this,i=new FormData;i.append("file",e.file),s.a.uploadFile(i).then((function(e){t.loading=!1,t.verifiedForm.idCardInhand=e,t.verifiedForm.idCardInhandURI=t.getImageUrl(e)}))},getIdCert:function(){var e=this;s.a.getUserKyc().then((function(t){t&&t.idNo&&(e.readonly="PASSED"===t.verifiedStatus||"SUBMITTED"===t.verifiedStatus,e.readonly&&(e.verifiedForm=t,e.verifiedForm.idCardInhandURI=e.getImageUrl(t.idCardInhand),e.verifiedForm.idCardBackURI=e.getImageUrl(t.idCardBack),e.verifiedForm.idCardFrontURI=e.getImageUrl(t.idCardFront)),e.operReason="",e.verifiedStatus=t.verifiedStatus,"REJECTED"===e.verifiedStatus&&(e.operReason=t.operReason))})).finally((function(){null===e.readonly&&(e.readonly=!1)}))},getVerifiedStatusName:function(){return"SUBMITTED"===this.verifiedStatus?this.$t("user.kyc_status_submitted"):"REJECTED"===this.verifiedStatus?"("+this.$t("user.kyc_status_rejected")+(this.operReason?":"+this.operReason:"")+")":"PASSED"===this.verifiedStatus?this.$t("user.kyc_status_passed"):void 0},handleClose:function(){this.dialogVisible=!1},getImageUrl:function(e){return"/api/tool/upload/image?fileId="+e+"&token="+this.token}}},c=i("KHd+"),u=Object(c.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[null==e.readonly?i("el-card",{staticClass:"uc-content"}):e.readonly?i("el-card",{staticClass:"uc-content"},[i("div",{staticClass:"uc-content-header",attrs:{slot:"header"},slot:"header"},[e._v("\n      "+e._s(e.$t("user.kyc.individual_verification"))+"\n    ")]),e._v(" "),i("div",{staticStyle:{margin:"20px auto",width:"260px"}},[i("el-row",["PASSED"===e.verifiedStatus||"SUBMITTED"===e.verifiedStatus?i("el-col",{attrs:{span:24}},["SUBMITTED"===e.verifiedStatus?i("h3",{staticClass:"el-icon-info",staticStyle:{margin:"18px 0"}},[e._v("\n            "+e._s(e.getVerifiedStatusName())+"\n          ")]):e._e(),e._v(" "),"PASSED"===e.verifiedStatus?i("h3",{staticClass:"el-icon-success",staticStyle:{color:"green",margin:"18px 0"}},[e._v("\n            "+e._s(e.getVerifiedStatusName())+"\n          ")]):e._e()]):e._e()],1),e._v(" "),i("el-row",[i("el-col",{attrs:{span:12}},[e._v("\n          "+e._s(e.$t("user.kyc.country"))+"：\n        ")]),e._v(" "),i("el-col",{attrs:{span:12}},[e._v("\n          "+e._s(isNaN(e.verifiedForm.country)?e.verifiedForm.country:e.countrysObj[e.verifiedForm.country])+"\n        ")])],1),e._v(" "),i("el-row",{staticStyle:{"padding-top":"20px"}},[i("el-col",{attrs:{span:12}},[e._v("\n          "+e._s(e.$t("user.kyc.full_name"))+"：\n        ")]),e._v(" "),i("el-col",{attrs:{span:12}},[e._v("\n          "+e._s(e.verifiedForm.lastName)+e._s(e.verifiedForm.firstName)+"\n        ")])],1),e._v(" "),i("el-row",{staticStyle:{"padding-top":"20px"}},[i("el-col",{attrs:{span:12}},[e._v("\n          "+e._s(e.$t("user.kyc.id_card_number"))+"：\n        ")]),e._v(" "),i("el-col",{attrs:{span:12}},[e._v("\n          "+e._s(e.verifiedForm.idNo)+"\n        ")])],1)],1)]):i("el-card",{staticClass:"uc-content"},[i("div",{staticClass:"el-card__header"},[i("span",[e._v(e._s(e.$t("user.kyc.individual_verification")))]),e._v(" "),i("span",{staticStyle:{color:"#f44b4b"}},[e._v(e._s(e.getVerifiedStatusName()))])]),e._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("el-form",{ref:"verifiedForm",attrs:{inline:!0,"hide-required-asterisk":!0,model:e.verifiedForm,rules:e.verifiedFormRules,"label-width":"90px","label-position":"right"}},[i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:e.$t("user.kyc.country"),prop:"country"}},[i("el-select",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("user.kyc.please_select_country"),filterable:""},model:{value:e.verifiedForm.country,callback:function(t){e.$set(e.verifiedForm,"country",t)},expression:"verifiedForm.country"}},e._l(e.countrys,(function(e,t){return i("el-option",{key:t,attrs:{label:e.name,value:e.code}})})),1)],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("user.kyc.last_name"),prop:"lastName"}},[i("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("user.kyc.please_enter_last_name")},model:{value:e.verifiedForm.lastName,callback:function(t){e.$set(e.verifiedForm,"lastName",t)},expression:"verifiedForm.lastName"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-form-item",{attrs:{label:e.$t("user.kyc.id_card_number"),prop:"idNo"}},[i("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("user.kyc.please_enter_id_card_number")},model:{value:e.verifiedForm.idNo,callback:function(t){e.$set(e.verifiedForm,"idNo",t)},expression:"verifiedForm.idNo"}})],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("user.kyc.first_name"),prop:"firstName"}},[i("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:e.$t("user.kyc.please_enter_first_name")},model:{value:e.verifiedForm.firstName,callback:function(t){e.$set(e.verifiedForm,"firstName",t)},expression:"verifiedForm.firstName"}})],1)],1),e._v(" "),i("span",{staticStyle:{position:"relative",top:"120px"}},[i("el-divider")],1),e._v(" "),i("el-form-item",{staticStyle:{"margin-top":"20px","margin-left":"80px"}},[i("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":e.$t("user.kyc.uploading")}},[i("el-col",{attrs:{span:8}},[i("el-upload",{staticClass:"upload-passport",attrs:{action:"","http-request":e.uploadRequestIdCardFront,"show-file-list":e.showFileList,"on-error":e.uploadError,"on-progress":e.handleIdCardInhandProgress,"before-upload":e.beforeAvatarUpload}},[e.verifiedForm.idCardFront?i("img",{staticClass:"passport",attrs:{src:e.verifiedForm.idCardFrontURI}}):i("i",{staticClass:"el-icon-circle upload-passport-icon"})]),e._v(" "),i("div",{staticClass:"desc",staticStyle:{width:"290px","padding-right":"72px"}},[e._v("\n                "+e._s(e.$t("user.kyc.please_upload_a_positive_photo_of_your_passport"))+"\n              ")]),e._v(" "),i("el-input",{attrs:{type:"hidden"},model:{value:e.verifiedForm.idCardFront,callback:function(t){e.$set(e.verifiedForm,"idCardFront",t)},expression:"verifiedForm.idCardFront"}})],1),e._v(" "),i("el-col",{attrs:{span:8}},[i("el-upload",{staticClass:"upload-idcard-z",attrs:{action:"/api/tool/upload/image","http-request":e.uploadRequestIdCardBack,"show-file-list":e.showFileList,headers:e.myHeaders,"on-error":e.uploadError,"on-progress":e.handleIdCardInhandProgress,"before-upload":e.beforeAvatarUpload}},[e.verifiedForm.idCardBack?i("img",{staticClass:"avatar",attrs:{src:e.verifiedForm.idCardBackURI}}):i("i",{staticClass:"el-icon-circle upload-idcard-z-icon"})]),e._v(" "),i("div",{staticClass:"desc",staticStyle:{"margin-bottom":"10px",width:"290px","padding-right":"72px"}},[e._v("\n                "+e._s(e.$t("user.kyc.please_upload_the_photo_on_the_back_of_your_passport"))+"\n              ")]),e._v(" "),i("el-input",{attrs:{type:"hidden"},model:{value:e.verifiedForm.idCardBack,callback:function(t){e.$set(e.verifiedForm,"idCardBack",t)},expression:"verifiedForm.idCardBack"}})],1),e._v(" "),i("el-col",{attrs:{span:8}},[i("el-upload",{staticClass:"upload-idcard-b",attrs:{action:"/api/tool/upload/image","http-request":e.uploadRequestIdCardInhand,"on-error":e.uploadError,"on-progress":e.handleIdCardInhandProgress,"show-file-list":e.showFileList,"before-upload":e.beforeAvatarUpload,disabled:e.readonly}},[e.verifiedForm.idCardInhand?i("img",{staticClass:"avatar",attrs:{src:e.verifiedForm.idCardInhandURI}}):i("i",{staticClass:"el-icon-circle upload-idcard-b-icon"})]),e._v(" "),i("div",{staticClass:"desc",staticStyle:{width:"290px","padding-right":"70px"}},[e._v("\n                "+e._s(e.$t("user.kyc.gx_verification_date"))+"\n              ")]),e._v(" "),i("el-input",{attrs:{type:"hidden"},model:{value:e.verifiedForm.idCardInhand,callback:function(t){e.$set(e.verifiedForm,"idCardInhand",t)},expression:"verifiedForm.idCardInhand"}})],1)],1)],1),e._v(" "),i("el-form-item",{staticStyle:{"font-family":"pingFang SC,Microsoft YaHei,sans-serif !important","margin-left":"80px","margin-top":"-15px","border-top":"1px dashed rgba(150,150,150,0.9)",width:"1000px","padding-top":"10px"}},[i("div",[i("span",{staticStyle:{"font-weight":"700"}},[e._v(e._s(e.$t("user.photos_require_title")))]),i("span",[e._v(e._s(e.$t("user.photos_require")))])]),e._v(" "),i("div",[i("div",{staticStyle:{"font-weight":"700"}},[e._v("\n              "+e._s(e.$t("user.photos_tips_title"))+"\n            ")]),e._v(" "),i("ol",{staticStyle:{"margin-top":"0","padding-left":"15px"}},[i("li",[e._v(e._s(e.$t("user.photos_tips_1")))]),e._v(" "),i("li",[e._v(e._s(e.$t("user.photos_tips_2")))]),e._v(" "),i("li",[e._v(e._s(e.$t("user.photos_tips_3")))])])])]),e._v(" "),i("el-form-item",{staticClass:"commit"},[i("el-button",{attrs:{type:"primary",disabled:e.isBtnDisabled},on:{click:e.saveUserKyc}},[e._v("\n            "+e._s(e.$t("user.kyc.confirm_verification"))+"\n          ")])],1)],1)],1)]),e._v(" "),i("el-dialog",{attrs:{title:e.$t("order.tip"),visible:e.dialogVisible,width:"400px","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("p",{staticStyle:{"text-align":"center"}},[e._v("\n      "+e._s(e.$t("user.kyc.check_your_name"))+"\n    ")]),e._v(" "),i("p",{staticStyle:{"text-align":"center","margin-top":"6px"}},[e._v("\n      "+e._s(e.$t("user.kyc.last_name"))+":"+e._s(e.verifiedForm.lastName)+"       "+e._s(e.$t("user.kyc.first_name"))+":"+e._s(e.verifiedForm.firstName)+"\n    ")]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("user.kyc.need_name")))]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.submitData}},[e._v(e._s(e.$t("user.kyc.confirm")))])],1)])],1)}),[],!1,null,"5f2d7696",null);t.default=u.exports}}]);