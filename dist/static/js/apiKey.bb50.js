(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"3TXH":function(e,i,t){"use strict";t.r(i);var a=t("vKDJ"),n=t("sxGJ"),r=t.n(n),o={name:"ApiKey",data:function(){return{loading:!1,apiKeyRecord:[],sendCountDown:0,confirmType:"",apiKeyForm:{name:"",bindIp:""},verificationForm:{name:"",bindIp:"",verificationCode:""},apiKey:{accessKey:"",secretKey:""},verifiedVisible:!1,verificationBtnDisabled:!1,generateApiKeyVisible:!1,apiKeyId:0}},computed:{sendBtnText:function(){return 0===this.sendCountDown?this.$t("common.send_code"):this.sendCountDown+"S"},apiKeyFormRules:function(){return{name:[{required:!0,message:this.$t("user.apikey.please_enter_remark"),trigger:"blur"}]}},verificationFormRules:function(){return{name:[{required:!0,message:this.$t("user.apikey.please_enter_remark"),trigger:"blur"}],verificationCode:[{required:!0,message:this.$t("user.apikey.please_enter_email_code"),trigger:"blur"}]}}},mounted:function(){this.searchApiKey()},methods:{searchApiKey:function(){var e=this,i=this;this.loading=!0,a.a.getUserApiKeys().then((function(e){i.apiKeyRecord=e})).finally((function(){e.loading=!1}))},sendVerificationCode:function(){var e=this;e.sendCountDown=60,e.countDown(),a.a.sendEmailCode().then((function(e){})).catch((function(i){e.sendEmailCountDown=0}))},countDown:function(){this.sendCountDown>0&&(this.sendCountDown=this.sendCountDown-1,setTimeout(this.countDown,1e3))},generate:function(e){var i=this;this.$refs[e].validate((function(e){if(!e)return!1;i.confirmType="create",i.showVerificationDialog()}))},confirm:function(e){var i=this;this.$refs[e].validate((function(e){if(!e)return!1;var t=i;if(i.verificationBtnDisabled=!0,"create"===i.confirmType){var n={name:i.apiKeyForm.name,bindIp:i.apiKeyForm.bindIp,verificationCode:i.verificationForm.verificationCode};a.a.createApiKey(n).then((function(e){t.verifiedVisible=!1,t.apiKey=e,t.generateApiKeyVisible=!0,t.$refs.verificationForm.resetFields(),t.$refs.apiKeyForm.resetFields(),t.$message({type:"success",message:t.$t("user.apikey.add_successfully")})})).finally((function(){t.verificationBtnDisabled=!1,t.searchApiKey()}))}else if("delete"===i.confirmType)a.a.deleteApiKey(i.apiKeyId,i.verificationForm.verificationCode).then((function(e){t.$message({type:"success",message:t.$t("user.apikey.delete_successfully")}),t.verifiedVisible=!1,t.$refs.verificationForm.resetFields(),t.searchApiKey()})).finally((function(){t.verificationBtnDisabled=!1}));else if("update"===i.confirmType){var r={id:i.apiKeyId,name:i.verificationForm.name,bindIp:i.verificationForm.bindIp,verificationCode:i.verificationForm.verificationCode};a.a.updateApiKey(r).then((function(e){t.$message({type:"success",message:t.$t("user.apikey.modify_successfully")}),t.verifiedVisible=!1,t.$refs.verificationForm.resetFields(),t.searchApiKey()})).finally((function(){t.verificationBtnDisabled=!1}))}}))},copyKey:function(e){var i=new r.a(e),t=this;i.on("success",(function(e){t.$message({type:"success",message:t.$t("user.apikey.copy_successfully")}),i.destroy()})),i.on("error",(function(e){t.$message({type:"error",message:t.$t("user.apikey.copy_is_not_supported")}),i.destroy()}))},iKnow:function(){this.apiKey={},this.generateApiKeyVisible=!1,this.searchApiKey()},deleteApiKey:function(e){this.confirmType="delete",this.apiKeyId=e.id,this.showVerificationDialog()},updateApiKey:function(e){this.confirmType="update",this.apiKeyId=e.id;var i=this;a.a.getApiKeyById(this.apiKeyId).then((function(e){i.verificationForm=e,i.showVerificationDialog()}))},showVerificationDialog:function(){this.verificationForm.verificationCode="",this.sendCountDown=0,this.verifiedVisible=!0}}},s=t("KHd+"),c=Object(s.a)(o,(function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("el-card",{staticClass:"uc-content"},[t("div",{staticClass:"uc-content-header",attrs:{slot:"header"},slot:"header"},[e._v("\n      API Key\n    ")]),e._v(" "),t("div",{staticStyle:{padding:"0 10px"}},[t("el-form",{ref:"apiKeyForm",staticStyle:{width:"400px"},attrs:{"hide-required-asterisk":!0,model:e.apiKeyForm,"status-icon":!1,rules:e.apiKeyFormRules}},[t("el-form-item",{attrs:{label:e.$t("user.apikey.remark"),prop:"name"}},[t("el-input",{attrs:{type:"text"},model:{value:e.apiKeyForm.name,callback:function(i){e.$set(e.apiKeyForm,"name",i)},expression:"apiKeyForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("user.apikey.bind_ip"),prop:"bindIp"}},[t("el-input",{attrs:{type:"text",placeholder:e.$t("user.apikey.bind_ip_remark")},model:{value:e.apiKeyForm.bindIp,callback:function(i){e.$set(e.apiKeyForm,"bindIp",i)},expression:"apiKeyForm.bindIp"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(i){return e.generate("apiKeyForm")}}},[e._v("\n            "+e._s(e.$t("user.apikey.add"))+"\n          ")])],1)],1),e._v(" "),t("span",{staticStyle:{color:"#333333"}},[e._v(e._s(e.$t("user.apikey.my_apikey")))]),e._v(" "),t("el-divider",{attrs:{"content-position":"left"}}),e._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{margin:"10px 10px auto 0"},attrs:{data:e.apiKeyRecord}},[t("el-table-column",{attrs:{prop:"name",label:e.$t("user.apikey.remark"),width:"150px",align:"left"}}),e._v(" "),t("el-table-column",{attrs:{"header-align":"left",align:"left",prop:"accessKey",width:"300px",label:"Key"}}),e._v(" "),t("el-table-column",{attrs:{prop:"bindIp",label:e.$t("user.apikey.bind_ip"),"header-align":"left",align:"left"}}),e._v(" "),t("el-table-column",{attrs:{prop:"expireAt","header-align":"left",align:"left",width:"150px",label:e.$t("user.apikey.expiration_date")}}),e._v(" "),t("el-table-column",{attrs:{"header-align":"center",align:"center",prop:"action",label:e.$t("trade.operation"),"min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(i){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.updateApiKey(i.row)}}},[e._v("\n              "+e._s(e.$t("user.apikey.edit"))+"\n            ")]),e._v(" "),t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.deleteApiKey(i.row)}}},[e._v("\n              "+e._s(e.$t("user.apikey.delete"))+"\n            ")])]}}])})],1)],1)]),e._v(" "),t("el-dialog",{attrs:{visible:e.verifiedVisible,title:e.$t("user.apikey.security_verification"),width:"500px","close-on-click-modal":!1},on:{"update:visible":function(i){e.verifiedVisible=i}}},[t("el-form",{ref:"verificationForm",attrs:{"hide-required-asterisk":!0,"status-icon":!1,model:e.verificationForm,rules:e.verificationFormRules}},["update"==e.confirmType?t("div",[t("el-form-item",{attrs:{label:e.$t("user.apikey.remark"),prop:"name"}},[t("el-input",{attrs:{type:"text"},model:{value:e.verificationForm.name,callback:function(i){e.$set(e.verificationForm,"name",i)},expression:"verificationForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("user.apikey.bind_ip"),prop:"bindIp"}},[t("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.verificationForm.bindIp,callback:function(i){e.$set(e.verificationForm,"bindIp",i)},expression:"verificationForm.bindIp"}})],1)],1):e._e(),e._v(" "),t("el-form-item",{staticClass:"btnDisabled",attrs:{label:e.$t("common.email_code"),prop:"verificationCode"}},[t("el-input",{attrs:{type:"text"},model:{value:e.verificationForm.verificationCode,callback:function(i){e.$set(e.verificationForm,"verificationCode",i)},expression:"verificationForm.verificationCode"}},[t("el-button",{staticClass:"send-btn",attrs:{slot:"append",type:"plan",disabled:e.sendCountDown>0},on:{click:e.sendVerificationCode},slot:"append"},[e._v("\n            "+e._s(e.sendBtnText)+"\n          ")])],1)],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",disabled:e.verificationBtnDisabled},on:{click:function(i){return e.confirm("verificationForm")}}},[e._v("\n        "+e._s(e.$t("common.confirm"))+"\n      ")])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("user.apikey.add")+"API Key",visible:e.generateApiKeyVisible,width:"445px","close-on-click-modal":!1,"close-on-press-escape":!1,center:""},on:{"update:visible":function(i){e.generateApiKeyVisible=i}}},[t("div",{staticStyle:{background:"#FFE2E2",padding:"10px 10px"}},[t("span",{staticStyle:{color:"#D84040"}},[e._v(e._s(e.$t("user.apikey.tip_1")))]),t("br"),e._v(" "),t("span",{staticStyle:{color:"#D84040"}},[e._v(e._s(e.$t("user.apikey.tip_2")))])]),e._v(" "),t("el-form",[t("el-form-item",{attrs:{label:"API Key"}},[t("el-input",{attrs:{type:"text",disabled:"disabled"},model:{value:e.apiKey.accessKey,callback:function(i){e.$set(e.apiKey,"accessKey",i)},expression:"apiKey.accessKey"}},[t("el-button",{staticClass:"accessKey",attrs:{slot:"append",type:"primary",icon:"el-icon-document-copy","data-clipboard-text":e.apiKey.accessKey},on:{click:function(i){return e.copyKey(".accessKey")}},slot:"append"})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"API secret"}},[t("el-input",{attrs:{type:"text",disabled:"disabled"},model:{value:e.apiKey.secretKey,callback:function(i){e.$set(e.apiKey,"secretKey",i)},expression:"apiKey.secretKey"}},[t("el-button",{staticClass:"secretKey",attrs:{slot:"append",type:"primary",icon:"el-icon-document-copy","data-clipboard-text":e.apiKey.secretKey},on:{click:function(i){return e.copyKey(".secretKey")}},slot:"append"})],1)],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticStyle:{width:"350px"},attrs:{type:"primary"},on:{click:e.iKnow}},[e._v("\n        "+e._s(e.$t("user.apikey.i_know"))+"\n      ")])],1)],1)],1)}),[],!1,null,"a55260c4",null);i.default=c.exports}}]);