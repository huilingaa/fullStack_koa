(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{"+euT":function(e,n,t){"use strict";t.r(n);var o=t("lSNA"),i=t.n(o),s=t("vKDJ"),a=t("L2JU");function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){i()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var m={name:"MobileVerified",data:function(){return{mobileChangeForm:{regionCode:"86",password:"",mobileCode:"",emailCode:"",phone:""},containerVisible:!1,isBtnDisabled:!1,sendSmsCountDown:0,sendEmailCountDown:0,countryList:{},captchaObj:null,mobile_reg:/(297|93|244|1264|358|355|376|971|54|374|1684|1268|61|43|994|257|32|229|226|880|359|973|1242|387|590|375|501|1441|591|55|1246|673|975|267|236|1|61|41|56|86|225|237|243|242|682|57|269|238|506|53|5999|61|1345|357|420|49|253|1767|45|1809|1829|1849|213|593|20|291|212|34|372|251|358|679|500|33|298|691|241|44|995|44|233|350|224|590|220|245|240|30|1473|299|502|594|1671|592|852|504|385|509|36|62|44|91|246|353|98|964|354|972|39|1876|44|962|81|76|77|254|996|855|686|1869|82|383|965|856|961|231|218|1758|423|94|266|370|352|371|853|590|212|377|373|261|960|52|692|389|223|356|95|382|976|1670|258|222|1664|596|230|265|60|262|264|687|227|672|234|505|683|31|47|977|674|64|968|92|507|64|51|63|680|675|48|1787|1939|850|351|595|970|689|974|262|40|7|250|966|249|221|65|500|4779|677|232|503|378|252|508|381|211|239|597|421|386|46|268|1721|248|963|1649|235|228|66|992|690|993|670|676|1868|216|90|688|886|255|256|380|598|1|998|3906698|379|1784|58|1284|1340|84|678|681|685|967|27|260|263)\d{4,20}$/,mobile_zh_reg:/^((13|14|15|17|18|16|19)[0-9]{1}\d{8})$/}},computed:l(l({},Object(a.d)(["token","lang","userInfo"])),{},{isOpened:function(){return this.userInfo.smsAuthActive},sendBtnText:function(){return 0===this.sendSmsCountDown?this.$t("common.send_code"):this.sendSmsCountDown+"S"},sendEmailBtnText:function(){return 0===this.sendEmailCountDown?this.$t("common.send_code"):this.sendEmailCountDown+"S"},mobileChangeFormRules:function(){return{password:[{required:!0,message:this.$t("user.smsauthentication.please_enter_login_password"),trigger:"blur"}],phone:[{required:!0,message:this.$t("user.smsauthentication.please_enter_phone_number"),trigger:"blur"}],mobileCode:[{required:!0,message:this.$t("user.smsauthentication.please_enter_sms_code"),trigger:"blur"}],emailCode:[{required:!0,message:this.$t("user.smsauthentication.please_enter_email_code"),trigger:"blur"}]}}}),mounted:function(){var e=this;this.containerVisible=!0,s.a.getCountries().then((function(n){e.countryList=n}))},methods:{checkAndSend:function(){this.isOpened||this.mobileChangeForm.phone?this.isOpened||"86"!==this.mobileChangeForm.regionCode||this.mobile_zh_reg.test(this.mobileChangeForm.phone)?this.sendMobileAuthNo():this.$message.warning(this.$t("user.smsauthentication.phone_number_format_error")):this.$message.warning(this.$t("user.smsauthentication.please_enter_phone_number"))},sendMobileAuthNo:function(){var e=this;this.sendSmsCountDown=60,this.countSmsDown(),this.isOpened?s.a.sendUnbindMobileSms().then((function(e){})).catch((function(){e.sendSmsCountDown=0})):s.a.sendBindMobileSms(this.mobileChangeForm.regionCode,this.mobileChangeForm.phone).then((function(){})).catch((function(){e.sendSmsCountDown=0}))},sendEmail:function(){var e=this;this.sendEmailCountDown=60,this.countEmailDown(),s.a.sendEmailCode().then((function(e){})).catch((function(n){e.sendEmailCountDown=0}))},countSmsDown:function(){this.sendSmsCountDown>0&&(this.sendSmsCountDown=this.sendSmsCountDown-1,setTimeout(this.countSmsDown,1e3))},countEmailDown:function(){this.sendEmailCountDown=this.sendEmailCountDown-1,this.sendEmailCountDown>0&&setTimeout(this.countEmailDown,1e3)},resetForm:function(){this.mobileChangeForm.phone="",this.mobileChangeForm.mobileCode="",this.mobileChangeForm.regionCode="86",this.mobileChangeForm.password=""},saveMobileVerified:function(e){var n=this;this.$refs[e].validate((function(e){if(!e)return!1;n.isBtnDisabled=!0,n.isOpened?n.unbindMobile():n.bindMobile()}))},unbindMobile:function(){var e=this,n={loginPassword:this.mobileChangeForm.password,phoneVerificationCode:this.mobileChangeForm.mobileCode};s.a.unbindMobile(n).then((function(){e.resetForm(),e.isOpened=!e.isOpened,e.$message({type:"success",message:e.$t("user.smsauthentication.unbind_successfully")}),e.$router.back()})).finally((function(){e.isBtnDisabled=!1}))},bindMobile:function(){var e=this,n={loginPassword:this.mobileChangeForm.password,countryCode:this.mobileChangeForm.regionCode,number:this.mobileChangeForm.phone,phoneVerificationCode:this.mobileChangeForm.mobileCode,emailVerificationCode:this.mobileChangeForm.emailCode};s.a.bindMobilePhone(n).then((function(){e.resetForm(),e.isOpened=!e.isOpened,e.$message({type:"success",message:e.$t("user.smsauthentication.bind_successfully")}),e.$router.replace("/userCenter")})).finally((function(){e.isBtnDisabled=!1}))}}},u=t("KHd+"),d=Object(u.a)(m,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("el-card",{staticClass:"uc-content"},[t("div",{staticClass:"uc-content-header",attrs:{slot:"header"},slot:"header"},[e._v("\n      "+e._s(e.$t("user.sms_authentication"))+"\n    ")]),e._v(" "),e.containerVisible?t("div",[t("div",{staticStyle:{margin:"10px auto",width:"300px"}},[t("el-form",{ref:"mobileChangeForm",staticClass:"demo-ruleForm",attrs:{"hide-required-asterisk":!0,"status-icon":!1,size:"medium",model:e.mobileChangeForm,rules:e.mobileChangeFormRules}},[t("el-form-item",{attrs:{label:e.$t("common.login_password"),prop:"password"}},[t("el-input",{attrs:{type:"password"},model:{value:e.mobileChangeForm.password,callback:function(n){e.$set(e.mobileChangeForm,"password",n)},expression:"mobileChangeForm.password"}})],1),e._v(" "),e.isOpened?e._e():t("el-form-item",{attrs:{label:e.$t("user.smsauthentication.phone_number"),prop:"phone"}},[t("el-input",{attrs:{type:"text"},model:{value:e.mobileChangeForm.phone,callback:function(n){e.$set(e.mobileChangeForm,"phone",n)},expression:"mobileChangeForm.phone"}},[t("template",{slot:"prepend"},[t("el-select",{staticStyle:{width:"80px"},model:{value:e.mobileChangeForm.regionCode,callback:function(n){e.$set(e.mobileChangeForm,"regionCode",n)},expression:"mobileChangeForm.regionCode"}},e._l(e.countryList,(function(n,o){return t("el-option",{key:o,attrs:{label:"+"+n.code,value:n.code}},[t("div",{staticStyle:{width:"257px",display:"flex","justify-content":"space-between"}},[t("span",[e._v(e._s(n.name))]),e._v(" "),t("span",{staticStyle:{color:"#999","font-size":"12px","margin-top":"2px"}},[e._v("+"+e._s(n.code))])])])})),1)],1)],2)],1),e._v(" "),t("el-form-item",{staticClass:"btnDisabled",attrs:{label:e.$t("user.smsauthentication.sms_code"),prop:"mobileCode"}},[t("el-input",{attrs:{type:"text"},model:{value:e.mobileChangeForm.mobileCode,callback:function(n){e.$set(e.mobileChangeForm,"mobileCode",n)},expression:"mobileChangeForm.mobileCode"}},[t("el-button",{staticClass:"send-btn",attrs:{slot:"append",type:"plain",disabled:e.sendSmsCountDown>0},on:{click:e.checkAndSend},slot:"append"},[e._v("\n                "+e._s(e.sendBtnText)+"\n              ")])],1)],1),e._v(" "),!e.isOpened&&e.userInfo.email?t("el-form-item",{staticClass:"btnDisabled",attrs:{label:e.$t("common.email_code"),prop:"emailCode"}},[t("el-input",{attrs:{type:"text"},model:{value:e.mobileChangeForm.emailCode,callback:function(n){e.$set(e.mobileChangeForm,"emailCode",n)},expression:"mobileChangeForm.emailCode"}},[t("el-button",{staticClass:"send-btn",attrs:{slot:"append",type:"plan",disabled:e.sendEmailCountDown>0},on:{click:e.sendEmail},slot:"append"},[e._v("\n                "+e._s(e.sendEmailBtnText)+"\n              ")])],1)],1):e._e(),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",disabled:e.isBtnDisabled},on:{click:function(n){return e.saveMobileVerified("mobileChangeForm")}}},[e._v("\n              "+e._s(e.isOpened?e.$t("user.sms_authentication_disable"):e.$t("user.sms_authentication_enable"))+"\n            ")])],1)],1)],1)]):e._e()])],1)}),[],!1,null,"d1ea1a2c",null);n.default=d.exports}}]);