(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{"AT+L":function(e,t,n){"use strict";n.r(t);var o=n("o0o1"),i=n.n(o),s=n("yXPU"),r=n.n(s),c=n("lSNA"),l=n.n(c),a=n("vKDJ"),u=n("Rc4f"),d=n("L2JU");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p={name:"Login",components:{Captcha:u.a},data:function(){var e=this;return{captchaObj:null,isLoginProcessing:!1,sendSmsCountDown:0,loginForm:{username:"",password:null,nc_sessionId:"",nc_sig:"",nc_token:"",nc_scene:"nc_login",isNcVerify:!0},show2FA:!1,verifyMethod:"",selected2FA:"",secondFA:{authId:"",googleAuthActive:!0,mobileAuthActive:!0,mobileCountryCode:"86",mobileNumber:"",googleAuthNo:null,mobileAuthNo:null,need2FA:!0},loginFormRules:{username:[{required:!0,message:this.$t("login.please_input_the_email_phone_address"),trigger:"blur"},{validator:function(t,n,o){C.Utils.isEmail(n)||/[0-9]+/.test(n)?o():o(new Error(e.$t("login.please_input_the_correct_email_mobile")))},trigger:"blur"}],password:[{required:!0,message:this.$t("login.please_enter_your_password"),trigger:"blur"}]}}},computed:g(g({},Object(d.d)(["lang"])),{},{sendBtnText:function(){return 0===this.sendSmsCountDown?this.$t("common.send_code"):this.sendSmsCountDown+"S"},loginInitialized:function(){return this.loginForm.username&&this.loginForm.password}}),watch:{"secondFA.googleAuthNo":function(e){"google"===this.selected2FA&&e&&6===e.length&&this.secondAuthVerify()},"secondFA.mobileAuthNo":function(e){"sms"===this.selected2FA&&e&&6===e.length&&this.secondAuthVerify()}},methods:g(g(g({},Object(d.c)(["setUserInfo"])),Object(d.b)(["setToken"])),{},{sendAuthSMS:function(){var e=this;a.a.sendAuthSms(this.secondFA.authId).then((function(){e.sendSmsCountDown=60,e.$refs.sendAuthSMS.focus(),e.countDown()}))},secondAuthVerify:function(){var e=this,t=this.selected2FA,n="";null!==(n="google"===t?this.secondFA.googleAuthNo:this.secondFA.mobileAuthNo)?a.a.process2FA(this.secondFA.authId,t,n).then((function(t){e.setToken(t.token),e.userEvent((function(){e.$router.replace("/")}))})):"google"===t?this.$message.warning(this.$t("login.enter_google_verification_code")):this.$message.warning(this.$t("login.enter_mobile_verification_code"))},countDown:function(){this.sendSmsCountDown>0&&(this.sendSmsCountDown=this.sendSmsCountDown-1,setTimeout(this.countDown,1e3))},handleSuccessCaptcha:function(e){this.loginForm.nc_sessionId=e.csessionid,this.loginForm.nc_sig=e.sig,this.loginForm.nc_token=e.token,this.doLogin()},checkAndLogin:function(){var e=this;this.$store.commit("clearUserInfo"),this.$refs.loginForm.validate((function(t){if(!t)return!1;e.$refs.captcha.show()}))},doLogin:function(){var e=this;this.isLoginProcessing=!0,a.a.login(this.loginForm).then((function(t){if(!t.need2FA)return e.$message({type:"success",message:e.$t("login.login_success")}),e.setToken(t.token),void e.userEvent((function(){e.$router.push("/userCenter")}));e.show2FA=!0,e.secondFA.authId=t.authId,e.secondFA.googleAuthActive=t.googleAuthActive,e.secondFA.mobileAuthActive=t.smsAuthActive,e.secondFA.mobileNumber=t.mobileNumber,e.secondFA.mobileCountryCode=t.mobileCountryCode,t.googleAuthActive?e.selected2FA="google":t.smsAuthActive&&(e.selected2FA="sms",e.sendAuthSMS())})).finally((function(){e.isLoginProcessing=!1}))},userEvent:function(e){return r()(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.userEvent({eventType:1});case 2:e&&e();case 3:case"end":return t.stop()}}),t)})))()}})},m=n("KHd+"),f=Object(m.a)(p,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-main",[e.show2FA?e._e():n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoginProcessing,expression:"isLoginProcessing"}],staticClass:"login"},[n("div",{attrs:{slot:"header"},slot:"header"},[n("div",{staticClass:"title"},[e._v("\n        "+e._s(e.$t("login.login"))+"\n      ")])]),e._v(" "),n("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{"hide-required-asterisk":!0,size:"medium",model:e.loginForm,"status-icon":!1,"label-position":"top",rules:e.loginFormRules}},[n("el-form-item",{attrs:{prop:"username"}},[n("el-input",{ref:"login_username_input",attrs:{"prefix-icon":"el-icon-user",type:"text","auto-complete":"off",placeholder:e.$t("login.emailOrPhone")},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),n("el-form-item",{staticStyle:{"margin-top":"40px"},attrs:{prop:"password"}},[n("el-input",{attrs:{"prefix-icon":"el-icon-key",type:"password","auto-complete":"off",placeholder:e.$t("login.password")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.checkAndLogin(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),n("el-form-item",[n("div",[n("div",{staticStyle:{float:"right"}},[n("router-link",{attrs:{to:"/resetLoginPasswd"}},[e._v("\n              "+e._s(e.$t("login.forget_password"))+"\n            ")])],1)]),e._v(" "),n("el-button",{staticStyle:{width:"406px","margin-top":"10px"},attrs:{type:"primary",disabled:!e.loginInitialized},on:{click:e.checkAndLogin}},[e._v("\n          "+e._s(e.$t("login.login"))+"\n        ")])],1)],1)],1),e._v(" "),n("captcha",{ref:"captcha",on:{"on-success":e.handleSuccessCaptcha}}),e._v(" "),e.show2FA?n("el-form",{ref:"secondAuthForm",attrs:{"hide-required-asterisk":!0,"status-icon":!1,model:e.secondFA,size:"medium","label-position":"top"}},[e.show2FA?n("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoginProcessing,expression:"isLoginProcessing"}],staticClass:"secondAuth",attrs:{type:"border-card",stretch:!0},model:{value:e.selected2FA,callback:function(t){e.selected2FA=t},expression:"selected2FA"}},[e.secondFA.googleAuthActive?n("el-tab-pane",{attrs:{name:"google"}},[n("template",{slot:"label"},[n("div",{staticClass:"title"},[e._v("\n            "+e._s(e.$t("login.google_verification"))+"\n          ")])]),e._v(" "),n("div",{staticStyle:{width:"300px",margin:"50px auto"}},[n("div",{staticClass:"desc"},[e._v("\n            "+e._s(e.$t("login.google_verification_tips"))+"\n          ")]),e._v(" "),n("el-form-item",{attrs:{prop:"googleAuthNo"}},[n("input",{attrs:{hidden:""}}),e._v(" "),n("el-input",{attrs:{type:"text","max-length":"6","auto-complete":"off",placeholder:e.$t("login.enter_google_verification_code")},model:{value:e.secondFA.googleAuthNo,callback:function(t){e.$set(e.secondFA,"googleAuthNo",t)},expression:"secondFA.googleAuthNo"}})],1),e._v(" "),n("el-button",{staticStyle:{width:"300px"},attrs:{type:"primary",size:"medium"},on:{click:e.secondAuthVerify}},[e._v("\n            "+e._s(e.$t("login.verification"))+"\n          ")])],1)],2):e._e(),e._v(" "),e.secondFA.mobileAuthActive?n("el-tab-pane",{attrs:{name:"sms"}},[n("template",{slot:"label"},[n("div",{staticClass:"title"},[e._v("\n            "+e._s(e.$t("login.mobile_verification"))+"\n          ")])]),e._v(" "),n("div",{staticStyle:{width:"300px",margin:"50px auto"}},[n("div",{staticClass:"desc"},[e._v("\n            "+e._s(e.$t("login.mobile_verification_tips"))+"\n          ")]),e._v(" "),n("el-form-item",{attrs:{prop:"mobileAuthNo"}},[n("input",{attrs:{hidden:""}}),e._v(" "),n("el-input",{ref:"sendAuthSMS",attrs:{type:"text","max-length":"6","auto-complete":"off",placeholder:e.$t("login.enter_mobile_verification_code")},model:{value:e.secondFA.mobileAuthNo,callback:function(t){e.$set(e.secondFA,"mobileAuthNo",t)},expression:"secondFA.mobileAuthNo"}},[n("el-button",{staticClass:"send-btn",attrs:{slot:"append",type:"plain",disabled:e.sendSmsCountDown>0},on:{click:e.sendAuthSMS},slot:"append"},[e._v("\n                "+e._s(e.sendBtnText)+"\n              ")])],1)],1),e._v(" "),n("el-button",{staticStyle:{width:"300px"},attrs:{type:"primary",size:"medium"},on:{click:e.secondAuthVerify}},[e._v("\n            "+e._s(e.$t("login.verification"))+"\n          ")])],1)],2):e._e()],1):e._e()],1):e._e()],1)}),[],!1,null,"84f14d2c",null);t.default=f.exports},Rc4f:function(e,t,n){"use strict";var o=n("lSNA"),i=n.n(o),s=n("L2JU");function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var c={name:"Captcha",props:{scene:{type:String,default:"nc_login"},customWidth:{type:[String,Number],default:360},purpose:{type:[String,Number],default:"nc_login_pc"},id:{type:String,default:"captcha"}},data:function(){return{appkey:"FFFF0N000000000085FE",nc:null,visible:!1}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(s.d)(["lang"])),watch:{visible:function(e){var t=this;e&&this.$nextTick((function(){t.init()}))}},mounted:function(){},methods:{init:function(){var e=this;if(this.nc)this.nc.reload();else{var t=[this.appkey,(new Date).getTime(),Math.random()].join(":"),n="zh"===this.lang?"cn":"ko"===this.lang?"ko_KR":this.lang,o={renderTo:"#".concat(this.id),appkey:this.appkey,scene:this.scene,token:t,customWidth:this.customWidth,trans:{purpose:"nc_login_pc"},language:n,isEnabled:!0,timeout:3e3,times:5,callback:function(t){e.visible=!1,e.$emit("on-success",t)}};this.nc=new noCaptcha(o),this.nc.upLang("cn",{_startTEXT:"请按住滑块，拖动到最右边",_yesTEXT:"验证通过",_error300:"哎呀，出错了，点击<a href='javascript:__nc.reset()'>刷新</a>再来一次",_errorNetwork:"网络不给力，请<a href='javascript:__nc.reset()'>点击刷新</a>"})}},reload:function(){this.nc.reload()},hide:function(){this.visible=!1},show:function(){this.visible=!0}}},l=n("KHd+"),a=Object(l.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"captcha-dialog",attrs:{title:e.$t("common.sliding_verification"),visible:e.visible,width:"400px"},on:{"update:visible":function(t){e.visible=t}}},[n("div",{staticClass:"nc-container",attrs:{id:e.id}})])}),[],!1,null,"226af3d4",null);t.a=a.exports}}]);